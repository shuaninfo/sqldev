(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d0cb396"],{"0107":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"审计日志",visible:e.isShow,fullscreen:"",width:"100%","before-close":e.hide,"append-to-body":"",center:""},on:{"update:visible":function(t){e.isShow=t}}},[n("div",{staticStyle:{"padding-bottom":"50px"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sqlAuditData,border:!0,height:"680",border:""}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(e._s(t.row.sql))])]}}])}),n("el-table-column",{attrs:{prop:"id",label:"ID",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.sql_no)+" ")]}}])}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"sql",label:"SQL语句"}}),n("el-table-column",{attrs:{prop:"level",width:"120",label:"审核/执行状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:e.showLevelTagType(t.row.level)}},[e._v(" "+e._s(e.showLevel(t.row.level))+" ")])]}}])}),n("el-table-column",{attrs:{prop:"result",width:"200",label:"审核/执行信息"}}),n("el-table-column",{attrs:{prop:"affected_rows",label:"扫描/影响行数",width:"120"}}),n("el-table-column",{attrs:{prop:"execute_time",width:"100",label:"执行耗时"}}),n("el-table-column",{attrs:{prop:"stage_status",width:"200",label:"当前阶段"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.showStageStatus(t.row.stage_status))+" ")]}}])})],1),n("el-form",[n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.hide()}}},[e._v("关闭")])],1)],1)],1)])},o=[],a={data:function(){return{id:"",work:{name:"",sql:""},title:"",is_admin:!1,isShow:!1,sqlAuditData:[]}},props:{logData:Array},watch:{},computed:{},methods:{showStageStatus:function(e){return this.$api.work.showStageStatus(e)},showStage:function(e){return this.$api.work.showStage(e)},showLevel:function(e){return this.$api.work.showLevelStyle(e)},showLevelTagType:function(e){return this.$api.work.showLevelTagType(e)},show:function(e,t){var n=this;this.id=e,this.$api.work.sqlAuditList(this.id,-1,-1).then((function(e){n.sqlAuditData=e.list})),this.isShow=!0,this.is_admin=t},showStatus:function(e){return this.$api.work.showStatus(e)},onChangeExecTime:function(){this.$refs.editExecTimeDialog.show(this.formData)},showExecTime:function(e){return 1==e.exec_flag?"不限":(e.exec_flag=2)?Util.formatTime(e.exec_start)+" 至 "+Util.formatTime(e.exec_end):"未知"},init:function(){var e=this;this.id?this.$api.work.sqlAuditList(this.formData.id,-1,-1).then((function(t){e.sqlAuditData=t.list})):this.onError("出错了，审计编号")},hide:function(){this.isShow=!1,this.is_admin=!1,this.id="",this.sqlAuditData=[],this.work={name:""},this.is_admin||this.$emit("hide")}},mounted:function(){},components:{}},s=a,r=n("2877"),l=Object(r["a"])(s,i,o,!1,null,null,null);t["a"]=l.exports},"1d29":function(e,t){ace.define("ace/theme/eclipse",["require","exports","module","ace/lib/dom"],(function(e,t,n){"use strict";t.isDark=!1,t.cssText='.ace-eclipse .ace_gutter {background: #ebebeb;border-right: 1px solid rgb(159, 159, 159);color: rgb(136, 136, 136);}.ace-eclipse .ace_print-margin {width: 1px;background: #ebebeb;}.ace-eclipse {background-color: #FFFFFF;color: black;}.ace-eclipse .ace_fold {background-color: rgb(60, 76, 114);}.ace-eclipse .ace_cursor {color: black;}.ace-eclipse .ace_storage,.ace-eclipse .ace_keyword,.ace-eclipse .ace_variable {color: rgb(127, 0, 85);}.ace-eclipse .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-eclipse .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-eclipse .ace_function {color: rgb(60, 76, 114);}.ace-eclipse .ace_string {color: rgb(42, 0, 255);}.ace-eclipse .ace_comment {color: rgb(113, 150, 130);}.ace-eclipse .ace_comment.ace_doc {color: rgb(63, 95, 191);}.ace-eclipse .ace_comment.ace_doc.ace_tag {color: rgb(127, 159, 191);}.ace-eclipse .ace_constant.ace_numeric {color: darkblue;}.ace-eclipse .ace_tag {color: rgb(25, 118, 116);}.ace-eclipse .ace_type {color: rgb(127, 0, 127);}.ace-eclipse .ace_xml-pe {color: rgb(104, 104, 91);}.ace-eclipse .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-eclipse .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-eclipse .ace_meta.ace_tag {color:rgb(25, 118, 116);}.ace-eclipse .ace_invisible {color: #ddd;}.ace-eclipse .ace_entity.ace_other.ace_attribute-name {color:rgb(127, 0, 127);}.ace-eclipse .ace_marker-layer .ace_step {background: rgb(255, 255, 0);}.ace-eclipse .ace_active-line {background: rgb(232, 242, 254);}.ace-eclipse .ace_gutter-active-line {background-color : #DADADA;}.ace-eclipse .ace_marker-layer .ace_selected-word {border: 1px solid rgb(181, 213, 255);}.ace-eclipse .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',t.cssClass="ace-eclipse";var i=e("../lib/dom");i.importCssString(t.cssText,t.cssClass)}))},2099:function(e,t){ace.define("ace/snippets",["require","exports","module","ace/lib/oop","ace/lib/event_emitter","ace/lib/lang","ace/range","ace/anchor","ace/keyboard/hash_handler","ace/tokenizer","ace/lib/dom","ace/editor"],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./lib/event_emitter").EventEmitter,a=e("./lib/lang"),s=e("./range").Range,r=e("./anchor").Anchor,l=e("./keyboard/hash_handler").HashHandler,c=e("./tokenizer").Tokenizer,p=s.comparePoints,u=function(){this.snippetMap={},this.snippetNameMap={}};(function(){i.implement(this,o),this.getTokenizer=function(){function e(e,t,n){return e=e.substr(1),/^\d+$/.test(e)&&!n.inFormatString?[{tabstopId:parseInt(e,10)}]:[{text:e}]}function t(e){return"(?:[^\\\\"+e+"]|\\\\.)"}return u.$tokenizer=new c({start:[{regex:/:/,onMatch:function(e,t,n){return n.length&&n[0].expectIf?(n[0].expectIf=!1,n[0].elseBranch=n[0],[n[0]]):":"}},{regex:/\\./,onMatch:function(e,t,n){var i=e[1];return"}"==i&&n.length||-1!="`$\\".indexOf(i)?e=i:n.inFormatString&&("n"==i||"t"==i?e="\n":-1!="ulULE".indexOf(i)&&(e={changeCase:i,local:i>"a"})),[e]}},{regex:/}/,onMatch:function(e,t,n){return[n.length?n.shift():e]}},{regex:/\$(?:\d+|\w+)/,onMatch:e},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(t,n,i){var o=e(t.substr(1),n,i);return i.unshift(o[0]),o},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+t("\\|")+"*\\|",onMatch:function(e,t,n){n[0].choices=e.slice(1,-1).split(",")},next:"start"},{regex:"/("+t("/")+"+)/(?:("+t("/")+"*)/)(\\w*):?",onMatch:function(e,t,n){var i=n[0];return i.fmtString=e,e=this.splitRegex.exec(e),i.guard=e[1],i.fmt=e[2],i.flag=e[3],""},next:"start"},{regex:"`"+t("`")+"*`",onMatch:function(e,t,n){return n[0].code=e.splice(1,-1),""},next:"start"},{regex:"\\?",onMatch:function(e,t,n){n[0]&&(n[0].expectIf=!0)},next:"start"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:"/("+t("/")+"+)/",token:"regex"},{regex:"",onMatch:function(e,t,n){n.inFormatString=!0},next:"start"}]}),u.prototype.getTokenizer=function(){return u.$tokenizer},u.$tokenizer},this.tokenizeTmSnippet=function(e,t){return this.getTokenizer().getLineTokens(e,t).tokens.map((function(e){return e.value||e}))},this.$getDefaultValue=function(e,t){if(/^[A-Z]\d+$/.test(t)){var n=t.substr(1);return(this.variables[t[0]+"__"]||{})[n]}if(/^\d+$/.test(t))return(this.variables.__||{})[t];if(t=t.replace(/^TM_/,""),e){var i=e.session;switch(t){case"CURRENT_WORD":var o=i.getWordRange();case"SELECTION":case"SELECTED_TEXT":return i.getTextRange(o);case"CURRENT_LINE":return i.getLine(e.getCursorPosition().row);case"PREV_LINE":return i.getLine(e.getCursorPosition().row-1);case"LINE_INDEX":return e.getCursorPosition().column;case"LINE_NUMBER":return e.getCursorPosition().row+1;case"SOFT_TABS":return i.getUseSoftTabs()?"YES":"NO";case"TAB_SIZE":return i.getTabSize();case"FILENAME":case"FILEPATH":return"";case"FULLNAME":return"Ace"}}},this.variables={},this.getVariableValue=function(e,t){return this.variables.hasOwnProperty(t)?this.variables[t](e,t)||"":this.$getDefaultValue(e,t)||""},this.tmStrFormat=function(e,t,n){var i=t.flag||"",o=t.guard;o=new RegExp(o,i.replace(/[^gi]/,""));var a=this.tokenizeTmSnippet(t.fmt,"formatString"),s=this,r=e.replace(o,(function(){s.variables.__=arguments;for(var e=s.resolveVariables(a,n),t="E",i=0;i<e.length;i++){var o=e[i];if("object"==typeof o)if(e[i]="",o.changeCase&&o.local){var r=e[i+1];r&&"string"==typeof r&&("u"==o.changeCase?e[i]=r[0].toUpperCase():e[i]=r[0].toLowerCase(),e[i+1]=r.substr(1))}else o.changeCase&&(t=o.changeCase);else"U"==t?e[i]=o.toUpperCase():"L"==t&&(e[i]=o.toLowerCase())}return e.join("")}));return this.variables.__=null,r},this.resolveVariables=function(e,t){for(var n=[],i=0;i<e.length;i++){var o=e[i];if("string"==typeof o)n.push(o);else{if("object"!=typeof o)continue;if(o.skip)s(o);else{if(o.processed<i)continue;if(o.text){var a=this.getVariableValue(t,o.text);a&&o.fmtString&&(a=this.tmStrFormat(a,o)),o.processed=i,null==o.expectIf?a&&(n.push(a),s(o)):a?o.skip=o.elseBranch:s(o)}else(null!=o.tabstopId||null!=o.changeCase)&&n.push(o)}}}function s(t){var n=e.indexOf(t,i+1);-1!=n&&(i=n)}return n},this.insertSnippetForSelection=function(e,t){var n=e.getCursorPosition(),i=e.session.getLine(n.row),o=e.session.getTabString(),a=i.match(/^\s*/)[0];n.column<a.length&&(a=a.slice(0,n.column)),t=t.replace(/\r/g,"");var s=this.tokenizeTmSnippet(t);s=this.resolveVariables(s,e),s=s.map((function(e){return"\n"==e?e+a:"string"==typeof e?e.replace(/\t/g,o):e}));var r=[];s.forEach((function(e,t){if("object"==typeof e){var n=e.tabstopId,i=r[n];if(i||(i=r[n]=[],i.index=n,i.value=""),-1===i.indexOf(e)){i.push(e);var o=s.indexOf(e,t+1);if(-1!==o){var a=s.slice(t+1,o),l=a.some((function(e){return"object"===typeof e}));l&&!i.value?i.value=a:!a.length||i.value&&"string"===typeof i.value||(i.value=a.join(""))}}}})),r.forEach((function(e){e.length=0}));var l={};function c(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];if("object"==typeof i){if(l[i.tabstopId])continue;var o=e.lastIndexOf(i,n-1);i=t[o]||{tabstopId:i.tabstopId}}t[n]=i}return t}for(var p=0;p<s.length;p++){var u=s[p];if("object"==typeof u){var h=u.tabstopId,f=s.indexOf(u,p+1);if(l[h])l[h]===u&&(l[h]=null);else{var g=r[h],m="string"==typeof g.value?[g.value]:c(g.value);m.unshift(p+1,Math.max(0,f-p)),m.push(u),l[h]=u,s.splice.apply(s,m),-1===g.indexOf(u)&&g.push(u)}}}var b=0,v=0,_="";s.forEach((function(e){if("string"===typeof e){var t=e.split("\n");t.length>1?(v=t[t.length-1].length,b+=t.length-1):v+=e.length,_+=e}else e.start?e.end={row:b,column:v}:e.start={row:b,column:v}}));var w=e.getSelectionRange(),x=e.session.replace(w,_),y=new d(e),k=e.inVirtualSelectionMode&&e.selection.index;y.addTabstops(r,w.start,x,k)},this.insertSnippet=function(e,t){var n=this;if(e.inVirtualSelectionMode)return n.insertSnippetForSelection(e,t);e.forEachSelection((function(){n.insertSnippetForSelection(e,t)}),null,{keepOrder:!0}),e.tabstopManager&&e.tabstopManager.tabNext()},this.$getScope=function(e){var t=e.session.$mode.$id||"";if(t=t.split("/").pop(),"html"===t||"php"===t){"php"!==t||e.session.$mode.inlinePhp||(t="html");var n=e.getCursorPosition(),i=e.session.getState(n.row);"object"===typeof i&&(i=i[0]),i.substring&&("js-"==i.substring(0,3)?t="javascript":"css-"==i.substring(0,4)?t="css":"php-"==i.substring(0,4)&&(t="php"))}return t},this.getActiveScopes=function(e){var t=this.$getScope(e),n=[t],i=this.snippetMap;return i[t]&&i[t].includeScopes&&n.push.apply(n,i[t].includeScopes),n.push("_"),n},this.expandWithTab=function(e,t){var n=this,i=e.forEachSelection((function(){return n.expandSnippetForSelection(e,t)}),null,{keepOrder:!0});return i&&e.tabstopManager&&e.tabstopManager.tabNext(),i},this.expandSnippetForSelection=function(e,t){var n,i=e.getCursorPosition(),o=e.session.getLine(i.row),a=o.substring(0,i.column),s=o.substr(i.column),r=this.snippetMap;return this.getActiveScopes(e).some((function(e){var t=r[e];return t&&(n=this.findMatchingSnippet(t,a,s)),!!n}),this),!!n&&(t&&t.dryRun||(e.session.doc.removeInLine(i.row,i.column-n.replaceBefore.length,i.column+n.replaceAfter.length),this.variables.M__=n.matchBefore,this.variables.T__=n.matchAfter,this.insertSnippetForSelection(e,n.content),this.variables.M__=this.variables.T__=null),!0)},this.findMatchingSnippet=function(e,t,n){for(var i=e.length;i--;){var o=e[i];if((!o.startRe||o.startRe.test(t))&&((!o.endRe||o.endRe.test(n))&&(o.startRe||o.endRe)))return o.matchBefore=o.startRe?o.startRe.exec(t):[""],o.matchAfter=o.endRe?o.endRe.exec(n):[""],o.replaceBefore=o.triggerRe?o.triggerRe.exec(t)[0]:"",o.replaceAfter=o.endTriggerRe?o.endTriggerRe.exec(n)[0]:"",o}},this.snippetMap={},this.snippetNameMap={},this.register=function(e,t){var n=this.snippetMap,i=this.snippetNameMap,o=this;function s(e){return e&&!/^\^?\(.*\)\$?$|^\\b$/.test(e)&&(e="(?:"+e+")"),e||""}function r(e,t,n){return e=s(e),t=s(t),n?(e=t+e,e&&"$"!=e[e.length-1]&&(e+="$")):(e+=t,e&&"^"!=e[0]&&(e="^"+e)),new RegExp(e)}function l(e){e.scope||(e.scope=t||"_"),t=e.scope,n[t]||(n[t]=[],i[t]={});var s=i[t];if(e.name){var l=s[e.name];l&&o.unregister(l),s[e.name]=e}n[t].push(e),e.tabTrigger&&!e.trigger&&(!e.guard&&/^\w/.test(e.tabTrigger)&&(e.guard="\\b"),e.trigger=a.escapeRegExp(e.tabTrigger)),(e.trigger||e.guard||e.endTrigger||e.endGuard)&&(e.startRe=r(e.trigger,e.guard,!0),e.triggerRe=new RegExp(e.trigger,"",!0),e.endRe=r(e.endTrigger,e.endGuard,!0),e.endTriggerRe=new RegExp(e.endTrigger,"",!0))}e||(e=[]),e&&e.content?l(e):Array.isArray(e)&&e.forEach(l),this._signal("registerSnippets",{scope:t})},this.unregister=function(e,t){var n=this.snippetMap,i=this.snippetNameMap;function o(e){var o=i[e.scope||t];if(o&&o[e.name]){delete o[e.name];var a=n[e.scope||t],s=a&&a.indexOf(e);s>=0&&a.splice(s,1)}}e.content?o(e):Array.isArray(e)&&e.forEach(o)},this.parseSnippetFile=function(e){e=e.replace(/\r/g,"");var t,n=[],i={},o=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm;while(t=o.exec(e)){if(t[1])try{i=JSON.parse(t[1]),n.push(i)}catch(l){}if(t[4])i.content=t[4].replace(/^\t/gm,""),n.push(i),i={};else{var a=t[2],s=t[3];if("regex"==a){var r=/\/((?:[^\/\\]|\\.)*)|$/g;i.guard=r.exec(s)[1],i.trigger=r.exec(s)[1],i.endTrigger=r.exec(s)[1],i.endGuard=r.exec(s)[1]}else"snippet"==a?(i.tabTrigger=s.match(/^\S*/)[0],i.name||(i.name=s)):i[a]=s}}return n},this.getSnippetByName=function(e,t){var n,i=this.snippetNameMap;return this.getActiveScopes(t).some((function(t){var o=i[t];return o&&(n=o[e]),!!n}),this),n}}).call(u.prototype);var d=function(e){if(e.tabstopManager)return e.tabstopManager;e.tabstopManager=this,this.$onChange=this.onChange.bind(this),this.$onChangeSelection=a.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),this.attach(e)};(function(){this.attach=function(e){this.index=0,this.ranges=[],this.tabstops=[],this.$openTabstops=null,this.selectedTabstop=null,this.editor=e,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},this.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges=null,this.tabstops=null,this.selectedTabstop=null,this.editor.removeListener("change",this.$onChange),this.editor.removeListener("changeSelection",this.$onChangeSelection),this.editor.removeListener("changeSession",this.$onChangeSession),this.editor.commands.removeListener("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.editor=null},this.onChange=function(e){var t="r"==e.action[0],n=e.start,i=e.end,o=n.row,a=i.row,s=a-o,r=i.column-n.column;if(t&&(s=-s,r=-r),!this.$inChange&&t){var l=this.selectedTabstop,c=l&&!l.some((function(e){return p(e.start,n)<=0&&p(e.end,i)>=0}));if(c)return this.detach()}for(var u=this.ranges,d=0;d<u.length;d++){var h=u[d];h.end.row<n.row||(t&&p(n,h.start)<0&&p(i,h.end)>0?(this.removeRange(h),d--):(h.start.row==o&&h.start.column>n.column&&(h.start.column+=r),h.end.row==o&&h.end.column>=n.column&&(h.end.column+=r),h.start.row>=o&&(h.start.row+=s),h.end.row>=o&&(h.end.row+=s),p(h.start,h.end)>0&&this.removeRange(h)))}u.length||this.detach()},this.updateLinkedFields=function(){var e=this.selectedTabstop;if(e&&e.hasLinkedRanges){this.$inChange=!0;for(var n=this.editor.session,i=n.getTextRange(e.firstNonLinked),o=e.length;o--;){var a=e[o];if(a.linked){var s=t.snippetManager.tmStrFormat(i,a.original);n.replace(a,s)}}this.$inChange=!1}},this.onAfterExec=function(e){e.command&&!e.command.readOnly&&this.updateLinkedFields()},this.onChangeSelection=function(){if(this.editor){for(var e=this.editor.selection.lead,t=this.editor.selection.anchor,n=this.editor.selection.isEmpty(),i=this.ranges.length;i--;)if(!this.ranges[i].linked){var o=this.ranges[i].contains(e.row,e.column),a=n||this.ranges[i].contains(t.row,t.column);if(o&&a)return}this.detach()}},this.onChangeSession=function(){this.detach()},this.tabNext=function(e){var t=this.tabstops.length,n=this.index+(e||1);n=Math.min(Math.max(n,1),t),n==t&&(n=0),this.selectTabstop(n),0===n&&this.detach()},this.selectTabstop=function(e){this.$openTabstops=null;var t=this.tabstops[this.index];if(t&&this.addTabstopMarkers(t),this.index=e,t=this.tabstops[this.index],t&&t.length){if(this.selectedTabstop=t,this.editor.inVirtualSelectionMode)this.editor.selection.setRange(t.firstNonLinked);else{var n=this.editor.multiSelect;n.toSingleRange(t.firstNonLinked.clone());for(var i=t.length;i--;)t.hasLinkedRanges&&t[i].linked||n.addRange(t[i].clone(),!0);n.ranges[0]&&n.addRange(n.ranges[0].clone())}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)}},this.addTabstops=function(e,t,n){if(this.$openTabstops||(this.$openTabstops=[]),!e[0]){var i=s.fromPoints(n,n);g(i.start,t),g(i.end,t),e[0]=[i],e[0].index=0}var o=this.index,a=[o+1,0],r=this.ranges;e.forEach((function(e,n){for(var i=this.$openTabstops[n]||e,o=e.length;o--;){var l=e[o],c=s.fromPoints(l.start,l.end||l.start);f(c.start,t),f(c.end,t),c.original=l,c.tabstop=i,r.push(c),i!=e?i.unshift(c):i[o]=c,l.fmtString?(c.linked=!0,i.hasLinkedRanges=!0):i.firstNonLinked||(i.firstNonLinked=c)}i.firstNonLinked||(i.hasLinkedRanges=!1),i===e&&(a.push(i),this.$openTabstops[n]=i),this.addTabstopMarkers(i)}),this),a.length>2&&(this.tabstops.length&&a.push(a.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,a))},this.addTabstopMarkers=function(e){var t=this.editor.session;e.forEach((function(e){e.markerId||(e.markerId=t.addMarker(e,"ace_snippet-marker","text"))}))},this.removeTabstopMarkers=function(e){var t=this.editor.session;e.forEach((function(e){t.removeMarker(e.markerId),e.markerId=null}))},this.removeRange=function(e){var t=e.tabstop.indexOf(e);e.tabstop.splice(t,1),t=this.ranges.indexOf(e),this.ranges.splice(t,1),this.editor.session.removeMarker(e.markerId),e.tabstop.length||(t=this.tabstops.indexOf(e.tabstop),-1!=t&&this.tabstops.splice(t,1),this.tabstops.length||this.detach())},this.keyboardHandler=new l,this.keyboardHandler.bindKeys({Tab:function(e){t.snippetManager&&t.snippetManager.expandWithTab(e)||e.tabstopManager.tabNext(1)},"Shift-Tab":function(e){e.tabstopManager.tabNext(-1)},Esc:function(e){e.tabstopManager.detach()},Return:function(e){return!1}})}).call(d.prototype);var h={};h.onChange=r.prototype.onChange,h.setPosition=function(e,t){this.pos.row=e,this.pos.column=t},h.update=function(e,t,n){this.$insertRight=n,this.pos=e,this.onChange(t)};var f=function(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row},g=function(e,t){e.row==t.row&&(e.column-=t.column),e.row-=t.row};e("./lib/dom").importCssString(".ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}"),t.snippetManager=new u;var m=e("./editor").Editor;(function(){this.insertSnippet=function(e,n){return t.snippetManager.insertSnippet(this,e,n)},this.expandSnippet=function(e){return t.snippetManager.expandWithTab(this,e)}}).call(m.prototype)})),ace.define("ace/autocomplete/popup",["require","exports","module","ace/virtual_renderer","ace/editor","ace/range","ace/lib/event","ace/lib/lang","ace/lib/dom"],(function(e,t,n){"use strict";var i=e("../virtual_renderer").VirtualRenderer,o=e("../editor").Editor,a=e("../range").Range,s=e("../lib/event"),r=e("../lib/lang"),l=e("../lib/dom"),c=function(e){var t=new i(e);t.$maxLines=4;var n=new o(t);return n.setHighlightActiveLine(!1),n.setShowPrintMargin(!1),n.renderer.setShowGutter(!1),n.renderer.setHighlightGutterLine(!1),n.$mouseHandler.$focusWaitTimout=0,n.$highlightTagPending=!0,n},p=function(e){var t=l.createElement("div"),n=new c(t);e&&e.appendChild(t),t.style.display="none",n.renderer.content.style.cursor="default",n.renderer.setStyle("ace_autocomplete"),n.setOption("displayIndentGuides",!1),n.setOption("dragDelay",150);var i,o=function(){};n.focus=o,n.$isFocused=!0,n.renderer.$cursorLayer.restartTimer=o,n.renderer.$cursorLayer.element.style.opacity=0,n.renderer.$maxLines=8,n.renderer.$keepTextAreaAtCursor=!1,n.setHighlightActiveLine(!1),n.session.highlight(""),n.session.$searchHighlight.clazz="ace_highlight-marker",n.on("mousedown",(function(e){var t=e.getDocumentPosition();n.selection.moveToPosition(t),u.start.row=u.end.row=t.row,e.stop()}));var p=new a(-1,0,-1,1/0),u=new a(-1,0,-1,1/0);u.id=n.session.addMarker(u,"ace_active-line","fullLine"),n.setSelectOnHover=function(e){e?p.id&&(n.session.removeMarker(p.id),p.id=null):p.id=n.session.addMarker(p,"ace_line-hover","fullLine")},n.setSelectOnHover(!1),n.on("mousemove",(function(e){if(i){if(i.x!=e.x||i.y!=e.y){i=e,i.scrollTop=n.renderer.scrollTop;var t=i.getDocumentPosition().row;p.start.row!=t&&(p.id||n.setRow(t),h(t))}}else i=e})),n.renderer.on("beforeRender",(function(){if(i&&-1!=p.start.row){i.$pos=null;var e=i.getDocumentPosition().row;p.id||n.setRow(e),h(e,!0)}})),n.renderer.on("afterRender",(function(){var e=n.getRow(),t=n.renderer.$textLayer,i=t.element.childNodes[e-t.config.firstRow];i!=t.selectedNode&&(t.selectedNode&&l.removeCssClass(t.selectedNode,"ace_selected"),t.selectedNode=i,i&&l.addCssClass(i,"ace_selected"))}));var d=function(){h(-1)},h=function(e,t){e!==p.start.row&&(p.start.row=p.end.row=e,t||n.session._emit("changeBackMarker"),n._emit("changeHoverMarker"))};n.getHoveredRow=function(){return p.start.row},s.addListener(n.container,"mouseout",d),n.on("hide",d),n.on("changeSelection",d),n.session.doc.getLength=function(){return n.data.length},n.session.doc.getLine=function(e){var t=n.data[e];return"string"==typeof t?t:t&&t.value||""};var f=n.session.bgTokenizer;return f.$tokenizeRow=function(e){var t=n.data[e],i=[];if(!t)return i;"string"==typeof t&&(t={value:t}),t.caption||(t.caption=t.value||t.name);for(var o,a,s=-1,r=0;r<t.caption.length;r++)a=t.caption[r],o=t.matchMask&1<<r?1:0,s!==o?(i.push({type:t.className||(o?"completion-highlight":""),value:a}),s=o):i[i.length-1].value+=a;if(t.meta){var l=n.renderer.$size.scrollerWidth/n.renderer.layerConfig.characterWidth,c=t.meta;c.length+t.caption.length>l-2&&(c=c.substr(0,l-t.caption.length-3)+"…"),i.push({type:"rightAlignedText",value:c})}return i},f.$updateOnChange=o,f.start=o,n.session.$computeWidth=function(){return this.screenWidth=0},n.$blockScrolling=1/0,n.isOpen=!1,n.isTopdown=!1,n.autoSelect=!0,n.data=[],n.setData=function(e){n.setValue(r.stringRepeat("\n",e.length),-1),n.data=e||[],n.setRow(0)},n.getData=function(e){return n.data[e]},n.getRow=function(){return u.start.row},n.setRow=function(e){e=Math.max(this.autoSelect?0:-1,Math.min(this.data.length,e)),u.start.row!=e&&(n.selection.clearSelection(),u.start.row=u.end.row=e||0,n.session._emit("changeBackMarker"),n.moveCursorTo(e||0,0),n.isOpen&&n._signal("select"))},n.on("changeSelection",(function(){n.isOpen&&n.setRow(n.selection.lead.row),n.renderer.scrollCursorIntoView()})),n.hide=function(){this.container.style.display="none",this._signal("hide"),n.isOpen=!1},n.show=function(e,t,o){var a=this.container,s=window.innerHeight,r=window.innerWidth,l=this.renderer,c=l.$maxLines*t*1.4,p=e.top+this.$borderSize,u=p>s/2&&!o;u&&p+t+c>s?(l.$maxPixelHeight=p-2*this.$borderSize,a.style.top="",a.style.bottom=s-p+"px",n.isTopdown=!1):(p+=t,l.$maxPixelHeight=s-p-.2*t,a.style.top=p+"px",a.style.bottom="",n.isTopdown=!0),a.style.display="",this.renderer.$textLayer.checkForSizeChanges();var d=e.left;d+a.offsetWidth>r&&(d=r-a.offsetWidth),a.style.left=d+"px",this._signal("show"),i=null,n.isOpen=!0},n.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},n.$imageSize=0,n.$borderSize=1,n};l.importCssString(".ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);}.ace_editor.ace_autocomplete .ace_line-hover {    position: absolute;    z-index: 2;}.ace_editor.ace_autocomplete .ace_scroller {   background: none;   border: none;   box-shadow: none;}.ace_rightAlignedText {    color: gray;    display: inline-block;    position: absolute;    right: 4px;    text-align: right;    z-index: -1;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #000;    text-shadow: 0 0 0.01em;}.ace_editor.ace_autocomplete {    width: 280px;    z-index: 200000;    background: #fbfbfb;    color: #444;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;}"),t.AcePopup=p})),ace.define("ace/autocomplete/util",["require","exports","module"],(function(e,t,n){"use strict";t.parForEach=function(e,t,n){var i=0,o=e.length;0===o&&n();for(var a=0;a<o;a++)t(e[a],(function(e,t){i++,i===o&&n(e,t)}))};var i=/[a-zA-Z_0-9\$\-\u00A2-\uFFFF]/;t.retrievePrecedingIdentifier=function(e,t,n){n=n||i;for(var o=[],a=t-1;a>=0;a--){if(!n.test(e[a]))break;o.push(e[a])}return o.reverse().join("")},t.retrieveFollowingIdentifier=function(e,t,n){n=n||i;for(var o=[],a=t;a<e.length;a++){if(!n.test(e[a]))break;o.push(e[a])}return o},t.getCompletionPrefix=function(e){var t,n=e.getCursorPosition(),i=e.session.getLine(n.row);return e.completers.forEach(function(e){e.identifierRegexps&&e.identifierRegexps.forEach(function(e){!t&&e&&(t=this.retrievePrecedingIdentifier(i,n.column,e))}.bind(this))}.bind(this)),t||this.retrievePrecedingIdentifier(i,n.column)}})),ace.define("ace/autocomplete",["require","exports","module","ace/keyboard/hash_handler","ace/autocomplete/popup","ace/autocomplete/util","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/snippets"],(function(e,t,n){"use strict";var i=e("./keyboard/hash_handler").HashHandler,o=e("./autocomplete/popup").AcePopup,a=e("./autocomplete/util"),s=(e("./lib/event"),e("./lib/lang")),r=e("./lib/dom"),l=e("./snippets").snippetManager,c=function(){this.autoInsert=!1,this.autoSelect=!0,this.exactMatch=!1,this.gatherCompletionsId=0,this.keyboardHandler=new i,this.keyboardHandler.bindKeys(this.commands),this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.changeTimer=s.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=s.delayedCall(this.updateDocTooltip.bind(this),50)};(function(){this.$init=function(){return this.popup=new o(document.body||document.documentElement),this.popup.on("click",function(e){this.insertMatch(),e.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.tooltipTimer.bind(null,null)),this.popup.on("select",this.tooltipTimer.bind(null,null)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup},this.getPopup=function(){return this.popup||this.$init()},this.openPopup=function(e,t,n){this.popup||this.$init(),this.popup.autoSelect=this.autoSelect,this.popup.setData(this.completions.filtered),e.keyBinding.addKeyboardHandler(this.keyboardHandler);var i=e.renderer;if(this.popup.setRow(this.autoSelect?0:-1),n)n&&!t&&this.detach();else{this.popup.setTheme(e.getTheme()),this.popup.setFontSize(e.getFontSize());var o=i.layerConfig.lineHeight,a=i.$cursorLayer.getPixelPosition(this.base,!0);a.left-=this.popup.getTextLeftOffset();var s=e.container.getBoundingClientRect();a.top+=s.top-i.layerConfig.offset,a.left+=s.left-e.renderer.scrollLeft,a.left+=i.gutterWidth,this.popup.show(a,o)}},this.detach=function(){this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener),this.changeTimer.cancel(),this.hideDocTooltip(),this.gatherCompletionsId+=1,this.popup&&this.popup.isOpen&&this.popup.hide(),this.base&&this.base.detach(),this.activated=!1,this.completions=this.base=null},this.changeListener=function(e){var t=this.editor.selection.lead;(t.row!=this.base.row||t.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},this.blurListener=function(e){var t=document.activeElement,n=this.editor.textInput.getElement(),i=e.relatedTarget&&this.tooltipNode&&this.tooltipNode.contains(e.relatedTarget),o=this.popup&&this.popup.container;t==n||t.parentNode==o||i||t==this.tooltipNode||e.relatedTarget==n||this.detach()},this.mousedownListener=function(e){this.detach()},this.mousewheelListener=function(e){this.detach()},this.goTo=function(e){var t=this.popup.getRow(),n=this.popup.session.getLength()-1;switch(e){case"up":t=t<=0?n:t-1;break;case"down":t=t>=n?-1:t+1;break;case"start":t=0;break;case"end":t=n;break}this.popup.setRow(t)},this.insertMatch=function(e,t){if(e||(e=this.popup.getData(this.popup.getRow())),!e)return!1;if(e.completer&&e.completer.insertMatch)e.completer.insertMatch(this.editor,e);else{if(this.completions.filterText)for(var n,i=this.editor.selection.getAllRanges(),o=0;n=i[o];o++)n.start.column-=this.completions.filterText.length,this.editor.session.remove(n);e.snippet?l.insertSnippet(this.editor,e.snippet):this.editor.execCommand("insertstring",e.value||e)}this.detach()},this.commands={Up:function(e){e.completer.goTo("up")},Down:function(e){e.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(e){e.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(e){e.completer.goTo("end")},Esc:function(e){e.completer.detach()},Return:function(e){return e.completer.insertMatch()},"Shift-Return":function(e){e.completer.insertMatch(null,{deleteSuffix:!0})},Tab:function(e){var t=e.completer.insertMatch();if(t||e.tabstopManager)return t;e.completer.goTo("down")},PageUp:function(e){e.completer.popup.gotoPageUp()},PageDown:function(e){e.completer.popup.gotoPageDown()}},this.gatherCompletions=function(e,t){var n=e.getSession(),i=e.getCursorPosition(),o=a.getCompletionPrefix(e);this.base=n.doc.createAnchor(i.row,i.column-o.length),this.base.$insertRight=!0;var s=[],r=e.completers.length;return e.completers.forEach((function(l,c){l.getCompletions(e,n,i,o,(function(n,i){!n&&i&&(s=s.concat(i)),t(null,{prefix:a.getCompletionPrefix(e),matches:s,finished:0===--r})}))})),!0},this.showPopup=function(e){this.editor&&this.detach(),this.activated=!0,this.editor=e,e.completer!=this&&(e.completer&&e.completer.detach(),e.completer=this),e.on("changeSelection",this.changeListener),e.on("blur",this.blurListener),e.on("mousedown",this.mousedownListener),e.on("mousewheel",this.mousewheelListener),this.updateCompletions()},this.updateCompletions=function(e){if(e&&this.base&&this.completions){var t=this.editor.getCursorPosition(),n=this.editor.session.getTextRange({start:this.base,end:t});if(n==this.completions.filterText)return;return this.completions.setFilter(n),this.completions.filtered.length?1!=this.completions.filtered.length||this.completions.filtered[0].value!=n||this.completions.filtered[0].snippet?void this.openPopup(this.editor,n,e):this.detach():this.detach()}var i=this.gatherCompletionsId;this.gatherCompletions(this.editor,function(t,n){var o=function(){if(n.finished)return this.detach()}.bind(this),a=n.prefix,s=n&&n.matches;if(!s||!s.length)return o();if(0===a.indexOf(n.prefix)&&i==this.gatherCompletionsId){this.completions=new p(s),this.exactMatch&&(this.completions.exactMatch=!0),this.completions.setFilter(a);var r=this.completions.filtered;return r.length&&(1!=r.length||r[0].value!=a||r[0].snippet)?this.autoInsert&&1==r.length&&n.finished?this.insertMatch(r[0]):void this.openPopup(this.editor,a,e):o()}}.bind(this))},this.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},this.updateDocTooltip=function(){var e=this.popup,t=e.data,n=t&&(t[e.getHoveredRow()]||t[e.getRow()]),i=null;return n&&this.editor&&this.popup.isOpen?(this.editor.completers.some((function(e){return e.getDocTooltip&&(i=e.getDocTooltip(n)),i})),i||(i=n),"string"==typeof i&&(i={docText:i}),i&&(i.docHTML||i.docText)?void this.showDocTooltip(i):this.hideDocTooltip()):this.hideDocTooltip()},this.showDocTooltip=function(e){this.tooltipNode||(this.tooltipNode=r.createElement("div"),this.tooltipNode.className="ace_tooltip ace_doc-tooltip",this.tooltipNode.style.margin=0,this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this),this.tooltipNode.onclick=this.onTooltipClick.bind(this));var t=this.tooltipNode;e.docHTML?t.innerHTML=e.docHTML:e.docText&&(t.textContent=e.docText),t.parentNode||document.body.appendChild(t);var n=this.popup,i=n.container.getBoundingClientRect();t.style.top=n.container.style.top,t.style.bottom=n.container.style.bottom,window.innerWidth-i.right<320?(t.style.right=window.innerWidth-i.left+"px",t.style.left=""):(t.style.left=i.right+1+"px",t.style.right=""),t.style.display="block"},this.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),this.tooltipNode){var e=this.tooltipNode;this.editor.isFocused()||document.activeElement!=e||this.editor.focus(),this.tooltipNode=null,e.parentNode&&e.parentNode.removeChild(e)}},this.onTooltipClick=function(e){var t=e.target;while(t&&t!=this.tooltipNode){if("A"==t.nodeName&&t.href){t.rel="noreferrer",t.target="_blank";break}t=t.parentNode}}}).call(c.prototype),c.startCommand={name:"startAutocomplete",exec:function(e){e.completer||(e.completer=new c),e.completer.autoInsert=!1,e.completer.autoSelect=!0,e.completer.showPopup(e),e.completer.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var p=function(e,t){this.all=e,this.filtered=e,this.filterText=t||"",this.exactMatch=!1};(function(){this.setFilter=function(e){if(e.length>this.filterText&&0===e.lastIndexOf(this.filterText,0))var t=this.filtered;else t=this.all;this.filterText=e,t=this.filterCompletions(t,this.filterText),t=t.sort((function(e,t){return t.exactMatch-e.exactMatch||t.score-e.score}));var n=null;t=t.filter((function(e){var t=e.snippet||e.caption||e.value;return t!==n&&(n=t,!0)})),this.filtered=t},this.filterCompletions=function(e,t){var n=[],i=t.toUpperCase(),o=t.toLowerCase();e:for(var a,s=0;a=e[s];s++){var r=a.value||a.caption||a.snippet;if(r){var l,c,p=-1,u=0,d=0;if(this.exactMatch){if(t!==r.substr(0,t.length))continue e}else for(var h=0;h<t.length;h++){var f=r.indexOf(o[h],p+1),g=r.indexOf(i[h],p+1);if(l=f>=0&&(g<0||f<g)?f:g,l<0)continue e;c=l-p-1,c>0&&(-1===p&&(d+=10),d+=c),u|=1<<l,p=l}a.matchMask=u,a.exactMatch=d?0:1,a.score=(a.score||0)-d,n.push(a)}}return n}}).call(p.prototype),t.Autocomplete=c,t.FilteredList=p})),ace.define("ace/autocomplete/text_completer",["require","exports","module","ace/range"],(function(e,t,n){var i=e("../range").Range,o=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;function a(e,t){var n=e.getTextRange(i.fromPoints({row:0,column:0},t));return n.split(o).length-1}function s(e,t){var n=a(e,t),i=e.getValue().split(o),s=Object.create(null),r=i[n];return i.forEach((function(e,t){if(e&&e!==r){var o=Math.abs(n-t),a=i.length-o;s[e]?s[e]=Math.max(a,s[e]):s[e]=a}})),s}t.getCompletions=function(e,t,n,i,o){var a=s(t,n,i),r=Object.keys(a);o(null,r.map((function(e){return{caption:e,value:e,score:a[e],meta:"local"}})))}})),ace.define("ace/ext/language_tools",["require","exports","module","ace/snippets","ace/autocomplete","ace/config","ace/lib/lang","ace/autocomplete/util","ace/autocomplete/text_completer","ace/editor","ace/config"],(function(e,t,n){"use strict";var i=e("../snippets").snippetManager,o=e("../autocomplete").Autocomplete,a=e("../config"),s=e("../lib/lang"),r=e("../autocomplete/util"),l=e("../autocomplete/text_completer"),c={getCompletions:function(e,t,n,i,o){if(t.$mode.completer)return t.$mode.completer.getCompletions(e,t,n,i,o);var a=e.session.getState(n.row),s=t.$mode.getCompletions(a,t,n,i);o(null,s)}},p={getCompletions:function(e,t,n,o,a){var s=i.snippetMap,r=[];i.getActiveScopes(e).forEach((function(e){for(var t=s[e]||[],n=t.length;n--;){var i=t[n],o=i.name||i.tabTrigger;o&&r.push({caption:o,snippet:i.content,meta:i.tabTrigger&&!i.name?i.tabTrigger+"⇥ ":"snippet",type:"snippet"})}}),this),a(null,r)},getDocTooltip:function(e){"snippet"!=e.type||e.docHTML||(e.docHTML=["<b>",s.escapeHTML(e.caption),"</b>","<hr></hr>",s.escapeHTML(e.snippet)].join(""))}},u=[p,l,c];t.setCompleters=function(e){u.length=0,e&&u.push.apply(u,e)},t.addCompleter=function(e){u.push(e)},t.textCompleter=l,t.keyWordCompleter=c,t.snippetCompleter=p;var d={name:"expandSnippet",exec:function(e){return i.expandWithTab(e)},bindKey:"Tab"},h=function(e,t){f(t.session.$mode)},f=function(e){var t=e.$id;i.files||(i.files={}),g(t),e.modes&&e.modes.forEach(f)},g=function(e){if(e&&!i.files[e]){var t=e.replace("mode","snippets");i.files[e]={},a.loadModule(t,(function(t){t&&(i.files[e]=t,!t.snippets&&t.snippetText&&(t.snippets=i.parseSnippetFile(t.snippetText)),i.register(t.snippets||[],t.scope),t.includeScopes&&(i.snippetMap[t.scope].includeScopes=t.includeScopes,t.includeScopes.forEach((function(e){g("ace/mode/"+e)}))))}))}},m=function(e){var t=e.editor,n=t.completer&&t.completer.activated;if("backspace"===e.command.name)n&&!r.getCompletionPrefix(t)&&t.completer.detach();else if("insertstring"===e.command.name){var i=r.getCompletionPrefix(t);i&&!n&&(t.completer||(t.completer=new o),t.completer.autoInsert=!1,t.completer.showPopup(t))}},b=e("../editor").Editor;e("../config").defineOptions(b.prototype,"editor",{enableBasicAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:u),this.commands.addCommand(o.startCommand)):this.commands.removeCommand(o.startCommand)},value:!1},enableLiveAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:u),this.commands.on("afterExec",m)):this.commands.removeListener("afterExec",m)},value:!1},enableSnippets:{set:function(e){e?(this.commands.addCommand(d),this.on("changeMode",h),h(null,this)):(this.commands.removeCommand(d),this.off("changeMode",h))},value:!1}})})),function(){ace.acequire(["ace/ext/language_tools"],(function(){}))}()},"466d":function(e,t,n){"use strict";var i=n("d784"),o=n("825a"),a=n("50c4"),s=n("1d80"),r=n("8aa5"),l=n("14c3");i("match",1,(function(e,t,n){return[function(t){var n=s(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](String(n))},function(e){var i=n(t,e,this);if(i.done)return i.value;var s=o(e),c=String(this);if(!s.global)return l(s,c);var p=s.unicode;s.lastIndex=0;var u,d=[],h=0;while(null!==(u=l(s,c))){var f=String(u[0]);d[h]=f,""===f&&(s.lastIndex=r(c,a(s.lastIndex),p)),h++}return 0===h?null:d}]}))},"4e36":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor-container"},[n("pre",{staticClass:"editor monaco-lite-monaco-x2"})])}],a=n("2ef0"),s={data:function(){return{count:1,editor:null,defaultConfig:{language:"sql",theme:"vs",automaticLayout:!0,selectionHighlight:!0,wordWrap:"on",scrollbar:{useShadows:!1,verticalHasArrows:!1,horizontalHasArrows:!1,vertical:"hidden",horizontal:"hidden",verticalScrollbarSize:0,horizontalScrollbarSize:17,arrowSize:30}},cacheConfig:{}}},props:{sqlData:{type:String,default:function(){return""}},config:{type:Object,default:function(){return{}}}},watch:{sqlData:function(e){console.log("======= monaco lite ========="),e||(e=""),this.init(e)},config:function(e,t){this.editor&&!a["isEqual"](e,t)&&this.setConfig(e)}},methods:{setConfig:function(e){console.log("更细config.."),this.editor.updateOptions(e),this.init(this.sqlData)},refresh:function(e){this.init(e)},setCount:function(e){this.count=e},setSql:function(e){this.editor.setValue(e)},init:function(e){var t=this;if(this.editor)this.editor.setValue(e);else{var n=this.$el.getElementsByClassName("monaco-lite-monaco-x2")[0],i=a["merge"]({},this.defaultConfig,this.config);i.value=e,this.editor=monaco.editor.create(n,i),this.editor.onDidChangeModelContent((function(){if(-1!=t.$store.state.MAX_LINE){var e=t.editor.getModel().getLineCount();e>t.$store.state.MAX_LINE?t.$store.commit("isMaxLine",t.$store.state.isMaxLine+1):t.$store.commit("isMaxLine",0)}t.count>=1&&t.$emit("change",t.editor.getValue()),t.count++}))}}},mounted:function(){this.init(this.sqlData)}},r=s,l=(n("e55c"),n("2877")),c=Object(l["a"])(r,i,o,!1,null,"fa7ae49a",null);t["a"]=c.exports},"55ce":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"select-database"},[n("el-select",{ref:"select",staticClass:"select-database-select",attrs:{disabled:e.disabled2,readonly:"",filterable:"","popper-class":e.selectedValue?"select-database-select2 select-database-select-1":"select-database-select2 select-database-select-0",placeholder:e.dataBaseList&&e.dataBaseList.length>0?"请选择数据库实例":"无数据",title:e.selectedValue},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},[e._l(e.dataBaseList,(function(t){return n("el-option-group",{key:t.id,attrs:{label:t.name,name:t.name,title:"类型"}},[e._l(t.children,(function(t){return e._l(t.children,(function(i){return n("el-option",{key:i.id,attrs:{label:i.label,value:i},nativeOn:{click:function(n){return e.onSelectInstance(t,i)}}},[n("span",{staticStyle:{float:"left"},attrs:{title:"数据库实例"}},[n("el-tag",{staticClass:"auth-tag",class:"tags-"+i.rw,attrs:{title:e.rws[i.rw]+"权限"}},[e._v(" "+e._s(e.rws[i.rw])+" ")]),n("span",{staticStyle:{"margin-left":"5px"},attrs:{title:"数据库："+i.label}},[e._v(" "+e._s(i.label)+" ")])],1),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px","padding-left":"10px"},attrs:{title:"数据源"}},[e._v(e._s(t.name))])])}))}))],2)})),n("div",{staticClass:"select-end"},[e._v("- 结束 -")])],2)],1)},o=[],a=(n("99af"),{name:"select-database",props:{dataBaseList:{},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{selecedDB:{},disabled2:!1,rws:{1:"读",2:"读写",3:"禁",4:"管理"},isShow:!1,selectedInstance:null,selectedValue:"",selectedSource:null}},methods:{init:function(e){var t=this;if(this.selecedDB=e.selecedDB,console.log("instance.label ====================================",this.selecedDB.instance.label),this.disabled2=!1,e&&e.db_id&&e.owner)this.setInstance(e,!0);else{var n=this.selecedDB;null===n?(this.selectedSource=null,this.selectedInstance=null,this.selectedValue=""):(this.selectedSource=n.source,this.selectedInstance=n.instance,this.selectedValue="[".concat(n.instance.db_type,"] ").concat(n.source.label,"/").concat(n.instance.label))}console.log("instance.label selectedValue222: ",this.selectedValue),this.$nextTick((function(){t.disabled2=t.disabled}))},setInstance:function(e,t){var n=e.db_id,i=e.owner;if(this.dataBaseList&&this.dataBaseList.length>0)for(var o in this.dataBaseList){var a=this.dataBaseList[o];for(var s in a.children){var r=a.children[s];if(r&&r.db_id==n)for(var l in r.children){var c=r.children[l];if(c&&c.label==i)return this.onSelectInstance(r,c,t),!1}}}},onSelectInstance:function(e,t,n){this.selectedSource=e,this.selectedInstance=t,this.selectedValue="[".concat(t.db_type,"] ").concat(e.label,"/").concat(t.label),n||this.$emit("select-change",{source:e,instance:t})}}}),s=a,r=(n("6413"),n("2877")),l=Object(r["a"])(s,i,o,!1,null,null,null);t["a"]=l.exports},"615f":function(e,t,n){"use strict";var i=n("ce9d"),o=n.n(i);o.a},6413:function(e,t,n){"use strict";var i=n("bfa4"),o=n.n(i);o.a},"678d":function(e,t,n){},8882:function(e,t){ace.define("ace/mode/python_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,t,n){"use strict";var i=e("../lib/oop"),o=e("./text_highlight_rules").TextHighlightRules,a=function(){var e="and|as|assert|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|not|or|pass|print|raise|return|try|while|with|yield|async|await",t="True|False|None|NotImplemented|Ellipsis|__debug__",n="abs|divmod|input|open|staticmethod|all|enumerate|int|ord|str|any|eval|isinstance|pow|sum|basestring|execfile|issubclass|print|super|binfile|iter|property|tuple|bool|filter|len|range|type|bytearray|float|list|raw_input|unichr|callable|format|locals|reduce|unicode|chr|frozenset|long|reload|vars|classmethod|getattr|map|repr|xrange|cmp|globals|max|reversed|zip|compile|hasattr|memoryview|round|__import__|complex|hash|min|set|apply|delattr|help|next|setattr|buffer|dict|hex|object|slice|coerce|dir|id|oct|sorted|intern",i=this.createKeywordMapper({"invalid.deprecated":"debugger","support.function":n,"constant.language":t,keyword:e},"identifier"),o="(?:r|u|ur|R|U|UR|Ur|uR)?",a="(?:(?:[1-9]\\d*)|(?:0))",s="(?:0[oO]?[0-7]+)",r="(?:0[xX][\\dA-Fa-f]+)",l="(?:0[bB][01]+)",c="(?:"+a+"|"+s+"|"+r+"|"+l+")",p="(?:[eE][+-]?\\d+)",u="(?:\\.\\d+)",d="(?:\\d+)",h="(?:(?:"+d+"?"+u+")|(?:"+d+"\\.))",f="(?:(?:"+h+"|"+d+")"+p+")",g="(?:"+f+"|"+h+")",m="\\\\(x[0-9A-Fa-f]{2}|[0-7]{3}|[\\\\abfnrtv'\"]|U[0-9A-Fa-f]{8}|u[0-9A-Fa-f]{4})";this.$rules={start:[{token:"comment",regex:"#.*$"},{token:"string",regex:o+'"{3}',next:"qqstring3"},{token:"string",regex:o+'"(?=.)',next:"qqstring"},{token:"string",regex:o+"'{3}",next:"qstring3"},{token:"string",regex:o+"'(?=.)",next:"qstring"},{token:"constant.numeric",regex:"(?:"+g+"|\\d+)[jJ]\\b"},{token:"constant.numeric",regex:g},{token:"constant.numeric",regex:c+"[lL]\\b"},{token:"constant.numeric",regex:c+"\\b"},{token:i,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"\\+|\\-|\\*|\\*\\*|\\/|\\/\\/|%|<<|>>|&|\\||\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\[\\(\\{]"},{token:"paren.rparen",regex:"[\\]\\)\\}]"},{token:"text",regex:"\\s+"}],qqstring3:[{token:"constant.language.escape",regex:m},{token:"string",regex:'"{3}',next:"start"},{defaultToken:"string"}],qstring3:[{token:"constant.language.escape",regex:m},{token:"string",regex:"'{3}",next:"start"},{defaultToken:"string"}],qqstring:[{token:"constant.language.escape",regex:m},{token:"string",regex:"\\\\$",next:"qqstring"},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:m},{token:"string",regex:"\\\\$",next:"qstring"},{token:"string",regex:"'|$",next:"start"},{defaultToken:"string"}]}};i.inherits(a,o),t.PythonHighlightRules=a})),ace.define("ace/mode/folding/pythonic",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode"],(function(e,t,n){"use strict";var i=e("../../lib/oop"),o=e("./fold_mode").FoldMode,a=t.FoldMode=function(e){this.foldingStartMarker=new RegExp("([\\[{])(?:\\s*)$|("+e+")(?:\\s*)(?:#.*)?$")};i.inherits(a,o),function(){this.getFoldWidgetRange=function(e,t,n){var i=e.getLine(n),o=i.match(this.foldingStartMarker);if(o)return o[1]?this.openingBracketBlock(e,o[1],n,o.index):o[2]?this.indentationBlock(e,n,o.index+o[2].length):this.indentationBlock(e,n)}}.call(a.prototype)})),ace.define("ace/mode/python",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/python_highlight_rules","ace/mode/folding/pythonic","ace/range"],(function(e,t,n){"use strict";var i=e("../lib/oop"),o=e("./text").Mode,a=e("./python_highlight_rules").PythonHighlightRules,s=e("./folding/pythonic").FoldMode,r=e("../range").Range,l=function(){this.HighlightRules=a,this.foldingRules=new s("\\:"),this.$behaviour=this.$defaultBehaviour};i.inherits(l,o),function(){this.lineCommentStart="#",this.getNextLineIndent=function(e,t,n){var i=this.$getIndent(t),o=this.getTokenizer().getLineTokens(t,e),a=o.tokens;if(a.length&&"comment"==a[a.length-1].type)return i;if("start"==e){var s=t.match(/^.*[\{\(\[:]\s*$/);s&&(i+=n)}return i};var e={pass:1,return:1,raise:1,break:1,continue:1};this.checkOutdent=function(t,n,i){if("\r\n"!==i&&"\r"!==i&&"\n"!==i)return!1;var o=this.getTokenizer().getLineTokens(n.trim(),t).tokens;if(!o)return!1;do{var a=o.pop()}while(a&&("comment"==a.type||"text"==a.type&&a.value.match(/^\s+$/)));return!!a&&("keyword"==a.type&&e[a.value])},this.autoOutdent=function(e,t,n){n+=1;var i=this.$getIndent(t.getLine(n)),o=t.getTabString();i.slice(-o.length)==o&&t.remove(new r(n,i.length-o.length,n,i.length))},this.$id="ace/mode/python"}.call(l.prototype),t.Mode=l}))},"8a79":function(e,t,n){"use strict";var i=n("23e7"),o=n("06cf").f,a=n("50c4"),s=n("5a34"),r=n("1d80"),l=n("ab13"),c=n("c430"),p="".endsWith,u=Math.min,d=l("endsWith"),h=!c&&!d&&!!function(){var e=o(String.prototype,"endsWith");return e&&!e.writable}();i({target:"String",proto:!0,forced:!h&&!d},{endsWith:function(e){var t=String(r(this));s(e);var n=arguments.length>1?arguments[1]:void 0,i=a(t.length),o=void 0===n?i:u(a(n),i),l=String(e);return p?p.call(t,l,o):t.slice(o-l.length,o)===l}})},"8ef6":function(e,t){ace.define("ace/snippets/python",["require","exports","module"],(function(e,t,n){"use strict";t.snippetText='snippet #!\n\t#!/usr/bin/env python\nsnippet imp\n\timport ${1:module}\nsnippet from\n\tfrom ${1:package} import ${2:module}\n# Module Docstring\nsnippet docs\n\t\'\'\'\n\tFile: ${1:FILENAME:file_name}\n\tAuthor: ${2:author}\n\tDescription: ${3}\n\t\'\'\'\nsnippet wh\n\twhile ${1:condition}:\n\t\t${2:# TODO: write code...}\n# dowh - does the same as do...while in other languages\nsnippet dowh\n\twhile True:\n\t\t${1:# TODO: write code...}\n\t\tif ${2:condition}:\n\t\t\tbreak\nsnippet with\n\twith ${1:expr} as ${2:var}:\n\t\t${3:# TODO: write code...}\n# New Class\nsnippet cl\n\tclass ${1:ClassName}(${2:object}):\n\t\t"""${3:docstring for $1}"""\n\t\tdef __init__(self, ${4:arg}):\n\t\t\t${5:super($1, self).__init__()}\n\t\t\tself.$4 = $4\n\t\t\t${6}\n# New Function\nsnippet def\n\tdef ${1:fname}(${2:`indent(\'.\') ? \'self\' : \'\'`}):\n\t\t"""${3:docstring for $1}"""\n\t\t${4:# TODO: write code...}\nsnippet deff\n\tdef ${1:fname}(${2:`indent(\'.\') ? \'self\' : \'\'`}):\n\t\t${3:# TODO: write code...}\n# New Method\nsnippet defs\n\tdef ${1:mname}(self, ${2:arg}):\n\t\t${3:# TODO: write code...}\n# New Property\nsnippet property\n\tdef ${1:foo}():\n\t\tdoc = "${2:The $1 property.}"\n\t\tdef fget(self):\n\t\t\t${3:return self._$1}\n\t\tdef fset(self, value):\n\t\t\t${4:self._$1 = value}\n# Ifs\nsnippet if\n\tif ${1:condition}:\n\t\t${2:# TODO: write code...}\nsnippet el\n\telse:\n\t\t${1:# TODO: write code...}\nsnippet ei\n\telif ${1:condition}:\n\t\t${2:# TODO: write code...}\n# For\nsnippet for\n\tfor ${1:item} in ${2:items}:\n\t\t${3:# TODO: write code...}\n# Encodes\nsnippet cutf8\n\t# -*- coding: utf-8 -*-\nsnippet clatin1\n\t# -*- coding: latin-1 -*-\nsnippet cascii\n\t# -*- coding: ascii -*-\n# Lambda\nsnippet ld\n\t${1:var} = lambda ${2:vars} : ${3:action}\nsnippet .\n\tself.\nsnippet try Try/Except\n\ttry:\n\t\t${1:# TODO: write code...}\n\texcept ${2:Exception}, ${3:e}:\n\t\t${4:raise $3}\nsnippet try Try/Except/Else\n\ttry:\n\t\t${1:# TODO: write code...}\n\texcept ${2:Exception}, ${3:e}:\n\t\t${4:raise $3}\n\telse:\n\t\t${5:# TODO: write code...}\nsnippet try Try/Except/Finally\n\ttry:\n\t\t${1:# TODO: write code...}\n\texcept ${2:Exception}, ${3:e}:\n\t\t${4:raise $3}\n\tfinally:\n\t\t${5:# TODO: write code...}\nsnippet try Try/Except/Else/Finally\n\ttry:\n\t\t${1:# TODO: write code...}\n\texcept ${2:Exception}, ${3:e}:\n\t\t${4:raise $3}\n\telse:\n\t\t${5:# TODO: write code...}\n\tfinally:\n\t\t${6:# TODO: write code...}\n# if __name__ == \'__main__\':\nsnippet ifmain\n\tif __name__ == \'__main__\':\n\t\t${1:main()}\n# __magic__\nsnippet _\n\t__${1:init}__${2}\n# python debugger (pdb)\nsnippet pdb\n\timport pdb; pdb.set_trace()\n# ipython debugger (ipdb)\nsnippet ipdb\n\timport ipdb; ipdb.set_trace()\n# ipython debugger (pdbbb)\nsnippet pdbbb\n\timport pdbpp; pdbpp.set_trace()\nsnippet pprint\n\timport pprint; pprint.pprint(${1})${2}\nsnippet "\n\t"""\n\t${1:doc}\n\t"""\n# test function/method\nsnippet test\n\tdef test_${1:description}(${2:self}):\n\t\t${3:# TODO: write code...}\n# test case\nsnippet testcase\n\tclass ${1:ExampleCase}(unittest.TestCase):\n\t\t\n\t\tdef test_${2:description}(self):\n\t\t\t${3:# TODO: write code...}\nsnippet fut\n\tfrom __future__ import ${1}\n#getopt\nsnippet getopt\n\ttry:\n\t\t# Short option syntax: "hv:"\n\t\t# Long option syntax: "help" or "verbose="\n\t\topts, args = getopt.getopt(sys.argv[1:], "${1:short_options}", [${2:long_options}])\n\t\n\texcept getopt.GetoptError, err:\n\t\t# Print debug info\n\t\tprint str(err)\n\t\t${3:error_action}\n\n\tfor option, argument in opts:\n\t\tif option in ("-h", "--help"):\n\t\t\t${4}\n\t\telif option in ("-v", "--verbose"):\n\t\t\tverbose = argument\n',t.scope="python"}))},"8f1c":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-new-work"},[e.isEmpty?e._e():[n("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("项目："+e._s(e.project.name))]),n("el-form",{ref:"form",staticClass:"dialog-work-form",attrs:{model:e.formData,"label-width":"120px","label-suffix":":",rules:e.formRule}},[n("div",{staticClass:"left-section"},[n("monaco-lite",{ref:"monacoLite",staticClass:"work-sql",attrs:{"sql-data":e.sql},on:{change:e.monacoListChangeHandler}})],1),n("div",{staticClass:"right-section"},[n("div",{staticClass:"right-section-top"},[n("el-form-item",{attrs:{label:"导入文件"}},[n("el-input",{attrs:{readonly:!0,placeholder:"仅支持5M内的SQL文件"}},[n("template",{slot:"append"},[n("span",{staticClass:"open-file",on:{click:e.loadFile}},[e._v("打开文件")])])],2)],1),n("el-form-item",{staticClass:"work-name",attrs:{label:"工单名称",prop:"name"}},[n("el-input",{attrs:{type:"text",placeholder:"请输入工单名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),n("el-form-item",{attrs:{label:"数据库",prop:"db_id"}},[n("select-database",{ref:"selectDatabse",attrs:{dataBaseList:e.workSqlParams.dataBaseList},on:{"select-change":e.onSelectDatabseChangeHandler}})],1),n("el-form-item",{attrs:{label:"类型",prop:"type"}},[e.has_au?n("span",[e._v(e._s(e.currentSqlTypeText))]):e.has_au?n("el-tag",[e._v("未知")]):n("el-tag",[e._v("未审计")])],1),e.isAuditDQL?[n("el-form-item",{attrs:{label:"查询条数"}},[n("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.formData.fetch_size,callback:function(t){e.$set(e.formData,"fetch_size",t)},expression:"formData.fetch_size"}})],1),n("el-form-item",{attrs:{label:"查询类型"}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:!e.sqlTypeToolTip,content:e.sqlTypeToolTip,placement:"top"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.formData2TypeHandler},model:{value:e.formData2.type,callback:function(t){e.$set(e.formData2,"type",t)},expression:"formData2.type"}},[n("el-option",{attrs:{title:e.sqlTypeToolTips[5],label:"快照查询",value:"5"}}),n("el-option",{attrs:{title:e.sqlTypeToolTips[3],label:"在线查询",value:"3"}}),n("el-option",{attrs:{title:e.sqlTypeToolTips[4],label:"文件导出",value:"4"}})],1)],1)],1),4==e.formData2.type?n("el-form-item",{attrs:{label:"导出方式"}},[n("el-select",{attrs:{placeholder:"文件类型"},model:{value:e.formData.file_type,callback:function(t){e.$set(e.formData,"file_type",t)},expression:"formData.file_type"}},e._l(e.fileTypes,(function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1):e._e()]:e._e(),e.isAuditDQL?n("el-form-item",{attrs:{label:"忽略脱敏的字段"}},[n("el-tooltip",{attrs:{content:"越过脱敏策略，查询源数据"}},[n("el-input",{attrs:{placeholder:"请使用 , 号(英文逗号)分割"},model:{value:e.formData.no_mask_field,callback:function(t){e.$set(e.formData,"no_mask_field",t)},expression:"formData.no_mask_field"}})],1)],1):e._e(),n("el-form-item",{attrs:{label:"自动审计"}},[e.has_au?99==e.formData.sql_type?n("el-tag",{attrs:{type:"warning"}},[e._v("不支持审计")]):0==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"success"}},[e._v("通过")]):1==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"warning"}},[e._v("警告")]):2==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"danger"}},[e._v("错误")]):1==e.level&&"7"==e.stage_status?n("el-tag",{attrs:{type:"warning"}},[e._v("不支持审计")]):n("el-tag",[e._v("未知")]):n("el-tag",[e._v("未审计")])],1),"0"==e.stage_status?n("el-form-item",{attrs:{label:"预估影响行数"}},[n("h3",{staticStyle:{color:"red","fond-weight":"blod"}},[e._v(e._s(e.affected_rows))])]):e._e(),n("el-form-item",{attrs:{label:"审批流程"}},[n("el-tag",[e._v(e._s(e.project.sql_audit_auth_str))])],1),n("el-form-item",{attrs:{label:"执行时间"}},[n("el-checkbox",{attrs:{disabled:e.isAuditDQL,"true-label":1,"false-label":2},on:{change:e.onExecFlagHandler},model:{value:e.formData.exec_flag,callback:function(t){e.$set(e.formData,"exec_flag",t)},expression:"formData.exec_flag"}},[e._v("不限 ")])],1),2==e.formData.exec_flag?n("el-form-item",{staticClass:"work-exec-time",attrs:{label:"时间范围",prop:"execTimes"}},[n("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.formData.execTimes,callback:function(t){e.$set(e.formData,"execTimes",t)},expression:"formData.execTimes"}})],1):e._e(),n("el-form-item",{attrs:{label:"工单说明",prop:"mark"}},[n("el-input",{attrs:{rows:4,type:"textarea",placeholder:"请输入工单说明"},model:{value:e.formData.mark,callback:function(t){e.$set(e.formData,"mark",t)},expression:"formData.mark"}})],1)],2),n("div",{staticClass:"dialog-footer"},[n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loadings.audit,expression:"loadings.audit"}],attrs:{disabled:e.loadings.audit,type:"danger"},on:{click:e.handAudit}},[e._v("SQL 检测")]),n("el-button",{attrs:{disabled:!e.has_au,title:e.has_au?"单击提交":"请检测SQL后提交",type:"success"},on:{click:e.onSubmit}},[e._v("提 交")])],1)])]),n("h3",{staticStyle:{margin:"10px 0"}},[e._v("审计结果：")]),n("div",{staticStyle:{height:"400px"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadings.logList,expression:"loadings.logList"}],staticStyle:{width:"100%"},attrs:{data:e.sqlAuditLogData,border:!0,height:"400"}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(e._s(t.row.sql))])]}}],null,!1,4287002527)}),n("el-table-column",{attrs:{prop:"id",label:"ID",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.sql_no)+" ")]}}],null,!1,70425741)}),n("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"sql",label:"SQL语句"}}),n("el-table-column",{attrs:{prop:"level",width:"120",label:"审核/执行状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:e.showLevelTagType(t.row.level)}},[e._v(" "+e._s(e.showLevel(t.row.level))+" ")])]}}],null,!1,4223825722)}),n("el-table-column",{attrs:{prop:"result",width:"200",label:"审核/执行信息"}}),n("el-table-column",{attrs:{prop:"affected_rows",label:"扫描/影响行数",width:"120"}}),n("el-table-column",{attrs:{prop:"execute_time",width:"100",label:"执行耗时"}}),n("el-table-column",{attrs:{prop:"stage_status",width:"200",label:"当前阶段"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.showStageStatus(t.row.stage_status))+" ")]}}],null,!1,3280092576)})],1),n("el-pagination",{attrs:{"current-page":e.auditLogPages.pageNo,"page-sizes":[10,50,200,800],"page-size":e.auditLogPages.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.auditLogPages.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),n("dialog-audit-log",{ref:"sqlAuditLog"})],e.isEmpty?n("div",{staticClass:"page-empty"},[n("i",{staticClass:"sn-font"},[e._v("")]),e._m(0)]):e._e()],2)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b",[e._v("当前页面可能已经销毁，请从工作区创建工单！！")])])}],a=(n("c975"),n("b0c0"),n("d3b7"),n("498a"),n("96cf"),n("1da1")),s=n("5530"),r=n("2f62"),l=n("c1df"),c=n.n(l),p=n("da6f"),u=n("4e36"),d=n("55ce"),h=n("0107"),f=n("e31c"),g=n("ff60"),m="production";"production"==m&&(window.onbeforeunload=function(){return"Your work will be lost."});var b={props:{pageData:{type:Object,default:function(){return null}}},components:{DialogAuditLog:h["a"],MonacoLite:u["a"],"select-database":d["a"]},computed:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["sys","service","sqlTypes","fileTypes","isMaxLine","MAX_LINE"])),{},{isAuditDQL:function(){var e=this.has_au&&(3==this.formData.type||4==this.formData.type||5==this.formData.type);return e&&(this.formData.exec_flag=2),e},sqlTypeToolTip:function(){var e=this.sqlTypeToolTips[this.formData.type];return e||!1},currentSqlTypeText:function(){return this.sqlTypes[this.formData.type]}}),watch:{isMaxLine:function(e){e&&this.onError("SQL行数超过了最大值限制(max = ".concat(this.MAX_LINE,"行)，删除多余行！"),"错误",3500)}},data:function(){return{isEmpty:!1,workSqlParams:{},workId:null,workKey:null,loadings:{audit:!1,logList:!1},sqlAuditLogData:[],auditLogPages:{pageNo:1,pageSize:10,total:0},sqlTypeToolTips:{3:"在线查询：审批通过后，在工单执行时间范围内可多次查询实时数据",4:"文件导出：工单执行时根据查询结果生成文件，在工单执行时间范围内可重复下载",5:"查询快照：工单执行时根据结果生成数据快照，在工单执行时间范围内可多次查询数据快照"},has_au:!1,activeName:"工单详情",sql:"",workType:"auto",disabled:!1,disabled_backup:!0,typeText:null,role:{},level:0,affected_rows:0,stage_status:"",execTimes:[],isShow:!1,config:{lang:"sql"},data:{},db:{can_backup:1},formData2:{type:"3"},project:{},formData:this.resetFormData(),formRule:{execTimes:[{required:!0,message:"请选择时间范围"}],db_id:[{required:!0}],mark:[{required:!0,message:"请输入工单说明"}],name:[{required:!0,message:"请输入工单名称"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],audit_id:[{required:!0,message:"请选择审批人"}]},roleList:[]}},methods:{handleSizeChange:function(e){console.log(e),this.auditLogPages.pageNo=1,this.auditLogPages.pageSize=e,this.sqlAuditLogList()},handleCurrentChange:function(e){console.log(e),this.auditLogPages.pageNo=e,this.sqlAuditLogList()},showStageStatus:function(e){return this.$api.work.showStageStatus(e)},showStage:function(e){return this.$api.work.showStage(e)},showLevel:function(e){return this.$api.work.showLevelStyle(e)},showLevelTagType:function(e){return this.$api.work.showLevelTagType(e)},showStatus:function(e){return this.$api.work.showStatus(e)},loadFile:function(e){console.log("打开文件：",e),this.openFileEncode=e,this.$refs.openFile.click()},addContent:function(e){this.$refs.monacoLite.setSql(e)},getFile:function(e){if(window.FileReader){var t=e.target.files[0],n=t.size;if(n>1048576)this.$message({showClose:!0,type:"error",message:"打开失败，文件过大！（max=1M）"});else if(-1!=t.name.indexOf(".sql")){var i=new FileReader,o=this;i.onload=function(){o.addContent(this.result),e.target.value=""},i.readAsText(t,this.openFileEncode)}else this.$message.error("不支持该类型的文件上传")}},onExecFlagHandler:function(e){console.log(e),1==e&&(this.execTimes=[])},formData2TypeHandler:function(e){this.formData.exec_flag=3==e?2:1,this.formData.type=e},onSelectDatabseChangeHandler:function(e){var t=e.source,n=e.instance;console.log("触发数据库... ..."),this.formData.dbType=n.db_type,this.formData.db_id=n.db_id,this.formData.owner=n.label,this.formData.db=t.label,this.has_au=!1,this.workSqlParams.selecedDB={source:t,instance:n}},monacoListChangeHandler:function(e){this.formData.sql=e,this.has_au=!1},sqlAuditLogList:function(){var e=this;this.loadings.logList=!0,this.$api.work.sqlAuditList(this.workId,this.auditLogPages.pageNo-1,this.auditLogPages.pageSize).then((function(t){e.auditLogPages=Object(s["a"])(Object(s["a"])({},e.auditLogPages),{},{total:t.count}),e.sqlAuditLogData=t.list})).finally((function(){setTimeout((function(){e.loadings.logList=!1}),200)}))},handAudit:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.formData.sql&&e.formData.sql.trim()){t.next=3;break}return e.$message.error("审计内容不可为空，请输入SQL"),t.abrupt("return");case 3:return t.next=5,e.onAudit(e.formData.sql);case 5:n=t.sent,console.log("手动审计： ",e.formData.db_id,n.db_id),e.show(null,Object(s["a"])(Object(s["a"])({},n),{},{owner:e.formData.owner}),"hand-audit");case 8:case"end":return t.stop()}}),t)})))()},onAudit:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loadings.audit=!0,i=null,n.prev=2,o=Object(s["a"])(Object(s["a"])({},t.formData),{},{script:null,sql:e}),o.project=t.project.id,o.iid=o.db_id,o.db_type=o.dbType,o.token=Object(g["a"])(),t.workId=o.token,n.next=11,t.$api.work.work_audit(o);case 11:i=n.sent,n.next=19;break;case 14:n.prev=14,n.t0=n["catch"](2),console.error("dialg.work ==========   e:",n.t0),i=n.t0,t.onError(i,"审计错误");case 19:return n.prev=19,setTimeout((function(){t.loadings.audit=!1}),200),n.finish(19);case 22:return i.error&&t.onError(i.error,"审计错误"),console.log("审计结果：",i),t.sqlAuditLogList(),n.abrupt("return",i);case 26:case"end":return n.stop()}}),n,null,[[2,14,19,22]])})))()},show:function(e,t,n){var i=this,o=Object(s["a"])({},this.formData);t?(console.log("au: ",t),this.has_au=!0,12==t.sql_type||13==t.sql_type||14==t.sql_type?o.type=1:15==t.sql_type?o.type=2:11==t.sql_type?o.type=3:o.type=9):t={};var a=this.workSqlParams.data;console.log("serviceData: ",a),o.id=t.token||Object(g["a"])(),o.exec_flag=1,o.sql_type=t.sql_type||99,o.exec_start=null,o.exec_end=null,"hand-audit"!=n&&(a.script=f["a"].removeSoftRoute(a.script),this.sql=a.script,console.log("serviceData.script: ",a.script),o.sql=a.script,o.mark="",o.name=""),o.dbType=t.db_type||a.dbType,o.db_id=t.db_id||a.db_id,o.owner=t.owner||a.owner,o.audit_id=0,this.level=t.level,this.affected_rows=t.affected_rows,this.stage_status=t.stage_status,this.formData=Object(s["a"])({},o),this.isShow=!0,this.$nextTick((function(){i.$refs.monacoLite&&(i.$refs.monacoLite.setCount(0),i.$refs.monacoLite.init(i.formData.sql),i.$refs.selectDatabse.init({db_id:i.formData.db_id,owner:i.formData.owner,selecedDB:i.workSqlParams.selecedDB},!0))}))},tabHandleClick:function(e,t){console.log(e,t)},showLog:function(){this.$refs.sqlAuditLog.show(this.formData.id)},resetFormData:function(){return{id:"",exec_flag:1,exec_start:null,exec_end:null,source_type:"none",source_id:"none",sql:"",type:"",no_mask_field:"",fetch_size:500,file_type:"5",name:"",mark:"",audit_id:0,back_up:0,execTimes:[]}},hide:function(e){this.disabled=!1,this.isShow=!1,this.has_au=!1,this.level=0,this.affected_rows=0,this.formData=this.resetFormData(),this.formData2.type="3",this.sqlAuditLogData=[],this.$refs.monacoLite.setCount(0)},editorInit:function(){n("2099"),n("8882"),n("8ef6"),n("1d29")},onSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(t){var n=Object(s["a"])({},e.formData);if(delete n.execTimes,2==n.exec_flag){if(e.formData.execTimes<2)return void e.onError("时间范围出错，请重新选择！！");n.exec_start=c()(e.formData.execTimes[0]).format("YYYY-MM-DD HH:mm:ss"),n.exec_end=c()(e.formData.execTimes[1]).format("YYYY-MM-DD HH:mm:ss")}n.project=e.project.id,e.$api.work.add(n).then((function(){e.onSuccess("提交成功"),e.has_au=!1,e.$emit("submit",!0)})).catch((function(t){e.onError("提交失败"),e.$emit("submit",!1)}))}}))},deleteWokSQLAndClosPage:function(){Object(p["e"])(this.workKey),window.opener=null,window.open("","_self"),window.close()},init:function(e){var t=this;if(console.log("pageData: ",e),e)this.workSqlParams=e,this.project=e.project,this.show(null,null,null),this.handAudit();else{var n=this.$route.query.time;this.workKey="work-sql-".concat(n),Object(p["c"])(this.workKey,null).then((function(e){e?(t.workSqlParams=e,t.show(null,null,null),t.project=e.project,"production"==m&&Object(p["e"])(t.workKey)):t.isEmpty=!0}))}}}},v=b,_=(n("aad2"),n("615f"),n("2877")),w=Object(_["a"])(v,i,o,!1,null,null,null);t["default"]=w.exports},aad2:function(e,t,n){"use strict";var i=n("678d"),o=n.n(i);o.a},bfa4:function(e,t,n){},c01e:function(e,t,n){},ce9d:function(e,t,n){},e31c:function(e,t,n){"use strict";n("99af"),n("caad"),n("a15b"),n("d81d"),n("b0c0"),n("b64b"),n("ac1f"),n("8a79"),n("466d"),n("5319"),n("1276"),n("498a");var i=n("b85c"),o=["ssl","key","and"];function a(e){var t="";if(!e)return t;if(1==e.length)return"tt";var n=e.split("_");if(!n)return t;if(n.length>1){var a,s=Object(i["a"])(n);try{for(s.s();!(a=s.n()).done;){var r=a.value;t+=r.substr(0,1)}}catch(d){s.e(d)}finally{s.f()}}else if(1==n.length){e=e[0].toUpperCase()+e.substr(1,e.length);var l,c=e.match(/([A-Z]+)/g),p=Object(i["a"])(c);try{for(p.s();!(l=p.n()).done;){var u=l.value;t+=u[0]}}catch(d){p.e(d)}finally{p.f()}}return t=t.toLowerCase(),o.includes(t)?"".concat(t,"1"):t}var s={string_1:"GET key",string_2:"DEL key",string_3:"SET key value EX seconds",string_4:"SET key value EX seconds",hash_1:'HSCAN key 0 match "*" count 100',hash_2:"HDEL key field",hash_3:"HSET key field value",hash_4:"HSET key field value",set_1:'SSCAN key 0 match "*" count 100',set_2:"DEL key",set_3:"SADD key member",set_4:"SADD key member",zset_1:"ZRANGE key 0 100 WITHSCORES",zset_2:"ZREM key member",zset_3:"ZADD key score member",zset_4:"ZADD key score member",list_1:"LRANGE key 0 100",list_2:"DEL key",list_3:"LPUSH key value",list_4:"LPUSH key value",stream_1:"XREVRANGE key end start COUNT 100",stream_2:"DEL key",stream_3:"XADD key ID field value",stream_4:"XADD key ID field value"},r=/\s*--\s*mode=(.*?),/,l=/^\s*--\s*(mode|src|work_id|work_name|db|db_type)=.*,+.*(\r|\n)+/gm,c=/^\s*--\s*((mode|src|id|name|db|db_type)=.*,+.*?)(\r|\n)/gm,p=function(e){return e.trim().replace(l,"")},u=function(e){var t=/^\s*--\s*(mode|src|work_id|work_name|db|db_type)=.*,+.*(\r|\n)+/gm,n=t.exec(e.trim()),i=!!(n&&n.length>0)&&n[0];return i},d=function(e){var t=c.exec(e);c.lastIndex=0;var n=!!(t&&t.length>1)&&t[1];if(!n)return!1;var i=n.trim().split(","),o={};for(var a in i){var s=i[a],r=s.split("=");r&&2==r.length&&(o[r[0]]=r[1])}return Object.keys(o).length>0&&o},h=function(e){var t=r.exec(e);return console.log("result: ",t),!!(t&&t.length>0)&&t[1]},f=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"update";if("insert"==i){var o=[],a=[];for(var s in t)if("<nil>"!==t[s]&&"NULL"!==t[s]){o.push(s);var r=t[s];r=r.replace(/\'/g,"\\'").replace(/\"/g,'\\"'),a.push("'".concat(r,"'"))}return"INSERT INTO ".concat(e," (").concat(o.join(","),") VALUES (").concat(a.join(","),");")}if("delete"==i){var l=[];for(var c in n)if("<nil>"==n[c]||"NULL"==n[c])l.push("".concat(c," is NULL"));else{var p=n[c];p=p.replace(/\'/g,"\\'").replace(/\"/g,'\\"'),l.push("".concat(c," = '").concat(p,"'"))}var u="DELETE FROM ".concat(e," where ").concat(l.join(" AND "),";");return u}var d=[];for(var h in t)if("<nil>"==t[h]||"NULL"==t[h])d.push("".concat(h," = null"));else{var f=t[h];f=f.replace(/\'/g,"\\'").replace(/\"/g,'\\"'),d.push("".concat(h," = '").concat(f,"'"))}var g=[];for(var m in n){var b=n[m];"<nil>"==b||"NULL"==b?g.push("".concat(m," is NULL")):(b=b.replace(/\'/g,"\\'").replace(/\"/g,'\\"'),g.push("".concat(m," = '").concat(b,"'")))}var v="UPDATE ".concat(e," SET ").concat(d.join(" , ")," where ").concat(g.join(" AND "),";");return v},g=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"update",o=[];for(var a in t){var s=f(e,t[a],n[a],i);o.push(s)}return o},m=function(e){if(e){var t=e.sql;if(void 0==t&&(t=b(e)),!e.comment||!1==={"soft-route":!0,"dev-onbeforeunload":!0,"prod-onbeforeunload":!0}["soft-route"])return t;e.mode||(e.mode="标准"),t=t.trim().replace(l,""),t=t.endsWith(";")?t:t+";";var n=[];return n.push("\n"),n.push("-- "),n.push("mode=".concat(e.mode,",")),n.push(e.id?"id=".concat(e.id,","):""),n.push(e.name?"name=".concat(e.name,","):""),n.push("src=".concat(e.src||e.sourceName,",")),n.push("db=".concat(e.db||e.dbName,",")),n.push(e.db_type||e.dbType?"db_type=".concat(e.db_type||e.dbType):""),n.push("\n"),n.join("")+t+"\n"}console.error("[db.js generate] 参数错误 : ",e)},b=function(e){if(e&&e.dbType&&e.name&&e.type&&e.command){var t="";if("redis"==e.dbType){var n="".concat(e.type,"_").concat(e.command),i=s[n];i&&(t=i.replace("key",'"'.concat(e.name,'"')))}else{e.columns&&0!=e.columns.length||(e.columns=["*"]);var o=[],r=a(e.name),l=", ".concat(r,".");switch(e.command){case 9:o=["select \n\tcout(1)","from \n\t".concat(e.name," ")];break;case 8:o=["select \n\t".concat(r,".").concat(e.columns.join(l)," "),"from \n\t".concat(e.name," ").concat(r," ")];break;case 1:o=["select \n\t".concat(r,".").concat(e.columns.join(l)," "),"from \n\t".concat(e.name," ").concat(r," ")];break;case 2:o=["delete from ".concat(e.name," "),"where","\t1=2\t"];break;case 3:o=["update ".concat(e.name," set"),"\t".concat(e.columns.map((function(e){return"".concat(e," = :").concat(e)})).join(", \n\t")),"where","\t1=2\t"];break;case 4:o=["insert into ".concat(e.name),"\t(".concat(e.columns.join(", "),")"),"values","\t(:".concat(e.columns.join(", :"),")")];break;case 7:o=["select","\tcount(1)","from","\t".concat(e.name)];break}t=o.join("\n")}return t}console.error("[db.js generateSQL] 参数错误 - [dbType, name, type, command]",e)},v={getSoftRoute:u,removeSoftRoute:p,parserComments:d,getMode:h,generate:m,generateSQL:b,generateEffects:g,generateEffectRow:f};t["a"]=v},e55c:function(e,t,n){"use strict";var i=n("c01e"),o=n.n(i);o.a},ff60:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("99af"),n("a15b"),n("fb6a");var i=n("4360");var o=function(){var e=i["a"].state.user.id;return"".concat(Date.now()).concat(e)}}}]);