(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ae6eba70"],{"0c59":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pages-funs-work padding-x-24"},[a("k-search-table",{ref:"st",attrs:{url:"/api/project/work/page","search-data":t.search},on:{reset:t.resetSearch}},[a("template",{slot:"searchs"},[a("el-form-item",{attrs:{label:"名称",prop:"name",size:"mini"}},[a("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}})],1),a("el-form-item",{attrs:{label:"工单状态:"}},[a("el-select",{attrs:{clearable:!0},model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},t._l(t.work_states,(function(t){return a("el-option",{key:t.k,attrs:{label:t.v,value:t.k}})})),1)],1)],1),a("template",{slot:"columns"},[a("el-table-column",{attrs:{type:"expand",width:"40"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{attrs:{"label-position":"left","label-width":"50px"}},[a("el-form-item",{attrs:{label:"SQL"}},[e.row.sql&&e.row.sql.length>3e3?a("strong",{staticClass:"sql"},[t._v(" SQL语句过长，请在详情查看 ")]):a("pre",{staticClass:"sql"},[t._v("                 "+t._s(e.row.sql)+"\n              ")])])],1)]}}])}),a("el-table-column",{attrs:{label:"编号",prop:"id",width:"120"}}),a("el-table-column",{attrs:{label:"工单名称",prop:"name"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{"font-weight":"bold"},attrs:{size:"mini",type:"text",title:e.row.name},on:{click:function(a){return t.goWorkDetail(e.row)}}},[t._v(" "+t._s(e.row.name)+" ")])]}}])}),a("el-table-column",{attrs:{label:"类型",prop:"type","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{title:t.showWorkType(e.row.type)}},[t._v(t._s(t.showWorkType(e.row.type)))])]}}])}),a("el-table-column",{attrs:{label:"发起人",prop:"create_name"}}),a("el-table-column",{attrs:{label:"发起项目",prop:"project_name"}}),a("el-table-column",{attrs:{label:"工单状态",prop:"status","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.showTagType(e.row.status)}},[t._v(t._s(t.showStatus(e.row.status)))])]}}])}),a("el-table-column",{attrs:{label:"发起时间",prop:"created_at"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("dateTime")(e.row.created_at)))]}}])}),a("el-table-column",{attrs:{label:"目标数据源",prop:"db_name"}}),a("el-table-column",{attrs:{label:"目标数据库",prop:"owner"}}),a("el-table-column",{attrs:{label:"是否备份"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.back_up?a("span",{attrs:{type:"success"}},[t._v("是")]):a("span",{attrs:{type:"info"}},[t._v("否")])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.goWorkDetail(e.row)}}},[t._v("详情 ")]),1==e.row.back_up&&6==e.row.status?a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.goWorkBackUp(e.row)}}},[t._v("备份 ")]):t._e()]}}])})],1)],2),a("div",{staticStyle:{height:"150px"}}),a("dialog-detail",{ref:"detailDialog",on:{refresh:t.refresh}}),a("dialog-backup",{ref:"backupDialog"})],1)},o=[],r=(a("ac1f"),a("841c"),a("5530")),l=a("2f62"),n=a("c58e"),i=a("d170"),c={computed:Object(r["a"])(Object(r["a"])({},Object(l["c"])(["user","project_home"])),Object(l["b"])(["showWorkType"])),data:function(){return{formData:{name:""},id:this.$route.params.id,search2:{db_type:null,project:this.$route.params.id,status:-1},search:{db_type:null,project:this.$route.params.id,status:-1},work_states:[{k:-1,v:"全部"},{k:0,v:"待审核"},{k:1,v:"审核通过"},{k:2,v:"审核不通过"},{k:3,v:"人工终止流程"},{k:4,v:"定时执行"},{k:5,v:"执行中"},{k:68,v:"执行成功"},{k:7,v:"执行失败"}],status_types:[{k:"0",v:"全部"},{k:"1",v:"待审核"},{k:"2",v:"已通过"},{k:"3",v:"未通过"}]}},props:{},watch:{},methods:{showTagType:function(t){return this.$api.work.showTagType(t)},goWorkBackUp:function(t){this.$refs.backupDialog.show(t.id,!0)},goWorkDetail:function(t){this.$refs.detailDialog.show(t.id,!0)},showStatus:function(t){return this.$api.work.showStatus(t)},refresh:function(){this.$refs.st.search()},resetSearch:function(){console.log("========resetSearch========="),this.search={status:-1,project:this.id}},reload:function(){this.$refs.st.reload()},openApplyInfo:function(t){this.$refs.applyInfoDialog.show(t)},openWork:function(t){this.$refs.workDialog.show(t)},init:function(){},onDel:function(t){var e=this;this.$api.db.delete(t.id).then((function(){e.onSuccess("删除成功"),e.reload()}))}},components:{DialogDetail:n["a"],DialogBackup:i["a"]},mounted:function(){}},u=c,p=(a("968c"),a("2877")),f=Object(p["a"])(u,s,o,!1,null,null,null);e["default"]=f.exports},"968c":function(t,e,a){"use strict";var s=a("bf7c"),o=a.n(s);o.a},bf7c:function(t,e,a){}}]);