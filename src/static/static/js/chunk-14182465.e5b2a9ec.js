(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14182465"],{"0636":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"database"},[s("div",[s("span",{staticStyle:{padding:"20px"}},[t._v(" 权限组:"),t._l(t.role_names,(function(e){return s("el-tag",{key:e,staticStyle:{margin:"5px"},attrs:{type:"success"}},[t._v(t._s(e))])}))],2),t._m(0),s("el-tree",{ref:"tree2",attrs:{data:t.list,"node-key":"id",props:t.defaultProps,indent:26,isLeaf:function(t){return"col"==t.node_type},"highlight-current":"",lazy:"","default-expanded-keys":t.expKeys,load:t.onNextLoad},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,o=e.data;return s("span",{staticClass:"custom-tree-node"},[s("span",["db"==o.node_type?s("span",[t._v("["+t._s(o.db_type)+"]"+t._s(a.label)+" ")]):"owner"==o.node_type?s("span",[t._v("[实例]"+t._s(a.label)+" ")]):"table"==o.node_type?s("span",[t._v("[表]"+t._s(a.label)+" ")]):s("span",[t._v("[字段]"+t._s(a.label))]),1==o.rw?s("i",{staticClass:"sn-font text-success"},[t._v("读")]):t._e(),2==o.rw?s("i",{staticClass:"sn-font text-primary"},[t._v("写")]):t._e(),3==o.rw&&"col"!=o.node_type?s("i",{staticClass:"sn-font text-error"},[t._v("禁")]):t._e(),"col"!=o.node_type?s("span",[1==o.asyn_query?s("i",{staticClass:"sn-font text-success"},[t._v("")]):t._e(),1==o.asyn_export?s("i",{staticClass:"sn-font text-success"},[t._v("")]):t._e(),1==o.asyn_sql?s("i",{staticClass:"sn-font text-success"},[t._v("")]):t._e()]):t._e(),3==o.rw&&"col"==o.node_type?s("i",{staticClass:"sn-font text-error"},[t._v("敏")]):t._e()])])}}])})],1),s("dialog-apply",{ref:"applyDialog",on:{refresh:t.refresh}})],1)},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{padding:"20px","font-size":"12px"}},[t._v(" 图标: "),s("i",{staticClass:"sn-font text-success"},[t._v("")]),t._v(" 异步查询 "),s("i",{staticClass:"sn-font text-success"},[t._v("")]),t._v("异步导出/导出文件 "),s("i",{staticClass:"sn-font text-success"},[t._v("")]),t._v("导出Sql ")])}],n=(s("b0c0"),s("ac1f"),s("841c"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-dialog",{attrs:{title:"申请权限",visible:t.isShow,width:"600px"},on:{"update:visible":function(e){t.isShow=e}}},[s("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"120px","label-suffix":":",rules:t.formRule}},[s("el-form-item",{attrs:{label:"申请组"}},[s("el-input",{attrs:{disabled:""},model:{value:t.role.name,callback:function(e){t.$set(t.role,"name",e)},expression:"role.name"}})],1),s("el-form-item",{attrs:{label:"申请理由",prop:"opt_mark"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入申请理由"},model:{value:t.formData.opt_mark,callback:function(e){t.$set(t.formData,"opt_mark",e)},expression:"formData.opt_mark"}})],1),s("el-form-item",{attrs:{label:"审核人",prop:"auditor"}},[s("k-select",{attrs:{url:"/api/apply/manager/list"},model:{value:t.formData.auditor,callback:function(e){t.$set(t.formData,"auditor",e)},expression:"formData.auditor"}})],1),s("el-form-item",{attrs:{label:"抄送",prop:"copy_to"}},[s("k-select",{attrs:{url:"/api/apply/manager/list",multiple:!0},model:{value:t.formData.copy_to,callback:function(e){t.$set(t.formData,"copy_to",e)},expression:"formData.copy_to"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.hide}},[t._v("取消")]),s("el-button",{attrs:{type:"success"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)}),r=[],l={data:function(){return{role:{},isShow:!1,formData:{},formRule:{opt_mark:[{required:!0,message:"请输入申请理由"}]}}},props:{},watch:{},computed:{},methods:{show:function(t){this.role=t,this.formData.source_id=t.id,this.formData.source_type="role",this.isShow=!0},hide:function(t){this.isShow=!1},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){var s=t.formData;t.$api.apply.applyRole(s).then((function(){t.onSuccess("提交成功"),t.hide(),t.$emit("refresh")}),(function(e){var s="参数错误！";"301"!=e.result&&(s=e.data),t.onError(s)}))}}))}},mounted:function(){},components:{}},i=l,c=s("2877"),p=Object(c["a"])(i,n,r,!1,null,null,null),u=p.exports,f={data:function(){return{defaultProps:{children:"children",label:"name"},role_names:[],isShow:!1,doc:{},list:[],expKeys:[]}},computed:{},props:{},watch:{},methods:{refresh:function(){this.$refs.st.search()},resetSearch:function(){console.log("========resetSearch========="),this.search={}},reload:function(){this.$refs.st.reload()},reset:function(){return{state:0,roles:[],roles_str:""}},onNextLoad:function(t,e){var s=t.data;s&&s.length>0&&e(s),s&&"col"==s.node_type&&e([]),s&&s.children?e(s.children):s&&s.id&&s.name?this.$api.my.myAuthChildren(s).then((function(t){t?(s.children=t,e(t)):e([])})):e([])},openApply:function(t){this.$refs.applyDialog.show(t)},onLoad:function(){var t=this;this.$api.my.info().then((function(e){t.role_names=e.role_names})),this.$api.my.myAuth().then((function(e){if(t.list=e,e&&e.length)for(var s=0;s<e.length;s++)t.expKeys.push(e[s].id)}))}},components:{DialogApply:u},mounted:function(){this.onLoad()}},d=f,m=(s("6689"),Object(c["a"])(d,a,o,!1,null,null,null));e["default"]=m.exports},6689:function(t,e,s){"use strict";var a=s("82e7"),o=s.n(a);o.a},"82e7":function(t,e,s){}}]);