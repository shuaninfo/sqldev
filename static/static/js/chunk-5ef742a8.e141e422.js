(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ef742a8"],{"0426":function(t,e,s){"use strict";var i=s("044e"),r=s.n(i);r.a},"044e":function(t,e,s){},"27a6":function(t,e,s){"use strict";var i=s("e26a"),r=s.n(i);r.a},"3e7a":function(t,e,s){},e26a:function(t,e,s){},f113:function(t,e,s){"use strict";var i=s("3e7a"),r=s.n(i);r.a},ff38:function(t,e,s){"use strict";s.r(e);var i,r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-tabs",{staticClass:"sysTabs",attrs:{"tab-position":"left"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"功能配置",name:"first"}},[s("el-row",{attrs:{gutter:8}},[s("el-col",{attrs:{span:24}},[s("div",{staticClass:"sys-setting"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("功能配置")])]),s("el-form",{ref:"form",staticClass:"el-row",attrs:{model:t.form,"label-width":"160px",size:"mini"}},[s("el-form-item",{staticClass:"el-col-12",attrs:{label:"开启页面水印"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.form.water_mark,callback:function(e){t.$set(t.form,"water_mark",e)},expression:"form.water_mark"}})],1),s("el-form-item",{staticClass:"el-col-12",attrs:{label:"使用异步查询功能"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.form.asyn_query,callback:function(e){t.$set(t.form,"asyn_query",e)},expression:"form.asyn_query"}})],1),s("el-form-item",{staticClass:"el-col-12",attrs:{label:"使用导出Sql功能"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.form.asyn_sql,callback:function(e){t.$set(t.form,"asyn_sql",e)},expression:"form.asyn_sql"}})],1),s("el-form-item",{staticClass:"el-col-12",attrs:{label:"使用异步导出功能"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.form.asyn_export,callback:function(e){t.$set(t.form,"asyn_export",e)},expression:"form.asyn_export"}})],1),s("el-form-item",{staticClass:"el-col-12",attrs:{label:"使用加密方式传输Sql"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.form.encrypt_sql,callback:function(e){t.$set(t.form,"encrypt_sql",e)},expression:"form.encrypt_sql"}})],1),s("el-form-item",{staticClass:"el-col-12",attrs:{label:"上报解析失败SQL"}},[s("el-tooltip",{attrs:{placement:"top",content:"开启后，解析失败的SQL会发给厂商定位错误"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.form.report_sql,callback:function(e){t.$set(t.form,"report_sql",e)},expression:"form.report_sql"}})],1)],1),s("el-form-item",{staticClass:"el-col-24"},[s("el-button",{staticClass:"el-button--default",attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存 ")])],1)],1)],1)],1)])],1)],1),s("el-tab-pane",{attrs:{label:"通知设置",name:"second"}},[s("setting-notify",{attrs:{form:t.form}})],1),s("el-tab-pane",{attrs:{label:"告警设置",name:"third"}},[s("setting-warning",{attrs:{form:t.form}})],1),s("el-tab-pane",{attrs:{label:"系统控制",name:"fourth"}},[s("el-row",{attrs:{gutter:8}},[s("el-col",{attrs:{span:24}},[s("div",{staticClass:"sys-setting"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("系统控制")])]),s("el-form",{ref:"form",attrs:{model:t.form,"label-width":"160px",size:"mini"}},[s("el-form-item",{attrs:{label:"启动时间"}},[s("span",[t._v(t._s(t.showTime(1e3*t.form.start_time)))])]),s("el-form-item",[s("k-btn-tip",{attrs:{tip:"确定要重启系统吗？"},on:{click:t.onReboot}},[s("el-button",{attrs:{type:"danger",icon:"el-icon-refresh-right"}},[t._v("重新启动")])],1)],1)],1)],1)],1)])],1)],1)],1)},a=[],o=(s("b0c0"),s("ade3")),l=(s("5743"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-row",{attrs:{gutter:8}},[s("el-col",{attrs:{span:24}},[s("div",{staticClass:"sys-setting"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("通知设置")])]),s("div",{staticClass:"text item"},[s("el-form",{ref:"mailForm",staticStyle:{width:"600px"},attrs:{model:t.mailForm,"label-width":"160px",size:"small",rules:t.mailRules}},[s("el-form-item",{attrs:{label:"SMTP服务器地址",prop:"host"}},[s("el-input",{attrs:{size:"mini"},model:{value:t.mailForm.host,callback:function(e){t.$set(t.mailForm,"host",e)},expression:"mailForm.host"}})],1),s("el-form-item",{attrs:{label:"端口",prop:"port"}},[s("el-input",{attrs:{size:"mini"},model:{value:t.mailForm.port,callback:function(e){t.$set(t.mailForm,"port",e)},expression:"mailForm.port"}})],1),s("el-form-item",{attrs:{label:"用户名",prop:"user"}},[s("el-input",{attrs:{size:"mini"},model:{value:t.mailForm.user,callback:function(e){t.$set(t.mailForm,"user",e)},expression:"mailForm.user"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{size:"mini"},model:{value:t.mailForm.password,callback:function(e){t.$set(t.mailForm,"password",e)},expression:"mailForm.password"}})],1),s("el-form-item",{attrs:{label:"启用SSL加密",prop:"ssl"}},[s("el-checkbox",{attrs:{size:"mini"},model:{value:t.mailForm.ssl,callback:function(e){t.$set(t.mailForm,"ssl",e)},expression:"mailForm.ssl"}})],1),s("el-form-item",{attrs:{label:"发件人地址",prop:"from"}},[s("el-input",{attrs:{size:"mini"},model:{value:t.mailForm.from,callback:function(e){t.$set(t.mailForm,"from",e)},expression:"mailForm.from"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmitEmail}},[t._v("保存")])],1)],1)],1)]),s("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"10px"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("发信测试")])]),s("div",{staticClass:"text item"},[s("el-form",{ref:"testForm",attrs:{inline:!0,model:t.mailForm,"label-width":"160px",size:"mini"}},[s("el-form-item",{attrs:{label:"收件人地址",prop:"test"}},[s("el-input",{attrs:{size:"small"},model:{value:t.mailForm.test,callback:function(e){t.$set(t.mailForm,"test",e)},expression:"mailForm.test"}})],1),s("el-form-item",[s("el-button",{on:{click:t.onTestEmail}},[t._v("发送测试邮件")])],1)],1)],1)])],1)])],1)}),n=[],m=(s("2ef0"),{data:function(){return{filterText:"",mailForm:{},smsForm:{},mailRules:{host:[{required:!0,message:"SMTP服务器地址不能为空!",trigger:"blur"}],port:[{required:!0,message:"端口不能为空!",trigger:"blur"},{validator:function(t,e,s){var i=/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;i.test(e)?s():s(new Error("请输入正确的端口号"))},trigger:"blur"}],user:[{required:!0,message:"用户名不能为空!",trigger:"blur"}],password:[{required:!0,message:"密码不能为空!",trigger:"blur"}],from:[{validator:function(t,e,s){var i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;i.test(e)?s():s(new Error("请输入正确的邮箱地址"))},trigger:"blur"}]},testRules:{test:[{validator:function(t,e,s){var i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;i.test(e)?s():s(new Error("请输入正确的收件人邮箱地址"))},trigger:"blur"}]}}},computed:{},props:{form:{}},watch:{form:"initFrom"},methods:{onSubmitEmail:function(){var t=this;this.$refs.mailForm.validate((function(e){if(console.log("........"),!e)return!1;t.$api.setting.updateEmailSetting(t.mailForm).then((function(){t.onSuccess("保存成功"),t.$emit("refresh")}))}))},onTestEmail:function(){var t=this;this.$refs.mailForm.validate((function(e){if(console.log("........"),!e)return!1;t.$refs.testForm.validate((function(e){if(!e)return!1;t.$api.setting.testEmailSetting(t.mailForm).then((function(){t.onSuccess("发送成功")}))}))}))},onSubmitSms:function(){},resetMailForm:function(){this.mailForm={host:"",port:"",user:"",password:"",from:"",test:"",ssl:!1}},resetSmsForm:function(){this.smsForm={sms_host:"",sms_port:"",sms_user:"",sms_password:"",sms_method:"",sms_test:""}},initFrom:function(t){t.mail_conf?this.mailForm=t.mail_conf:this.resetMailForm(),t.sms_conf?this.smsForm=t.sms_conf:this.resetSmsForm()}},components:{},mounted:function(){}}),c=m,f=(s("27a6"),s("2877")),u=Object(f["a"])(c,l,n,!1,null,null,null),d=u.exports,p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-row",{attrs:{gutter:8}},[s("el-col",{attrs:{span:24}},[s("div",{staticClass:"sys-setting"},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("告警设置")])]),s("el-form",{ref:"form",attrs:{model:t.form,"label-width":"180px",size:"mini"}},[s("el-form-item",{attrs:{label:"脚本执行错误告警"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.waringForm.sql_exec,callback:function(e){t.$set(t.waringForm,"sql_exec",e)},expression:"waringForm.sql_exec"}})],1),s("el-form-item",{attrs:{label:"脚本执行权限告警"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.waringForm.sql_validate,callback:function(e){t.$set(t.waringForm,"sql_validate",e)},expression:"waringForm.sql_validate"}})],1),s("el-form-item",{attrs:{label:"调用未授权功能告警"}},[s("el-switch",{attrs:{size:"mini"},model:{value:t.waringForm.fun_validate,callback:function(e){t.$set(t.waringForm,"fun_validate",e)},expression:"waringForm.fun_validate"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)],1)])],1)},h=[],b={data:function(){return{filterText:"",waringForm:{}}},computed:{},props:{form:{}},watch:{form:"initFrom"},methods:{onSubmit:function(){var t=this;this.$api.setting.updateWaringSetting(this.waringForm).then((function(){t.onSuccess("保存成功"),t.$emit("refresh")}))},reset:function(){this.waringForm={sql_exec:!0,sql_validate:!0,fun_validate:!0}},initFrom:function(t){t.warning_conf?this.waringForm=t.warning_conf:this.reset()}},components:{},mounted:function(){}},g=b,v=(s("f113"),Object(f["a"])(g,p,h,!1,null,null,null)),_=v.exports,w=s("c1df"),F=s.n(w),x={data:function(){return{setting:{},inter:null,run_str:"",size:"small",activeName:"first",form:{sql_mode:!0,license:""},form2:{}}},methods:(i={checkLicense:function(){},showTime:function(t){return console.log("expire:",t),F()(new Date(t)).format("YYYY-MM-DD HH:mm:ss")},diffTime:function(){var t="NaN";if(this.form.start_time){var e=F()().diff(F()(1e3*this.form.start_time));console.log("ms:",e);var s=F.a.duration(e),i=Math.floor(s.asHours()),r=F.a.utc(e).format("mm"),a=F.a.utc(e).format("ss");t="",s>0&&(t=s+"天"),i>0&&(t+=i+"小时"),t+=r+"分钟",t+=a+"秒",console.log("d:",s,"  h:",i," m:",r," s:",a)}this.run_str=t}},Object(o["a"])(i,"checkLicense",(function(){var t=this;this.$api.setting.updateLicense(this.form).then((function(){t.onSuccess("更新成功"),t.getSetting()}),(function(e){var s="参数错误！";"301"!=e.result&&(s=e.data),t.onError(s)}))})),Object(o["a"])(i,"handleClick",(function(t,e){console.log("handleClick:",t,e),this.getSetting(t.name)})),Object(o["a"])(i,"onReboot",(function(){var t=this;this.$api.setting.reboot().then((function(){t.onSuccess("请求成功，正在重启中")}),(function(e){t.onError("操作势必啊")}))})),Object(o["a"])(i,"onSubmit",(function(){var t=this;this.$api.setting.updateSetting(this.form).then((function(){t.onSuccess("提交成功")}),(function(e){var s="参数错误！";"301"!=e.result&&(s=e.data),t.onError(s)}))})),Object(o["a"])(i,"getSetting",(function(t){var e=this;"inception"==t?this.$api.setting.getInception().then((function(t){console.log("data:",JSON.stringify(t)),e.form2=t})):this.$api.setting.get().then((function(t){console.log("data:",JSON.stringify(t)),e.setting=t,e.form=t}))})),Object(o["a"])(i,"round",(function(t){return Math.round(100*t)/100})),Object(o["a"])(i,"init",(function(){})),i),components:{SettingNotify:d,SettingWarning:_},mounted:function(){var t=this;this.$nextTick((function(){t.getSetting(),t.init()}))},destroyed:function(){clearTimeout(this.inter)}},S=x,k=(s("0426"),Object(f["a"])(S,r,a,!1,null,null,null));e["default"]=k.exports}}]);