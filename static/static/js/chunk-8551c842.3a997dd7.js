(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8551c842"],{"0055":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=s(n("8448")),i=s(n("4416"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var c="top-level",u="block-level",d=function(){function e(t){r(this,e),this.indent=t||"  ",this.indentTypes=[]}return l(e,[{key:"getIndent",value:function(){return(0,a["default"])(this.indent,this.indentTypes.length)}},{key:"increaseTopLevel",value:function(){this.indentTypes.push(c)}},{key:"increaseBlockLevel",value:function(){this.indentTypes.push(u)}},{key:"decreaseTopLevel",value:function(){(0,i["default"])(this.indentTypes)===c&&this.indentTypes.pop()}},{key:"decreaseBlockLevel",value:function(){while(this.indentTypes.length>0){var e=this.indentTypes.pop();if(e!==c)break}}},{key:"resetIndentation",value:function(){this.indentTypes=[]}}]),e}();t["default"]=d,e.exports=t.default},"00fd":function(e,t,n){var a=n("9e69"),i=Object.prototype,s=i.hasOwnProperty,r=i.toString,o=a?a.toStringTag:void 0;function l(e){var t=s.call(e,o),n=e[o];try{e[o]=void 0;var a=!0}catch(l){}var i=r.call(e);return a&&(t?e[o]=n:delete e[o]),i}e.exports=l},"0142":function(e,t,n){"use strict";var a=n("5d2a"),i=n.n(a);i.a},"02d8":function(e,t,n){"use strict";var a=n("93a9"),i=n.n(a);i.a},"03dd":function(e,t,n){var a=n("eac5"),i=n("57a5"),s=Object.prototype,r=s.hasOwnProperty;function o(e){if(!a(e))return i(e);var t=[];for(var n in Object(e))r.call(e,n)&&"constructor"!=n&&t.push(n);return t}e.exports=o},"064e":function(e,t,n){"use strict";var a=n("a4ac"),i=n.n(a);i.a},"0684":function(e,t,n){},"07c7":function(e,t){function n(){return!1}e.exports=n},"099a":function(e,t){function n(e,t,n){var a=n-1,i=e.length;while(++a<i)if(e[a]===t)return a;return-1}e.exports=n},"0b07":function(e,t,n){var a=n("34ac"),i=n("3698");function s(e,t){var n=i(e,t);return a(n)?n:void 0}e.exports=s},"0d24":function(e,t,n){(function(e){var a=n("2b3e"),i=n("07c7"),s=t&&!t.nodeType&&t,r=s&&"object"==typeof e&&e&&!e.nodeType&&e,o=r&&r.exports===s,l=o?a.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||i;e.exports=u}).call(this,n("62e4")(e))},"0d3b":function(e,t,n){var a=n("d039"),i=n("b622"),s=n("c430"),r=i("iterator");e.exports=!a((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,a){t["delete"]("b"),n+=a+e})),s&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[r]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},"0f1c":function(e,t,n){(function(t,n){e.exports=n()})(0,(function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){var a=n(2)(n(1),n(3),null,null,null);a.options.__file="E:\\shu_an\\vue-context-menu\\src\\VueContextMenu.vue",a.esModule&&Object.keys(a.esModule).some((function(e){return"default"!==e&&"__"!==e.substr(0,2)}))&&console.error("named exports are not supported in *.vue files."),a.options.functional&&console.error("[vue-loader] VueContextMenu.vue: functional components are not supported with templates, they should use render functions."),e.exports=a.exports},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={name:"context-menu",data:function(){return{triggerShowFn:function(){},triggerHideFn:function(){},coordinate:{x:null,y:null},size:{},binded:!1}},props:{target:null,show:Boolean},computed:{style:function(){var e=document.body,t=e.clientWidth,n=e.clientHeight,a=this.coordinate,i=a.x,s=a.y,r=this.size,o=r.width,l=r.height,c=i+o>t&&t>=2*o?i-o:i,u=s+l>n&&n>=2*l?s-l:s;return{visibility:this.show?"visible":"hidden",left:c+"px",top:u+"px"}}},mounted:function(){this.bindEvents(),this.size={width:this.$refs.selfContextMenu.offsetWidth,height:this.$refs.selfContextMenu.offsetHeight}},watch:{show:function(e){e?this.bindHideEvents():this.unbindHideEvents()},target:function(e){this.bindEvents()}},methods:{bindEvents:function(){var e=this;this.$nextTick((function(){e.target&&!e.binded&&(e.triggerShowFn=e.contextMenuHandler.bind(e),e.target.addEventListener("contextmenu",e.triggerShowFn),e.binded=!0)}))},unbindEvents:function(){this.target&&this.target.removeEventListener("contextmenu",this.triggerShowFn)},bindHideEvents:function(){this.triggerHideFn=this.clickDocumentHandler.bind(this),document.addEventListener("mousedown",this.triggerHideFn),document.addEventListener("mousewheel",this.triggerHideFn)},unbindHideEvents:function(){document.removeEventListener("mousedown",this.triggerHideFn),document.removeEventListener("mousewheel",this.triggerHideFn)},clickDocumentHandler:function(e){this.$emit("update:show",!1)},contextMenuHandler:function(e){this.coordinate={x:e.clientX,y:e.clientY},this.$emit("update:show",!0),this.$emit("action",e),e.preventDefault()}}}},function(e,t){e.exports=function(e,t,n,a,i){var s,r=e=e||{},o=typeof e.default;"object"!==o&&"function"!==o||(s=e,r=e.default);var l,c="function"===typeof r?r.options:r;if(t&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns),a&&(c._scopeId=a),i?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=l):n&&(l=n),l){var u=c.functional,d=u?c.render:c.beforeCreate;u?c.render=function(e,t){return l.call(t),d(e,t)}:c.beforeCreate=d?[].concat(d,l):[l]}return{esModule:s,exports:r,options:c}}},function(e,t,n){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"selfContextMenu",staticStyle:{display:"block"},style:e.style,on:{mousedown:function(e){e.stopPropagation()},contextmenu:function(e){e.preventDefault()}}},[e._t("default")],2)},staticRenderFns:[]},e.exports.render._withStripped=!0},function(e,t,n){
/**
  * vue-context-menu
  * (c) 2017 赵兵
  * @license MIT
  */
const a=n(0),i={install:function(e,t){e.component(a.name,a)}};i.component=a,"undefined"!==typeof window&&window.Vue&&window.Vue.use(i),e.exports=i}])}))},"10cf":function(e,t,n){"use strict";var a=n("e86f"),i=n.n(a);i.a},"1148b":function(e,t,n){},1310:function(e,t){function n(e){return null!=e&&"object"==typeof e}e.exports=n},"1368e":function(e,t,n){var a=n("da03"),i=function(){var e=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function s(e){return!!i&&i in e}e.exports=s},"13d5":function(e,t,n){},"13ea":function(e,t,n){var a=n("03dd"),i=n("42a2"),s=n("d370"),r=n("6747"),o=n("30c9"),l=n("0d24"),c=n("eac5"),u=n("73ac"),d="[object Map]",f="[object Set]",h=Object.prototype,p=h.hasOwnProperty;function m(e){if(null==e)return!0;if(o(e)&&(r(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||s(e)))return!e.length;var t=i(e);if(t==d||t==f)return!e.size;if(c(e))return!a(e).length;for(var n in e)if(p.call(e,n))return!1;return!0}e.exports=m},1881:function(e,t,n){"use strict";var a=n("c57a"),i=n.n(a);i.a},"19ab":function(e,t,n){!function(t,n){e.exports=n()}(0,(function(){return function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=7)}([function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var a={},i=0;i<this.length;i++){var s=this[i][0];"number"==typeof s&&(a[s]=!0)}for(i=0;i<t.length;i++){var r=t[i];"number"==typeof r[0]&&a[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),e.push(r))}},e}},function(e,t){e.exports=function(e,t,n,a){var i,s=e=e||{},r=typeof e.default;"object"!==r&&"function"!==r||(i=e,s=e.default);var o="function"==typeof s?s.options:s;if(t&&(o.render=t.render,o.staticRenderFns=t.staticRenderFns),n&&(o._scopeId=n),a){var l=Object.create(o.computed||null);Object.keys(a).forEach((function(e){var t=a[e];l[e]=function(){return t}})),o.computed=l}return{esModule:i,exports:s,options:o}}},function(e,t,n){function a(e){for(var t=0;t<e.length;t++){var n=e[t],a=u[n.id];if(a){a.refs++;for(var i=0;i<a.parts.length;i++)a.parts[i](n.parts[i]);for(;i<n.parts.length;i++)a.parts.push(s(n.parts[i]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var r=[];for(i=0;i<n.parts.length;i++)r.push(s(n.parts[i]));u[n.id]={id:n.id,refs:1,parts:r}}}}function i(){var e=document.createElement("style");return e.type="text/css",d.appendChild(e),e}function s(e){var t,n,a=document.querySelector('style[data-vue-ssr-id~="'+e.id+'"]');if(a){if(p)return m;a.parentNode.removeChild(a)}if(v){var s=h++;a=f||(f=i()),t=r.bind(null,a,s,!1),n=r.bind(null,a,s,!0)}else a=i(),t=o.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}function r(e,t,n,a){var i=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var s=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function o(e,t){var n=t.css,a=t.media,i=t.sourceMap;if(a&&e.setAttribute("media",a),i&&(n+="\n/*# sourceURL="+i.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c=n(19),u={},d=l&&(document.head||document.getElementsByTagName("head")[0]),f=null,h=0,p=!1,m=function(){},v="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(e,t,n){p=n;var i=c(e,t);return a(i),function(t){for(var n=[],s=0;s<i.length;s++){var r=i[s],o=u[r.id];o.refs--,n.push(o)}t?(i=c(e,t),a(i)):i=[];for(s=0;s<n.length;s++){o=n[s];if(0===o.refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete u[o.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){n(17);var a=n(1)(n(4),n(14),"data-v-566a42b8",null);e.exports=a.exports},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),s=a(i),r=n(11),o=a(r);t.default={name:"splitPane",components:{Resizer:s.default,Pane:o.default},props:{minPercent:{type:Number,default:10},defaultPercent:{type:Number,default:50},split:{validator:function(e){return["vertical","horizontal"].indexOf(e)>=0},required:!0},className:String},computed:{userSelect:function(){return this.active?"none":""},cursor:function(){return this.active?"vertical"===this.split?"col-resize":"row-resize":""}},watch:{defaultPercent:function(e,t){this.percent=e}},data:function(){return{active:!1,hasMoved:!1,height:null,percent:this.defaultPercent,type:"vertical"===this.split?"width":"height",resizeType:"vertical"===this.split?"left":"top"}},methods:{onClick:function(){this.hasMoved||(this.percent=50,this.$emit("resize",this.percent))},onMouseDown:function(){this.active=!0,this.hasMoved=!1},onMouseUp:function(){this.active=!1},onMouseMove:function(e){if(0!==e.buttons&&0!==e.which||(this.active=!1),this.active){var t=0,n=e.currentTarget;if("vertical"===this.split)for(;n;)t+=n.offsetLeft,n=n.offsetParent;else for(;n;)t+=n.offsetTop,n=n.offsetParent;var a="vertical"===this.split?e.pageX:e.pageY,i="vertical"===this.split?e.currentTarget.offsetWidth:e.currentTarget.offsetHeight,s=Math.floor((a-t)/i*1e4)/100;s>this.minPercent&&s<100-this.minPercent&&(this.percent=s),this.$emit("resize",this.percent),this.hasMoved=!0}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"Pane",props:{className:String},data:function(){return{classes:[this.$parent.split,this.className].join(" "),percent:50}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{split:{validator:function(e){return["vertical","horizontal"].indexOf(e)>=0},required:!0},className:String},computed:{classes:function(){return["splitter-pane-resizer",this.split,this.className].join(" ")}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=i.default,"undefined"!=typeof window&&window.Vue&&window.Vue.component("split-pane",i.default)},function(e,t,n){t=e.exports=n(0)(),t.push([e.i,".splitter-pane-resizer[data-v-212fa2a4]{box-sizing:border-box;background:#000;position:absolute;opacity:.2;z-index:1;background-clip:padding-box}.splitter-pane-resizer.horizontal[data-v-212fa2a4]{height:11px;margin:-5px 0;border-top:5px solid hsla(0,0%,100%,0);border-bottom:5px solid hsla(0,0%,100%,0);cursor:row-resize;width:100%}.splitter-pane-resizer.vertical[data-v-212fa2a4]{width:11px;height:100%;margin-left:-5px;border-left:5px solid hsla(0,0%,100%,0);border-right:5px solid hsla(0,0%,100%,0);cursor:col-resize}",""])},function(e,t,n){t=e.exports=n(0)(),t.push([e.i,'.clearfix[data-v-566a42b8]:after{visibility:hidden;display:block;font-size:0;content:" ";clear:both;height:0}.vue-splitter-container[data-v-566a42b8]{height:100%;position:relative}.vue-splitter-container-mask[data-v-566a42b8]{z-index:9999;width:100%;height:100%;position:absolute;top:0;left:0}',""])},function(e,t,n){t=e.exports=n(0)(),t.push([e.i,".splitter-pane.vertical.splitter-paneL[data-v-815c801c]{position:absolute;left:0;height:100%;padding-right:3px}.splitter-pane.vertical.splitter-paneR[data-v-815c801c]{position:absolute;right:0;height:100%;padding-left:3px}.splitter-pane.horizontal.splitter-paneL[data-v-815c801c]{position:absolute;top:0;width:100%}.splitter-pane.horizontal.splitter-paneR[data-v-815c801c]{position:absolute;bottom:0;width:100%;padding-top:3px}",""])},function(e,t,n){n(18);var a=n(1)(n(5),n(15),"data-v-815c801c",null);e.exports=a.exports},function(e,t,n){n(16);var a=n(1)(n(6),n(13),"data-v-212fa2a4",null);e.exports=a.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classes})},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e,t,n,a=this,i=a.$createElement,s=a._self._c||i;return s("div",{staticClass:"vue-splitter-container clearfix",style:{cursor:a.cursor,userSelect:a.userSelect},on:{mouseup:a.onMouseUp,mousemove:a.onMouseMove}},[s("pane",{staticClass:"splitter-pane splitter-paneL",style:(e={},e[a.type]=a.percent+"%",e),attrs:{split:a.split}},[a._t("paneL")],2),a._v(" "),s("resizer",{style:(t={},t[a.resizeType]=a.percent+"%",t),attrs:{className:a.className,split:a.split},nativeOn:{mousedown:function(e){return a.onMouseDown(e)},click:function(e){return a.onClick(e)}}}),a._v(" "),s("pane",{staticClass:"splitter-pane splitter-paneR",style:(n={},n[a.type]=100-a.percent+"%",n),attrs:{split:a.split}},[a._t("paneR")],2),a._v(" "),a.active?s("div",{staticClass:"vue-splitter-container-mask"}):a._e()],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classes},[e._t("default")],2)},staticRenderFns:[]}},function(e,t,n){var a=n(8);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),n(2)("a82a4610",a,!0)},function(e,t,n){var a=n(9);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),n(2)("033d59ad",a,!0)},function(e,t,n){var a=n(10);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals),n(2)("6816c93c",a,!0)},function(e,t){e.exports=function(e,t){for(var n=[],a={},i=0;i<t.length;i++){var s=t[i],r=s[0],o=s[1],l=s[2],c=s[3],u={id:e+":"+i,css:o,media:l,sourceMap:c};a[r]?a[r].parts.push(u):n.push(a[r]={id:r,parts:[u]})}return n}}])}))},"1a8c":function(e,t){function n(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e.exports=n},"1be5":function(e,t,n){},"1cec":function(e,t,n){var a=n("0b07"),i=n("2b3e"),s=a(i,"Promise");e.exports=s},"1fb2":function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var r=function(){function e(t){a(this,e),this.params=t,this.index=0}return s(e,[{key:"get",value:function(e){var t=e.key,n=e.value;return this.params?t?this.params[t]:this.params[this.index++]:n}}]),e}();t["default"]=r,e.exports=t.default},"208e":function(e,t,n){"use strict";var a=n("13d5"),i=n.n(a);i.a},"23d2":function(e,t,n){},"253c":function(e,t,n){var a=n("3729"),i=n("1310"),s="[object Arguments]";function r(e){return i(e)&&a(e)==s}e.exports=r},2560:function(e,t,n){},"266a":function(e,t,n){var a=n("7948");function i(e,t){return a(t,(function(t){return e[t]}))}e.exports=i},"26bc":function(e,t,n){},"29f3":function(e,t){var n=Object.prototype,a=n.toString;function i(e){return a.call(e)}e.exports=i},"2b03":function(e,t){function n(e,t,n,a){var i=e.length,s=n+(a?1:-1);while(a?s--:++s<i)if(t(e[s],s,e))return s;return-1}e.exports=n},"2b3d":function(e,t,n){"use strict";n("3ca3");var a,i=n("23e7"),s=n("83ab"),r=n("0d3b"),o=n("da84"),l=n("37e8"),c=n("6eeb"),u=n("19aa"),d=n("5135"),f=n("60da"),h=n("4df4"),p=n("6547").codeAt,m=n("5fb2"),v=n("d44e"),b=n("9861"),E=n("69f3"),g=o.URL,y=b.URLSearchParams,_=b.getState,T=E.set,R=E.getterFor("URL"),S=Math.floor,I=Math.pow,L="Invalid authority",w="Invalid scheme",O="Invalid host",x="Invalid port",D=/[A-Za-z]/,A=/[\d+-.A-Za-z]/,N=/\d/,C=/^(0x|0X)/,k=/^[0-7]+$/,U=/^\d+$/,P=/^[\dA-Fa-f]+$/,M=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,j=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,$=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,F=/[\u0009\u000A\u000D]/g,B=function(e,t){var n,a,i;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return O;if(n=H(t.slice(1,-1)),!n)return O;e.host=n}else if(J(e)){if(t=m(t),M.test(t))return O;if(n=q(t),null===n)return O;e.host=n}else{if(j.test(t))return O;for(n="",a=h(t),i=0;i<a.length;i++)n+=Q(a[i],G);e.host=n}},q=function(e){var t,n,a,i,s,r,o,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),t=l.length,t>4)return e;for(n=[],a=0;a<t;a++){if(i=l[a],""==i)return e;if(s=10,i.length>1&&"0"==i.charAt(0)&&(s=C.test(i)?16:8,i=i.slice(8==s?1:2)),""===i)r=0;else{if(!(10==s?U:8==s?k:P).test(i))return e;r=parseInt(i,s)}n.push(r)}for(a=0;a<t;a++)if(r=n[a],a==t-1){if(r>=I(256,5-t))return null}else if(r>255)return null;for(o=n.pop(),a=0;a<n.length;a++)o+=n[a]*I(256,3-a);return o},H=function(e){var t,n,a,i,s,r,o,l=[0,0,0,0,0,0,0,0],c=0,u=null,d=0,f=function(){return e.charAt(d)};if(":"==f()){if(":"!=e.charAt(1))return;d+=2,c++,u=c}while(f()){if(8==c)return;if(":"!=f()){t=n=0;while(n<4&&P.test(f()))t=16*t+parseInt(f(),16),d++,n++;if("."==f()){if(0==n)return;if(d-=n,c>6)return;a=0;while(f()){if(i=null,a>0){if(!("."==f()&&a<4))return;d++}if(!N.test(f()))return;while(N.test(f())){if(s=parseInt(f(),10),null===i)i=s;else{if(0==i)return;i=10*i+s}if(i>255)return;d++}l[c]=256*l[c]+i,a++,2!=a&&4!=a||c++}if(4!=a)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;l[c++]=t}else{if(null!==u)return;d++,c++,u=c}}if(null!==u){r=c-u,c=7;while(0!=c&&r>0)o=l[c],l[c--]=l[u+r-1],l[u+--r]=o}else if(8!=c)return;return l},V=function(e){for(var t=null,n=1,a=null,i=0,s=0;s<8;s++)0!==e[s]?(i>n&&(t=a,n=i),a=null,i=0):(null===a&&(a=s),++i);return i>n&&(t=a,n=i),t},W=function(e){var t,n,a,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=S(e/256);return t.join(".")}if("object"==typeof e){for(t="",a=V(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),a===n?(t+=n?":":"::",i=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}return e},G={},X=f({},G,{" ":1,'"':1,"<":1,">":1,"`":1}),Y=f({},X,{"#":1,"?":1,"{":1,"}":1}),z=f({},Y,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Q=function(e,t){var n=p(e,0);return n>32&&n<127&&!d(t,e)?e:encodeURIComponent(e)},K={ftp:21,file:null,http:80,https:443,ws:80,wss:443},J=function(e){return d(K,e.scheme)},Z=function(e){return""!=e.username||""!=e.password},ee=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},te=function(e,t){var n;return 2==e.length&&D.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)},ne=function(e){var t;return e.length>1&&te(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},ae=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&te(t[0],!0)||t.pop()},ie=function(e){return"."===e||"%2e"===e.toLowerCase()},se=function(e){return e=e.toLowerCase(),".."===e||"%2e."===e||".%2e"===e||"%2e%2e"===e},re={},oe={},le={},ce={},ue={},de={},fe={},he={},pe={},me={},ve={},be={},Ee={},ge={},ye={},_e={},Te={},Re={},Se={},Ie={},Le={},we=function(e,t,n,i){var s,r,o,l,c=n||re,u=0,f="",p=!1,m=!1,v=!1;n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace($,"")),t=t.replace(F,""),s=h(t);while(u<=s.length){switch(r=s[u],c){case re:if(!r||!D.test(r)){if(n)return w;c=le;continue}f+=r.toLowerCase(),c=oe;break;case oe:if(r&&(A.test(r)||"+"==r||"-"==r||"."==r))f+=r.toLowerCase();else{if(":"!=r){if(n)return w;f="",c=le,u=0;continue}if(n&&(J(e)!=d(K,f)||"file"==f&&(Z(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=f,n)return void(J(e)&&K[e.scheme]==e.port&&(e.port=null));f="","file"==e.scheme?c=ge:J(e)&&i&&i.scheme==e.scheme?c=ce:J(e)?c=he:"/"==s[u+1]?(c=ue,u++):(e.cannotBeABaseURL=!0,e.path.push(""),c=Se)}break;case le:if(!i||i.cannotBeABaseURL&&"#"!=r)return w;if(i.cannotBeABaseURL&&"#"==r){e.scheme=i.scheme,e.path=i.path.slice(),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,c=Le;break}c="file"==i.scheme?ge:de;continue;case ce:if("/"!=r||"/"!=s[u+1]){c=de;continue}c=pe,u++;break;case ue:if("/"==r){c=me;break}c=Re;continue;case de:if(e.scheme=i.scheme,r==a)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query;else if("/"==r||"\\"==r&&J(e))c=fe;else if("?"==r)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query="",c=Ie;else{if("#"!=r){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.path.pop(),c=Re;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Le}break;case fe:if(!J(e)||"/"!=r&&"\\"!=r){if("/"!=r){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,c=Re;continue}c=me}else c=pe;break;case he:if(c=pe,"/"!=r||"/"!=f.charAt(u+1))continue;u++;break;case pe:if("/"!=r&&"\\"!=r){c=me;continue}break;case me:if("@"==r){p&&(f="%40"+f),p=!0,o=h(f);for(var b=0;b<o.length;b++){var E=o[b];if(":"!=E||v){var g=Q(E,z);v?e.password+=g:e.username+=g}else v=!0}f=""}else if(r==a||"/"==r||"?"==r||"#"==r||"\\"==r&&J(e)){if(p&&""==f)return L;u-=h(f).length+1,f="",c=ve}else f+=r;break;case ve:case be:if(n&&"file"==e.scheme){c=_e;continue}if(":"!=r||m){if(r==a||"/"==r||"?"==r||"#"==r||"\\"==r&&J(e)){if(J(e)&&""==f)return O;if(n&&""==f&&(Z(e)||null!==e.port))return;if(l=B(e,f),l)return l;if(f="",c=Te,n)return;continue}"["==r?m=!0:"]"==r&&(m=!1),f+=r}else{if(""==f)return O;if(l=B(e,f),l)return l;if(f="",c=Ee,n==be)return}break;case Ee:if(!N.test(r)){if(r==a||"/"==r||"?"==r||"#"==r||"\\"==r&&J(e)||n){if(""!=f){var y=parseInt(f,10);if(y>65535)return x;e.port=J(e)&&y===K[e.scheme]?null:y,f=""}if(n)return;c=Te;continue}return x}f+=r;break;case ge:if(e.scheme="file","/"==r||"\\"==r)c=ye;else{if(!i||"file"!=i.scheme){c=Re;continue}if(r==a)e.host=i.host,e.path=i.path.slice(),e.query=i.query;else if("?"==r)e.host=i.host,e.path=i.path.slice(),e.query="",c=Ie;else{if("#"!=r){ne(s.slice(u).join(""))||(e.host=i.host,e.path=i.path.slice(),ae(e)),c=Re;continue}e.host=i.host,e.path=i.path.slice(),e.query=i.query,e.fragment="",c=Le}}break;case ye:if("/"==r||"\\"==r){c=_e;break}i&&"file"==i.scheme&&!ne(s.slice(u).join(""))&&(te(i.path[0],!0)?e.path.push(i.path[0]):e.host=i.host),c=Re;continue;case _e:if(r==a||"/"==r||"\\"==r||"?"==r||"#"==r){if(!n&&te(f))c=Re;else if(""==f){if(e.host="",n)return;c=Te}else{if(l=B(e,f),l)return l;if("localhost"==e.host&&(e.host=""),n)return;f="",c=Te}continue}f+=r;break;case Te:if(J(e)){if(c=Re,"/"!=r&&"\\"!=r)continue}else if(n||"?"!=r)if(n||"#"!=r){if(r!=a&&(c=Re,"/"!=r))continue}else e.fragment="",c=Le;else e.query="",c=Ie;break;case Re:if(r==a||"/"==r||"\\"==r&&J(e)||!n&&("?"==r||"#"==r)){if(se(f)?(ae(e),"/"==r||"\\"==r&&J(e)||e.path.push("")):ie(f)?"/"==r||"\\"==r&&J(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&te(f)&&(e.host&&(e.host=""),f=f.charAt(0)+":"),e.path.push(f)),f="","file"==e.scheme&&(r==a||"?"==r||"#"==r))while(e.path.length>1&&""===e.path[0])e.path.shift();"?"==r?(e.query="",c=Ie):"#"==r&&(e.fragment="",c=Le)}else f+=Q(r,Y);break;case Se:"?"==r?(e.query="",c=Ie):"#"==r?(e.fragment="",c=Le):r!=a&&(e.path[0]+=Q(r,G));break;case Ie:n||"#"!=r?r!=a&&("'"==r&&J(e)?e.query+="%27":e.query+="#"==r?"%23":Q(r,G)):(e.fragment="",c=Le);break;case Le:r!=a&&(e.fragment+=Q(r,X));break}u++}},Oe=function(e){var t,n,a=u(this,Oe,"URL"),i=arguments.length>1?arguments[1]:void 0,r=String(e),o=T(a,{type:"URL"});if(void 0!==i)if(i instanceof Oe)t=R(i);else if(n=we(t={},String(i)),n)throw TypeError(n);if(n=we(o,r,null,t),n)throw TypeError(n);var l=o.searchParams=new y,c=_(l);c.updateSearchParams(o.query),c.updateURL=function(){o.query=String(l)||null},s||(a.href=De.call(a),a.origin=Ae.call(a),a.protocol=Ne.call(a),a.username=Ce.call(a),a.password=ke.call(a),a.host=Ue.call(a),a.hostname=Pe.call(a),a.port=Me.call(a),a.pathname=je.call(a),a.search=$e.call(a),a.searchParams=Fe.call(a),a.hash=Be.call(a))},xe=Oe.prototype,De=function(){var e=R(this),t=e.scheme,n=e.username,a=e.password,i=e.host,s=e.port,r=e.path,o=e.query,l=e.fragment,c=t+":";return null!==i?(c+="//",Z(e)&&(c+=n+(a?":"+a:"")+"@"),c+=W(i),null!==s&&(c+=":"+s)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?r[0]:r.length?"/"+r.join("/"):"",null!==o&&(c+="?"+o),null!==l&&(c+="#"+l),c},Ae=function(){var e=R(this),t=e.scheme,n=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(a){return"null"}return"file"!=t&&J(e)?t+"://"+W(e.host)+(null!==n?":"+n:""):"null"},Ne=function(){return R(this).scheme+":"},Ce=function(){return R(this).username},ke=function(){return R(this).password},Ue=function(){var e=R(this),t=e.host,n=e.port;return null===t?"":null===n?W(t):W(t)+":"+n},Pe=function(){var e=R(this).host;return null===e?"":W(e)},Me=function(){var e=R(this).port;return null===e?"":String(e)},je=function(){var e=R(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},$e=function(){var e=R(this).query;return e?"?"+e:""},Fe=function(){return R(this).searchParams},Be=function(){var e=R(this).fragment;return e?"#"+e:""},qe=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(s&&l(xe,{href:qe(De,(function(e){var t=R(this),n=String(e),a=we(t,n);if(a)throw TypeError(a);_(t.searchParams).updateSearchParams(t.query)})),origin:qe(Ae),protocol:qe(Ne,(function(e){var t=R(this);we(t,String(e)+":",re)})),username:qe(Ce,(function(e){var t=R(this),n=h(String(e));if(!ee(t)){t.username="";for(var a=0;a<n.length;a++)t.username+=Q(n[a],z)}})),password:qe(ke,(function(e){var t=R(this),n=h(String(e));if(!ee(t)){t.password="";for(var a=0;a<n.length;a++)t.password+=Q(n[a],z)}})),host:qe(Ue,(function(e){var t=R(this);t.cannotBeABaseURL||we(t,String(e),ve)})),hostname:qe(Pe,(function(e){var t=R(this);t.cannotBeABaseURL||we(t,String(e),be)})),port:qe(Me,(function(e){var t=R(this);ee(t)||(e=String(e),""==e?t.port=null:we(t,e,Ee))})),pathname:qe(je,(function(e){var t=R(this);t.cannotBeABaseURL||(t.path=[],we(t,e+"",Te))})),search:qe($e,(function(e){var t=R(this);e=String(e),""==e?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",we(t,e,Ie)),_(t.searchParams).updateSearchParams(t.query)})),searchParams:qe(Fe),hash:qe(Be,(function(e){var t=R(this);e=String(e),""!=e?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",we(t,e,Le)):t.fragment=null}))}),c(xe,"toJSON",(function(){return De.call(this)}),{enumerable:!0}),c(xe,"toString",(function(){return De.call(this)}),{enumerable:!0}),g){var He=g.createObjectURL,Ve=g.revokeObjectURL;He&&c(Oe,"createObjectURL",(function(e){return He.apply(g,arguments)})),Ve&&c(Oe,"revokeObjectURL",(function(e){return Ve.apply(g,arguments)}))}v(Oe,"URL"),i({global:!0,forced:!r,sham:!s},{URL:Oe})},"2b3e":function(e,t,n){var a=n("585a"),i="object"==typeof self&&self&&self.Object===Object&&self,s=a||i||Function("return this")();e.exports=s},"2ca0":function(e,t,n){"use strict";var a=n("23e7"),i=n("06cf").f,s=n("50c4"),r=n("5a34"),o=n("1d80"),l=n("ab13"),c=n("c430"),u="".startsWith,d=Math.min,f=l("startsWith"),h=!c&&!f&&!!function(){var e=i(String.prototype,"startsWith");return e&&!e.writable}();a({target:"String",proto:!0,forced:!h&&!f},{startsWith:function(e){var t=String(o(this));r(e);var n=s(d(arguments.length>1?arguments[1]:void 0,t.length)),a=String(e);return u?u.call(t,a,n):t.slice(n,n+a.length)===a}})},"30c9":function(e,t,n){var a=n("9520"),i=n("b218");function s(e){return null!=e&&i(e.length)&&!a(e)}e.exports=s},3129:function(e,t,n){"use strict";var a=n("f121"),i=n.n(a);i.a},"324f":function(e,t,n){"use strict";var a=n("ec24"),i=n.n(a);i.a},"32ec":function(e,t,n){"use strict";var a=n("399fe"),i=n.n(a);i.a},"34ac":function(e,t,n){var a=n("9520"),i=n("1368e"),s=n("1a8c"),r=n("dc57"),o=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,d=c.toString,f=u.hasOwnProperty,h=RegExp("^"+d.call(f).replace(o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p(e){if(!s(e)||i(e))return!1;var t=a(e)?h:l;return t.test(r(e))}e.exports=p},3698:function(e,t){function n(e,t){return null==e?void 0:e[t]}e.exports=n},3729:function(e,t,n){var a=n("9e69"),i=n("00fd"),s=n("29f3"),r="[object Null]",o="[object Undefined]",l=a?a.toStringTag:void 0;function c(e){return null==e?void 0===e?o:r:l&&l in Object(e)?i(e):s(e)}e.exports=c},3835:function(e,t,n){"use strict";function a(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return o}));n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");function i(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,i=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(a=(r=o.next()).done);a=!0)if(n.push(r.value),t&&n.length===t)break}catch(l){i=!0,s=l}finally{try{a||null==o["return"]||o["return"]()}finally{if(i)throw s}}return n}}var s=n("06c5");function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){return a(e)||i(e,t)||Object(s["a"])(e,t)||r()}},3888:function(e,t,n){},"399fe":function(e,t,n){},"39ff":function(e,t,n){var a=n("0b07"),i=n("2b3e"),s=a(i,"WeakMap");e.exports=s},"3beb":function(e,t,n){"use strict";var a=n("827e"),i=n.n(a);i.a},"3ff1":function(e,t,n){var a=n("266a"),i=n("ec69");function s(e){return null==e?[]:a(e,i(e))}e.exports=s},"41c5":function(e,t,n){"use strict";var a=n("7f6c"),i=n.n(a);i.a},"41ec":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=r(n("fd29")),i=r(n("7f51")),s=r(n("f779"));function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var u,d=["A","ACCESSIBLE","AGENT","AGGREGATE","ALL","ALTER","ANY","ARRAY","AS","ASC","AT","ATTRIBUTE","AUTHID","AVG","BETWEEN","BFILE_BASE","BINARY_INTEGER","BINARY","BLOB_BASE","BLOCK","BODY","BOOLEAN","BOTH","BOUND","BREADTH","BULK","BY","BYTE","C","CALL","CALLING","CASCADE","CASE","CHAR_BASE","CHAR","CHARACTER","CHARSET","CHARSETFORM","CHARSETID","CHECK","CLOB_BASE","CLONE","CLOSE","CLUSTER","CLUSTERS","COALESCE","COLAUTH","COLLECT","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPILED","COMPRESS","CONNECT","CONSTANT","CONSTRUCTOR","CONTEXT","CONTINUE","CONVERT","COUNT","CRASH","CREATE","CREDENTIAL","CURRENT","CURRVAL","CURSOR","CUSTOMDATUM","DANGLING","DATA","DATE_BASE","DATE","DAY","DECIMAL","DEFAULT","DEFINE","DELETE","DEPTH","DESC","DETERMINISTIC","DIRECTORY","DISTINCT","DO","DOUBLE","DROP","DURATION","ELEMENT","ELSIF","EMPTY","END","ESCAPE","EXCEPTIONS","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTENDS","EXTERNAL","EXTRACT","FALSE","FETCH","FINAL","FIRST","FIXED","FLOAT","FOR","FORALL","FORCE","FROM","FUNCTION","GENERAL","GOTO","GRANT","GROUP","HASH","HEAP","HIDDEN","HOUR","IDENTIFIED","IF","IMMEDIATE","IN","INCLUDING","INDEX","INDEXES","INDICATOR","INDICES","INFINITE","INSTANTIABLE","INT","INTEGER","INTERFACE","INTERVAL","INTO","INVALIDATE","IS","ISOLATION","JAVA","LANGUAGE","LARGE","LEADING","LENGTH","LEVEL","LIBRARY","LIKE","LIKE2","LIKE4","LIKEC","LIMITED","LOCAL","LOCK","LONG","MAP","MAX","MAXLEN","MEMBER","MERGE","MIN","MINUTE","MLSLABEL","MOD","MODE","MONTH","MULTISET","NAME","NAN","NATIONAL","NATIVE","NATURAL","NATURALN","NCHAR","NEW","NEXTVAL","NOCOMPRESS","NOCOPY","NOT","NOWAIT","NULL","NULLIF","NUMBER_BASE","NUMBER","OBJECT","OCICOLL","OCIDATE","OCIDATETIME","OCIDURATION","OCIINTERVAL","OCILOBLOCATOR","OCINUMBER","OCIRAW","OCIREF","OCIREFCURSOR","OCIROWID","OCISTRING","OCITYPE","OF","OLD","ON","ONLY","OPAQUE","OPEN","OPERATOR","OPTION","ORACLE","ORADATA","ORDER","ORGANIZATION","ORLANY","ORLVARY","OTHERS","OUT","OVERLAPS","OVERRIDING","PACKAGE","PARALLEL_ENABLE","PARAMETER","PARAMETERS","PARENT","PARTITION","PASCAL","PCTFREE","PIPE","PIPELINED","PLS_INTEGER","PLUGGABLE","POSITIVE","POSITIVEN","PRAGMA","PRECISION","PRIOR","PRIVATE","PROCEDURE","PUBLIC","RAISE","RANGE","RAW","READ","REAL","RECORD","REF","REFERENCE","RELEASE","RELIES_ON","REM","REMAINDER","RENAME","RESOURCE","RESULT_CACHE","RESULT","RETURN","RETURNING","REVERSE","REVOKE","ROLLBACK","ROW","ROWID","ROWNUM","ROWTYPE","SAMPLE","SAVE","SAVEPOINT","SB1","SB2","SB4","SEARCH","SECOND","SEGMENT","SELF","SEPARATE","SEQUENCE","SERIALIZABLE","SHARE","SHORT","SIZE_T","SIZE","SMALLINT","SOME","SPACE","SPARSE","SQL","SQLCODE","SQLDATA","SQLERRM","SQLNAME","SQLSTATE","STANDARD","START","STATIC","STDDEV","STORED","STRING","STRUCT","STYLE","SUBMULTISET","SUBPARTITION","SUBSTITUTABLE","SUBTYPE","SUCCESSFUL","SUM","SYNONYM","SYSDATE","TABAUTH","TABLE","TDO","THE","THEN","TIME","TIMESTAMP","TIMEZONE_ABBR","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIMEZONE_REGION","TO","TRAILING","TRANSACTION","TRANSACTIONAL","TRIGGER","TRUE","TRUSTED","TYPE","UB1","UB2","UB4","UID","UNDER","UNIQUE","UNPLUG","UNSIGNED","UNTRUSTED","USE","USER","USING","VALIDATE","VALIST","VALUE","VARCHAR","VARCHAR2","VARIABLE","VARIANCE","VARRAY","VARYING","VIEW","VIEWS","VOID","WHENEVER","WHILE","WITH","WORK","WRAPPED","WRITE","YEAR","ZONE"],f=["ADD","ALTER COLUMN","ALTER TABLE","BEGIN","CONNECT BY","DECLARE","DELETE FROM","DELETE","END","EXCEPT","EXCEPTION","FETCH FIRST","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","LOOP","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","START WITH","UPDATE","VALUES","WHERE"],h=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],p=["AND","CROSS APPLY","CROSS JOIN","ELSE","END","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],m=function(e,t){if(e.type===s["default"].RESERVED_TOP_LEVEL&&"SET"===e.value&&"BY"===t.value)return e.type=s["default"].RESERVED,e},v=function(){function e(t){o(this,e),this.cfg=t}return c(e,[{key:"format",value:function(e){return u||(u=new i["default"]({reservedWords:d,reservedTopLevelWords:f,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:h,stringTypes:['""',"N''","''","``"],openParens:["(","CASE","BEGIN"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["_","$","#",".","@"]})),new a["default"](this.cfg,u,m).format(e)}}]),e}();t["default"]=v,e.exports=t.default},"41f1":function(e,t,n){},"42a2":function(e,t,n){var a=n("b5a7"),i=n("79bc"),s=n("1cec"),r=n("c869"),o=n("39ff"),l=n("3729"),c=n("dc57"),u="[object Map]",d="[object Object]",f="[object Promise]",h="[object Set]",p="[object WeakMap]",m="[object DataView]",v=c(a),b=c(i),E=c(s),g=c(r),y=c(o),_=l;(a&&_(new a(new ArrayBuffer(1)))!=m||i&&_(new i)!=u||s&&_(s.resolve())!=f||r&&_(new r)!=h||o&&_(new o)!=p)&&(_=function(e){var t=l(e),n=t==d?e.constructor:void 0,a=n?c(n):"";if(a)switch(a){case v:return m;case b:return u;case E:return f;case g:return h;case y:return p}return t}),e.exports=_},4416:function(e,t){function n(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}e.exports=n},"452e":function(e,t,n){"use strict";var a=n("cf03"),i=n.n(a);i.a},4755:function(e,t,n){"use strict";var a=n("61b5"),i=n.n(a);i.a},"47f5":function(e,t,n){var a=n("2b03"),i=n("d9a8"),s=n("099a");function r(e,t,n){return t===t?s(e,t,n):a(e,i,n)}e.exports=r},4851:function(e,t,n){},"491f":function(e,t,n){"use strict";(function(e){n("d3b7"),n("25f0");t["a"]={data:function(){return{isShow:!1,sourceRow:{},sourceRowKey:"",text:"",type:""}},props:{},watch:{},computed:{},methods:{onVisiable:function(e){this.$emit("action",{type:"visiable",data:e})},submit:function(){this.$emit("action",{type:"submit-effect",data:this.text,row:this.sourceRow,key:this.sourceRowKey}),this.isShow=!1},s2b:function(e){for(var t=atob(e),n="",a=0;a<t.length;a++){var i=t.charCodeAt(a).toString(16);n+=2===i.length?i:"0"+i}return n.toUpperCase()},getImage:function(e){},b2s:function(t){var n=new e(t,"base64"),a=n.toString();return a},show:function(e,t,n){this.sourceRow=e,this.sourceRowKey=t,this.text=e[t],this.type=n,this.isShow=!0},hide:function(e){this.isShow=!1},onOpened:function(){var e=this.$refs.focusRef;e&&e.focus()},onCopy:function(){var e=this;this.$copyText(this.sql).then((function(t){e.onSuccess("已复制")}),(function(e){this.onError("复制失败")}))}},mounted:function(){},components:{}}}).call(this,n("b639").Buffer)},"4b17":function(e,t,n){var a=n("6428");function i(e){var t=a(e),n=t%1;return t===t?n?t-n:t:0}e.exports=i},"4b8d":function(e,t,n){},"4d0b":function(e,t,n){"use strict";var a=n("c6be"),i=n.n(a);i.a},"4ff7":function(e,t,n){},"50d8":function(e,t){function n(e,t){var n=-1,a=Array(e);while(++n<e)a[n]=t(n);return a}e.exports=n},5634:function(e,t,n){},"57a5":function(e,t,n){var a=n("91e9"),i=a(Object.keys,Object);e.exports=i},5836:function(e,t,n){"use strict";var a=n("9ffa"),i=n.n(a);i.a},"585a":function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n("c8ba"))},"5c90":function(e,t,n){},"5d2a":function(e,t,n){},"5fb2":function(e,t,n){"use strict";var a=2147483647,i=36,s=1,r=26,o=38,l=700,c=72,u=128,d="-",f=/[^\0-\u007E]/,h=/[.\u3002\uFF0E\uFF61]/g,p="Overflow: input needs wider integers to process",m=i-s,v=Math.floor,b=String.fromCharCode,E=function(e){var t=[],n=0,a=e.length;while(n<a){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<a){var s=e.charCodeAt(n++);56320==(64512&s)?t.push(((1023&i)<<10)+(1023&s)+65536):(t.push(i),n--)}else t.push(i)}return t},g=function(e){return e+22+75*(e<26)},y=function(e,t,n){var a=0;for(e=n?v(e/l):e>>1,e+=v(e/t);e>m*r>>1;a+=i)e=v(e/m);return v(a+(m+1)*e/(e+o))},_=function(e){var t=[];e=E(e);var n,o,l=e.length,f=u,h=0,m=c;for(n=0;n<e.length;n++)o=e[n],o<128&&t.push(b(o));var _=t.length,T=_;_&&t.push(d);while(T<l){var R=a;for(n=0;n<e.length;n++)o=e[n],o>=f&&o<R&&(R=o);var S=T+1;if(R-f>v((a-h)/S))throw RangeError(p);for(h+=(R-f)*S,f=R,n=0;n<e.length;n++){if(o=e[n],o<f&&++h>a)throw RangeError(p);if(o==f){for(var I=h,L=i;;L+=i){var w=L<=m?s:L>=m+r?r:L-m;if(I<w)break;var O=I-w,x=i-w;t.push(b(g(w+O%x))),I=v(O/x)}t.push(b(g(I))),m=y(h,S,T==_),h=0,++T}}++h,++f}return t.join("")};e.exports=function(e){var t,n,a=[],i=e.toLowerCase().replace(h,".").split(".");for(t=0;t<i.length;t++)n=i[t],a.push(f.test(n)?"xn--"+_(n):n);return a.join(".")}},"61b5":function(e,t,n){},"635c":function(e,t,n){"use strict";var a=n("4ff7"),i=n.n(a);i.a},6428:function(e,t,n){var a=n("b4b0"),i=1/0,s=17976931348623157e292;function r(e){if(!e)return 0===e?e:0;if(e=a(e),e===i||e===-i){var t=e<0?-1:1;return t*s}return e===e?e:0}e.exports=r},6451:function(e,t,n){},"64c4":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=s(n("fd29")),i=s(n("7f51"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var c,u=["ACCESSIBLE","ACTION","AGAINST","AGGREGATE","ALGORITHM","ALL","ALTER","ANALYSE","ANALYZE","AS","ASC","AUTOCOMMIT","AUTO_INCREMENT","BACKUP","BEGIN","BETWEEN","BINLOG","BOTH","CASCADE","CASE","CHANGE","CHANGED","CHARACTER SET","CHARSET","CHECK","CHECKSUM","COLLATE","COLLATION","COLUMN","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPRESSED","CONCURRENT","CONSTRAINT","CONTAINS","CONVERT","CREATE","CROSS","CURRENT_TIMESTAMP","DATABASE","DATABASES","DAY","DAY_HOUR","DAY_MINUTE","DAY_SECOND","DEFAULT","DEFINER","DELAYED","DELETE","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DO","DROP","DUMPFILE","DUPLICATE","DYNAMIC","ELSE","ENCLOSED","END","ENGINE","ENGINES","ENGINE_TYPE","ESCAPE","ESCAPED","EVENTS","EXEC","EXECUTE","EXISTS","EXPLAIN","EXTENDED","FAST","FETCH","FIELDS","FILE","FIRST","FIXED","FLUSH","FOR","FORCE","FOREIGN","FULL","FULLTEXT","FUNCTION","GLOBAL","GRANT","GRANTS","GROUP_CONCAT","HEAP","HIGH_PRIORITY","HOSTS","HOUR","HOUR_MINUTE","HOUR_SECOND","IDENTIFIED","IF","IFNULL","IGNORE","IN","INDEX","INDEXES","INFILE","INSERT","INSERT_ID","INSERT_METHOD","INTERVAL","INTO","INVOKER","IS","ISOLATION","KEY","KEYS","KILL","LAST_INSERT_ID","LEADING","LEVEL","LIKE","LINEAR","LINES","LOAD","LOCAL","LOCK","LOCKS","LOGS","LOW_PRIORITY","MARIA","MASTER","MASTER_CONNECT_RETRY","MASTER_HOST","MASTER_LOG_FILE","MATCH","MAX_CONNECTIONS_PER_HOUR","MAX_QUERIES_PER_HOUR","MAX_ROWS","MAX_UPDATES_PER_HOUR","MAX_USER_CONNECTIONS","MEDIUM","MERGE","MINUTE","MINUTE_SECOND","MIN_ROWS","MODE","MODIFY","MONTH","MRG_MYISAM","MYISAM","NAMES","NATURAL","NOT","NOW()","NULL","OFFSET","ON DELETE","ON UPDATE","ON","ONLY","OPEN","OPTIMIZE","OPTION","OPTIONALLY","OUTFILE","PACK_KEYS","PAGE","PARTIAL","PARTITION","PARTITIONS","PASSWORD","PRIMARY","PRIVILEGES","PROCEDURE","PROCESS","PROCESSLIST","PURGE","QUICK","RAID0","RAID_CHUNKS","RAID_CHUNKSIZE","RAID_TYPE","RANGE","READ","READ_ONLY","READ_WRITE","REFERENCES","REGEXP","RELOAD","RENAME","REPAIR","REPEATABLE","REPLACE","REPLICATION","RESET","RESTORE","RESTRICT","RETURN","RETURNS","REVOKE","RLIKE","ROLLBACK","ROW","ROWS","ROW_FORMAT","SECOND","SECURITY","SEPARATOR","SERIALIZABLE","SESSION","SHARE","SHOW","SHUTDOWN","SLAVE","SONAME","SOUNDS","SQL","SQL_AUTO_IS_NULL","SQL_BIG_RESULT","SQL_BIG_SELECTS","SQL_BIG_TABLES","SQL_BUFFER_RESULT","SQL_CACHE","SQL_CALC_FOUND_ROWS","SQL_LOG_BIN","SQL_LOG_OFF","SQL_LOG_UPDATE","SQL_LOW_PRIORITY_UPDATES","SQL_MAX_JOIN_SIZE","SQL_NO_CACHE","SQL_QUOTE_SHOW_CREATE","SQL_SAFE_UPDATES","SQL_SELECT_LIMIT","SQL_SLAVE_SKIP_COUNTER","SQL_SMALL_RESULT","SQL_WARNINGS","START","STARTING","STATUS","STOP","STORAGE","STRAIGHT_JOIN","STRING","STRIPED","SUPER","TABLE","TABLES","TEMPORARY","TERMINATED","THEN","TO","TRAILING","TRANSACTIONAL","TRUE","TRUNCATE","TYPE","TYPES","UNCOMMITTED","UNIQUE","UNLOCK","UNSIGNED","USAGE","USE","USING","VARIABLES","VIEW","WHEN","WITH","WORK","WRITE","YEAR_MONTH"],d=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INSERT","LIMIT","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],f=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],h=["AND","CROSS APPLY","CROSS JOIN","ELSE","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],p=function(){function e(t){r(this,e),this.cfg=t}return l(e,[{key:"format",value:function(e){return c||(c=new i["default"]({reservedWords:u,reservedTopLevelWords:d,reservedNewlineWords:h,reservedTopLevelWordsNoIndent:f,stringTypes:['""',"N''","''","``","[]"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:["@",":"],lineCommentTypes:["#","--"]})),new a["default"](this.cfg,c).format(e)}}]),e}();t["default"]=p,e.exports=t.default},"65b9":function(e,t,n){},6747:function(e,t){var n=Array.isArray;e.exports=n},"67fc":function(e,t,n){"use strict";var a=n("1be5"),i=n.n(a);i.a},6961:function(e,t,n){"use strict";var a=n("eaab"),i=n.n(a);i.a},"6aeb":function(e,t,n){},"6eed5":function(e,t,n){},"6fcd":function(e,t,n){var a=n("50d8"),i=n("d370"),s=n("6747"),r=n("0d24"),o=n("c0983"),l=n("73ac"),c=Object.prototype,u=c.hasOwnProperty;function d(e,t){var n=s(e),c=!n&&i(e),d=!n&&!c&&r(e),f=!n&&!c&&!d&&l(e),h=n||c||d||f,p=h?a(e.length,String):[],m=p.length;for(var v in e)!t&&!u.call(e,v)||h&&("length"==v||d&&("offset"==v||"parent"==v)||f&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||o(v,m))||p.push(v);return p}e.exports=d},"73ac":function(e,t,n){var a=n("743f"),i=n("b047"),s=n("99d3"),r=s&&s.isTypedArray,o=r?i(r):a;e.exports=o},"743f":function(e,t,n){var a=n("3729"),i=n("b218"),s=n("1310"),r="[object Arguments]",o="[object Array]",l="[object Boolean]",c="[object Date]",u="[object Error]",d="[object Function]",f="[object Map]",h="[object Number]",p="[object Object]",m="[object RegExp]",v="[object Set]",b="[object String]",E="[object WeakMap]",g="[object ArrayBuffer]",y="[object DataView]",_="[object Float32Array]",T="[object Float64Array]",R="[object Int8Array]",S="[object Int16Array]",I="[object Int32Array]",L="[object Uint8Array]",w="[object Uint8ClampedArray]",O="[object Uint16Array]",x="[object Uint32Array]",D={};function A(e){return s(e)&&i(e.length)&&!!D[a(e)]}D[_]=D[T]=D[R]=D[S]=D[I]=D[L]=D[w]=D[O]=D[x]=!0,D[r]=D[o]=D[g]=D[l]=D[y]=D[c]=D[u]=D[d]=D[f]=D[h]=D[p]=D[m]=D[v]=D[b]=D[E]=!1,e.exports=A},"750d":function(e,t,n){"use strict";var a=n("6aeb"),i=n.n(a);i.a},"757c":function(e,t,n){},7660:function(e,t,n){"use strict";var a=n("41f1"),i=n.n(a);i.a},"76dd":function(e,t,n){var a=n("ce86");function i(e){return null==e?"":a(e)}e.exports=i},7948:function(e,t){function n(e,t){var n=-1,a=null==e?0:e.length,i=Array(a);while(++n<a)i[n]=t(e[n],n,e);return i}e.exports=n},"79bc":function(e,t,n){var a=n("0b07"),i=n("2b3e"),s=a(i,"Map");e.exports=s},"7b7d":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=s(n("fd29")),i=s(n("7f51"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var c,u=["ABS","ACTIVATE","ALIAS","ALL","ALLOCATE","ALLOW","ALTER","ANY","ARE","ARRAY","AS","ASC","ASENSITIVE","ASSOCIATE","ASUTIME","ASYMMETRIC","AT","ATOMIC","ATTRIBUTES","AUDIT","AUTHORIZATION","AUX","AUXILIARY","AVG","BEFORE","BEGIN","BETWEEN","BIGINT","BINARY","BLOB","BOOLEAN","BOTH","BUFFERPOOL","BY","CACHE","CALL","CALLED","CAPTURE","CARDINALITY","CASCADED","CASE","CAST","CCSID","CEIL","CEILING","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CLOB","CLONE","CLOSE","CLUSTER","COALESCE","COLLATE","COLLECT","COLLECTION","COLLID","COLUMN","COMMENT","COMMIT","CONCAT","CONDITION","CONNECT","CONNECTION","CONSTRAINT","CONTAINS","CONTINUE","CONVERT","CORR","CORRESPONDING","COUNT","COUNT_BIG","COVAR_POP","COVAR_SAMP","CREATE","CROSS","CUBE","CUME_DIST","CURRENT","CURRENT_DATE","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_LC_CTYPE","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SERVER","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CYCLE","DATA","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DATE","DAY","DAYS","DB2GENERAL","DB2GENRL","DB2SQL","DBINFO","DBPARTITIONNAME","DBPARTITIONNUM","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFAULTS","DEFINITION","DELETE","DENSERANK","DENSE_RANK","DEREF","DESCRIBE","DESCRIPTOR","DETERMINISTIC","DIAGNOSTICS","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DO","DOCUMENT","DOUBLE","DROP","DSSIZE","DYNAMIC","EACH","EDITPROC","ELEMENT","ELSE","ELSEIF","ENABLE","ENCODING","ENCRYPTION","END","END-EXEC","ENDING","ERASE","ESCAPE","EVERY","EXCEPTION","EXCLUDING","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXP","EXPLAIN","EXTENDED","EXTERNAL","EXTRACT","FALSE","FENCED","FETCH","FIELDPROC","FILE","FILTER","FINAL","FIRST","FLOAT","FLOOR","FOR","FOREIGN","FREE","FULL","FUNCTION","FUSION","GENERAL","GENERATED","GET","GLOBAL","GOTO","GRANT","GRAPHIC","GROUP","GROUPING","HANDLER","HASH","HASHED_VALUE","HINT","HOLD","HOUR","HOURS","IDENTITY","IF","IMMEDIATE","IN","INCLUDING","INCLUSIVE","INCREMENT","INDEX","INDICATOR","INDICATORS","INF","INFINITY","INHERIT","INNER","INOUT","INSENSITIVE","INSERT","INT","INTEGER","INTEGRITY","INTERSECTION","INTERVAL","INTO","IS","ISOBID","ISOLATION","ITERATE","JAR","JAVA","KEEP","KEY","LABEL","LANGUAGE","LARGE","LATERAL","LC_CTYPE","LEADING","LEAVE","LEFT","LIKE","LINKTYPE","LN","LOCAL","LOCALDATE","LOCALE","LOCALTIME","LOCALTIMESTAMP","LOCATOR","LOCATORS","LOCK","LOCKMAX","LOCKSIZE","LONG","LOOP","LOWER","MAINTAINED","MATCH","MATERIALIZED","MAX","MAXVALUE","MEMBER","MERGE","METHOD","MICROSECOND","MICROSECONDS","MIN","MINUTE","MINUTES","MINVALUE","MOD","MODE","MODIFIES","MODULE","MONTH","MONTHS","MULTISET","NAN","NATIONAL","NATURAL","NCHAR","NCLOB","NEW","NEW_TABLE","NEXTVAL","NO","NOCACHE","NOCYCLE","NODENAME","NODENUMBER","NOMAXVALUE","NOMINVALUE","NONE","NOORDER","NORMALIZE","NORMALIZED","NOT","NULL","NULLIF","NULLS","NUMERIC","NUMPARTS","OBID","OCTET_LENGTH","OF","OFFSET","OLD","OLD_TABLE","ON","ONLY","OPEN","OPTIMIZATION","OPTIMIZE","OPTION","ORDER","OUT","OUTER","OVER","OVERLAPS","OVERLAY","OVERRIDING","PACKAGE","PADDED","PAGESIZE","PARAMETER","PART","PARTITION","PARTITIONED","PARTITIONING","PARTITIONS","PASSWORD","PATH","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PIECESIZE","PLAN","POSITION","POWER","PRECISION","PREPARE","PREVVAL","PRIMARY","PRIQTY","PRIVILEGES","PROCEDURE","PROGRAM","PSID","PUBLIC","QUERY","QUERYNO","RANGE","RANK","READ","READS","REAL","RECOVERY","RECURSIVE","REF","REFERENCES","REFERENCING","REFRESH","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RENAME","REPEAT","RESET","RESIGNAL","RESTART","RESTRICT","RESULT","RESULT_SET_LOCATOR","RETURN","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROLLUP","ROUND_CEILING","ROUND_DOWN","ROUND_FLOOR","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_HALF_UP","ROUND_UP","ROUTINE","ROW","ROWNUMBER","ROWS","ROWSET","ROW_NUMBER","RRN","RUN","SAVEPOINT","SCHEMA","SCOPE","SCRATCHPAD","SCROLL","SEARCH","SECOND","SECONDS","SECQTY","SECURITY","SENSITIVE","SEQUENCE","SESSION","SESSION_USER","SIGNAL","SIMILAR","SIMPLE","SMALLINT","SNAN","SOME","SOURCE","SPECIFIC","SPECIFICTYPE","SQL","SQLEXCEPTION","SQLID","SQLSTATE","SQLWARNING","SQRT","STACKED","STANDARD","START","STARTING","STATEMENT","STATIC","STATMENT","STAY","STDDEV_POP","STDDEV_SAMP","STOGROUP","STORES","STYLE","SUBMULTISET","SUBSTRING","SUM","SUMMARY","SYMMETRIC","SYNONYM","SYSFUN","SYSIBM","SYSPROC","SYSTEM","SYSTEM_USER","TABLE","TABLESAMPLE","TABLESPACE","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TRAILING","TRANSACTION","TRANSLATE","TRANSLATION","TREAT","TRIGGER","TRIM","TRUE","TRUNCATE","TYPE","UESCAPE","UNDO","UNIQUE","UNKNOWN","UNNEST","UNTIL","UPPER","USAGE","USER","USING","VALIDPROC","VALUE","VARCHAR","VARIABLE","VARIANT","VARYING","VAR_POP","VAR_SAMP","VCAT","VERSION","VIEW","VOLATILE","VOLUMES","WHEN","WHENEVER","WHILE","WIDTH_BUCKET","WINDOW","WITH","WITHIN","WITHOUT","WLM","WRITE","XMLELEMENT","XMLEXISTS","XMLNAMESPACES","YEAR","YEARS"],d=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INTERSECT","LIMIT","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],f=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],h=["AND","CROSS JOIN","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN"],p=function(){function e(t){r(this,e),this.cfg=t}return l(e,[{key:"format",value:function(e){return c||(c=new i["default"]({reservedWords:u,reservedTopLevelWords:d,reservedNewlineWords:h,reservedTopLevelWordsNoIndent:f,stringTypes:['""',"''","``","[]"],openParens:["("],closeParens:[")"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["#","@"]})),new a["default"](this.cfg,c).format(e)}}]),e}();t["default"]=p,e.exports=t.default},"7f51":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=r(n("13ea")),i=r(n("9062")),s=r(n("f779"));function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var u=function(){function e(t){o(this,e),this.WHITESPACE_REGEX=/^([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)/,this.NUMBER_REGEX=/^((\x2D[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?[0-9]+(\.[0-9]+)?|0x[0-9A-Fa-f]+|0b[01]+)\b/,this.OPERATOR_REGEX=/^(!=|<>|==|<=|>=|!<|!>|\|\||::|\x2D>>|\x2D>|~~\*|~~|!~~\*|!~~|~\*|!~\*|!~|:=|(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/,this.BLOCK_COMMENT_REGEX=/^(\/\*(?:[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:\*\/|$))/,this.LINE_COMMENT_REGEX=this.createLineCommentRegex(t.lineCommentTypes),this.RESERVED_TOP_LEVEL_REGEX=this.createReservedWordRegex(t.reservedTopLevelWords),this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX=this.createReservedWordRegex(t.reservedTopLevelWordsNoIndent),this.RESERVED_NEWLINE_REGEX=this.createReservedWordRegex(t.reservedNewlineWords),this.RESERVED_PLAIN_REGEX=this.createReservedWordRegex(t.reservedWords),this.WORD_REGEX=this.createWordRegex(t.specialWordChars),this.STRING_REGEX=this.createStringRegex(t.stringTypes),this.OPEN_PAREN_REGEX=this.createParenRegex(t.openParens),this.CLOSE_PAREN_REGEX=this.createParenRegex(t.closeParens),this.INDEXED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(t.indexedPlaceholderTypes,"[0-9]*"),this.IDENT_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(t.namedPlaceholderTypes,"[a-zA-Z0-9._$]+"),this.STRING_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(t.namedPlaceholderTypes,this.createStringPattern(t.stringTypes))}return c(e,[{key:"createLineCommentRegex",value:function(e){return new RegExp("^((?:".concat(e.map((function(e){return(0,i["default"])(e)})).join("|"),").*?(?:\r\n|\r|\n|$))"),"u")}},{key:"createReservedWordRegex",value:function(e){var t=e.join("|").replace(/ /g,"\\s+");return new RegExp("^(".concat(t,")\\b"),"iu")}},{key:"createWordRegex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new RegExp("^([\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}".concat(e.join(""),"]+)"),"u")}},{key:"createStringRegex",value:function(e){return new RegExp("^("+this.createStringPattern(e)+")","u")}},{key:"createStringPattern",value:function(e){var t={"``":"((`[^`]*($|`))+)","[]":"((\\[[^\\]]*($|\\]))(\\][^\\]]*($|\\]))*)",'""':'(("[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',"''":"(('[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","N''":"((N'[^N'\\\\]*(?:\\\\.[^N'\\\\]*)*('|$))+)"};return e.map((function(e){return t[e]})).join("|")}},{key:"createParenRegex",value:function(e){var t=this;return new RegExp("^("+e.map((function(e){return t.escapeParen(e)})).join("|")+")","iu")}},{key:"escapeParen",value:function(e){return 1===e.length?(0,i["default"])(e):"\\b"+e+"\\b"}},{key:"createPlaceholderRegex",value:function(e,t){if((0,a["default"])(e))return!1;var n=e.map(i["default"]).join("|");return new RegExp("^((?:".concat(n,")(?:").concat(t,"))"),"u")}},{key:"tokenize",value:function(e){if(!e)return[];var t,n=[];while(e.length)t=this.getNextToken(e,t),e=e.substring(t.value.length),n.push(t);return n}},{key:"getNextToken",value:function(e,t){return this.getWhitespaceToken(e)||this.getCommentToken(e)||this.getStringToken(e)||this.getOpenParenToken(e)||this.getCloseParenToken(e)||this.getPlaceholderToken(e)||this.getNumberToken(e)||this.getReservedWordToken(e,t)||this.getWordToken(e)||this.getOperatorToken(e)}},{key:"getWhitespaceToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].WHITESPACE,regex:this.WHITESPACE_REGEX})}},{key:"getCommentToken",value:function(e){return this.getLineCommentToken(e)||this.getBlockCommentToken(e)}},{key:"getLineCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].LINE_COMMENT,regex:this.LINE_COMMENT_REGEX})}},{key:"getBlockCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].BLOCK_COMMENT,regex:this.BLOCK_COMMENT_REGEX})}},{key:"getStringToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].STRING,regex:this.STRING_REGEX})}},{key:"getOpenParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].OPEN_PAREN,regex:this.OPEN_PAREN_REGEX})}},{key:"getCloseParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].CLOSE_PAREN,regex:this.CLOSE_PAREN_REGEX})}},{key:"getPlaceholderToken",value:function(e){return this.getIdentNamedPlaceholderToken(e)||this.getStringNamedPlaceholderToken(e)||this.getIndexedPlaceholderToken(e)}},{key:"getIdentNamedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.IDENT_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getStringNamedPlaceholderToken",value:function(e){var t=this;return this.getPlaceholderTokenWithKey({input:e,regex:this.STRING_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return t.getEscapedPlaceholderKey({key:e.slice(2,-1),quoteChar:e.slice(-1)})}})}},{key:"getIndexedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.INDEXED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getPlaceholderTokenWithKey",value:function(e){var t=e.input,n=e.regex,a=e.parseKey,i=this.getTokenOnFirstMatch({input:t,regex:n,type:s["default"].PLACEHOLDER});return i&&(i.key=a(i.value)),i}},{key:"getEscapedPlaceholderKey",value:function(e){var t=e.key,n=e.quoteChar;return t.replace(new RegExp((0,i["default"])("\\"+n),"gu"),n)}},{key:"getNumberToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].NUMBER,regex:this.NUMBER_REGEX})}},{key:"getOperatorToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].OPERATOR,regex:this.OPERATOR_REGEX})}},{key:"getReservedWordToken",value:function(e,t){if(!t||!t.value||"."!==t.value)return this.getTopLevelReservedToken(e)||this.getNewlineReservedToken(e)||this.getTopLevelReservedTokenNoIndent(e)||this.getPlainReservedToken(e)}},{key:"getTopLevelReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].RESERVED_TOP_LEVEL,regex:this.RESERVED_TOP_LEVEL_REGEX})}},{key:"getNewlineReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].RESERVED_NEWLINE,regex:this.RESERVED_NEWLINE_REGEX})}},{key:"getTopLevelReservedTokenNoIndent",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].RESERVED_TOP_LEVEL_NO_INDENT,regex:this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX})}},{key:"getPlainReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].RESERVED,regex:this.RESERVED_PLAIN_REGEX})}},{key:"getWordToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:s["default"].WORD,regex:this.WORD_REGEX})}},{key:"getTokenOnFirstMatch",value:function(e){var t=e.input,n=e.type,a=e.regex,i=t.match(a);if(i)return{type:n,value:i[1]}}}]),e}();t["default"]=u,e.exports=t.default},"7f6c":function(e,t,n){},"801f":function(e,t,n){"use strict";var a=n("65b9"),i=n.n(a);i.a},"80d0":function(e,t,n){"use strict";var a=n("23d2"),i=n.n(a);i.a},8101:function(e,t,n){"use strict";var a=n("5c90"),i=n.n(a);i.a},"827e":function(e,t,n){},8448:function(e,t,n){var a=n("b0a8"),i=n("9aff"),s=n("4b17"),r=n("76dd");function o(e,t,n){return t=(n?i(e,t,n):void 0===t)?1:s(t),a(r(e),t)}e.exports=o},"849e":function(e,t,n){},8688:function(e,t,n){"use strict";var a=n("bc2f"),i=n.n(a);i.a},"87c9":function(e,t,n){"use strict";var a=n("4851"),i=n.n(a);i.a},"8a30":function(e,t,n){var a=n("47f5"),i=n("30c9"),s=n("e2a0"),r=n("4b17"),o=n("3ff1"),l=Math.max;function c(e,t,n,c){e=i(e)?e:o(e),n=n&&!c?r(n):0;var u=e.length;return n<0&&(n=l(u+n,0)),s(e)?n<=u&&e.indexOf(t,n)>-1:!!u&&a(e,t,n)>-1}e.exports=c},9062:function(e,t,n){var a=n("76dd"),i=/[\\^$.*+?()[\]{}|]/g,s=RegExp(i.source);function r(e){return e=a(e),e&&s.test(e)?e.replace(i,"\\$&"):e}e.exports=r},"91e9":function(e,t){function n(e,t){return function(n){return e(t(n))}}e.exports=n},"93a9":function(e,t,n){},9520:function(e,t,n){var a=n("3729"),i=n("1a8c"),s="[object AsyncFunction]",r="[object Function]",o="[object GeneratorFunction]",l="[object Proxy]";function c(e){if(!i(e))return!1;var t=a(e);return t==r||t==o||t==s||t==l}e.exports=c},9638:function(e,t){function n(e,t){return e===t||e!==e&&t!==t}e.exports=n},"963f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=i(n("f779"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var l=50,c=function(){function e(){s(this,e),this.level=0}return o(e,[{key:"beginIfPossible",value:function(e,t){0===this.level&&this.isInlineBlock(e,t)?this.level=1:this.level>0?this.level++:this.level=0}},{key:"end",value:function(){this.level--}},{key:"isActive",value:function(){return this.level>0}},{key:"isInlineBlock",value:function(e,t){for(var n=0,i=0,s=t;s<e.length;s++){var r=e[s];if(n+=r.value.length,n>l)return!1;if(r.type===a["default"].OPEN_PAREN)i++;else if(r.type===a["default"].CLOSE_PAREN&&(i--,0===i))return!0;if(this.isForbiddenToken(r))return!1}return!1}},{key:"isForbiddenToken",value:function(e){var t=e.type,n=e.value;return t===a["default"].RESERVED_TOP_LEVEL||t===a["default"].RESERVED_NEWLINE||t===a["default"].COMMENT||t===a["default"].BLOCK_COMMENT||";"===n}}]),e}();t["default"]=c,e.exports=t.default},9861:function(e,t,n){"use strict";n("e260");var a=n("23e7"),i=n("d066"),s=n("0d3b"),r=n("6eeb"),o=n("e2cc"),l=n("d44e"),c=n("9ed3"),u=n("69f3"),d=n("19aa"),f=n("5135"),h=n("0366"),p=n("f5df"),m=n("825a"),v=n("861d"),b=n("7c73"),E=n("5c6c"),g=n("9a1f"),y=n("35a1"),_=n("b622"),T=i("fetch"),R=i("Headers"),S=_("iterator"),I="URLSearchParams",L=I+"Iterator",w=u.set,O=u.getterFor(I),x=u.getterFor(L),D=/\+/g,A=Array(4),N=function(e){return A[e-1]||(A[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},C=function(e){try{return decodeURIComponent(e)}catch(t){return e}},k=function(e){var t=e.replace(D," "),n=4;try{return decodeURIComponent(t)}catch(a){while(n)t=t.replace(N(n--),C);return t}},U=/[!'()~]|%20/g,P={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},M=function(e){return P[e]},j=function(e){return encodeURIComponent(e).replace(U,M)},$=function(e,t){if(t){var n,a,i=t.split("&"),s=0;while(s<i.length)n=i[s++],n.length&&(a=n.split("="),e.push({key:k(a.shift()),value:k(a.join("="))}))}},F=function(e){this.entries.length=0,$(this.entries,e)},B=function(e,t){if(e<t)throw TypeError("Not enough arguments")},q=c((function(e,t){w(this,{type:L,iterator:g(O(e).entries),kind:t})}),"Iterator",(function(){var e=x(this),t=e.kind,n=e.iterator.next(),a=n.value;return n.done||(n.value="keys"===t?a.key:"values"===t?a.value:[a.key,a.value]),n})),H=function(){d(this,H,I);var e,t,n,a,i,s,r,o,l,c=arguments.length>0?arguments[0]:void 0,u=this,h=[];if(w(u,{type:I,entries:h,updateURL:function(){},updateSearchParams:F}),void 0!==c)if(v(c))if(e=y(c),"function"===typeof e){t=e.call(c),n=t.next;while(!(a=n.call(t)).done){if(i=g(m(a.value)),s=i.next,(r=s.call(i)).done||(o=s.call(i)).done||!s.call(i).done)throw TypeError("Expected sequence with length 2");h.push({key:r.value+"",value:o.value+""})}}else for(l in c)f(c,l)&&h.push({key:l,value:c[l]+""});else $(h,"string"===typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},V=H.prototype;o(V,{append:function(e,t){B(arguments.length,2);var n=O(this);n.entries.push({key:e+"",value:t+""}),n.updateURL()},delete:function(e){B(arguments.length,1);var t=O(this),n=t.entries,a=e+"",i=0;while(i<n.length)n[i].key===a?n.splice(i,1):i++;t.updateURL()},get:function(e){B(arguments.length,1);for(var t=O(this).entries,n=e+"",a=0;a<t.length;a++)if(t[a].key===n)return t[a].value;return null},getAll:function(e){B(arguments.length,1);for(var t=O(this).entries,n=e+"",a=[],i=0;i<t.length;i++)t[i].key===n&&a.push(t[i].value);return a},has:function(e){B(arguments.length,1);var t=O(this).entries,n=e+"",a=0;while(a<t.length)if(t[a++].key===n)return!0;return!1},set:function(e,t){B(arguments.length,1);for(var n,a=O(this),i=a.entries,s=!1,r=e+"",o=t+"",l=0;l<i.length;l++)n=i[l],n.key===r&&(s?i.splice(l--,1):(s=!0,n.value=o));s||i.push({key:r,value:o}),a.updateURL()},sort:function(){var e,t,n,a=O(this),i=a.entries,s=i.slice();for(i.length=0,n=0;n<s.length;n++){for(e=s[n],t=0;t<n;t++)if(i[t].key>e.key){i.splice(t,0,e);break}t===n&&i.push(e)}a.updateURL()},forEach:function(e){var t,n=O(this).entries,a=h(e,arguments.length>1?arguments[1]:void 0,3),i=0;while(i<n.length)t=n[i++],a(t.value,t.key,this)},keys:function(){return new q(this,"keys")},values:function(){return new q(this,"values")},entries:function(){return new q(this,"entries")}},{enumerable:!0}),r(V,S,V.entries),r(V,"toString",(function(){var e,t=O(this).entries,n=[],a=0;while(a<t.length)e=t[a++],n.push(j(e.key)+"="+j(e.value));return n.join("&")}),{enumerable:!0}),l(H,I),a({global:!0,forced:!s},{URLSearchParams:H}),s||"function"!=typeof T||"function"!=typeof R||a({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,n,a,i=[e];return arguments.length>1&&(t=arguments[1],v(t)&&(n=t.body,p(n)===I&&(a=t.headers?new R(t.headers):new R,a.has("content-type")||a.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=b(t,{body:E(0,String(n)),headers:E(0,a)}))),i.push(t)),T.apply(this,i)}}),e.exports={URLSearchParams:H,getState:O}},"99d3":function(e,t,n){(function(e){var a=n("585a"),i=t&&!t.nodeType&&t,s=i&&"object"==typeof e&&e&&!e.nodeType&&e,r=s&&s.exports===i,o=r&&a.process,l=function(){try{var e=s&&s.require&&s.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(t){}}();e.exports=l}).call(this,n("62e4")(e))},"9a1f":function(e,t,n){var a=n("825a"),i=n("35a1");e.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return a(t.call(e))}},"9aff":function(e,t,n){var a=n("9638"),i=n("30c9"),s=n("c0983"),r=n("1a8c");function o(e,t,n){if(!r(n))return!1;var o=typeof t;return!!("number"==o?i(n)&&s(t,n.length):"string"==o&&t in n)&&a(n[t],e)}e.exports=o},"9e35":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=s(n("fd29")),i=s(n("7f51"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var c,u=["ALL","ALTER","ANALYZE","AND","ANY","ARRAY","AS","ASC","BEGIN","BETWEEN","BINARY","BOOLEAN","BREAK","BUCKET","BUILD","BY","CALL","CASE","CAST","CLUSTER","COLLATE","COLLECTION","COMMIT","CONNECT","CONTINUE","CORRELATE","COVER","CREATE","DATABASE","DATASET","DATASTORE","DECLARE","DECREMENT","DELETE","DERIVED","DESC","DESCRIBE","DISTINCT","DO","DROP","EACH","ELEMENT","ELSE","END","EVERY","EXCEPT","EXCLUDE","EXECUTE","EXISTS","EXPLAIN","FALSE","FETCH","FIRST","FLATTEN","FOR","FORCE","FROM","FUNCTION","GRANT","GROUP","GSI","HAVING","IF","IGNORE","ILIKE","IN","INCLUDE","INCREMENT","INDEX","INFER","INLINE","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KEYS","KEYSPACE","KNOWN","LAST","LEFT","LET","LETTING","LIKE","LIMIT","LSM","MAP","MAPPING","MATCHED","MATERIALIZED","MERGE","MISSING","NAMESPACE","NEST","NOT","NULL","NUMBER","OBJECT","OFFSET","ON","OPTION","OR","ORDER","OUTER","OVER","PARSE","PARTITION","PASSWORD","PATH","POOL","PREPARE","PRIMARY","PRIVATE","PRIVILEGE","PROCEDURE","PUBLIC","RAW","REALM","REDUCE","RENAME","RETURN","RETURNING","REVOKE","RIGHT","ROLE","ROLLBACK","SATISFIES","SCHEMA","SELECT","SELF","SEMI","SET","SHOW","SOME","START","STATISTICS","STRING","SYSTEM","THEN","TO","TRANSACTION","TRIGGER","TRUE","TRUNCATE","UNDER","UNION","UNIQUE","UNKNOWN","UNNEST","UNSET","UPDATE","UPSERT","USE","USER","USING","VALIDATE","VALUE","VALUED","VALUES","VIA","VIEW","WHEN","WHERE","WHILE","WITH","WITHIN","WORK","XOR"],d=["DELETE FROM","EXCEPT ALL","EXCEPT","EXPLAIN DELETE FROM","EXPLAIN UPDATE","EXPLAIN UPSERT","FROM","GROUP BY","HAVING","INFER","INSERT INTO","LET","LIMIT","MERGE","NEST","ORDER BY","PREPARE","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNNEST","UPDATE","UPSERT","USE KEYS","VALUES","WHERE"],f=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],h=["AND","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","XOR"],p=function(){function e(t){r(this,e),this.cfg=t}return l(e,[{key:"format",value:function(e){return c||(c=new i["default"]({reservedWords:u,reservedTopLevelWords:d,reservedNewlineWords:h,reservedTopLevelWordsNoIndent:f,stringTypes:['""',"''","``"],openParens:["(","[","{"],closeParens:[")","]","}"],namedPlaceholderTypes:["$"],lineCommentTypes:["#","--"]})),new a["default"](this.cfg,c).format(e)}}]),e}();t["default"]=p,e.exports=t.default},"9e69":function(e,t,n){var a=n("2b3e"),i=a.Symbol;e.exports=i},"9ffa":function(e,t,n){},a278:function(e,t,n){"use strict";var a=n("3888"),i=n.n(a);i.a},a413:function(e,t,n){"use strict";var a=n("0684"),i=n.n(a);i.a},a4ac:function(e,t,n){},a7f3:function(e,t,n){"use strict";var a=n("ceb8"),i=n.n(a);i.a},a8ba:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.workpaceLoading,expression:"workpaceLoading"}],staticClass:"query",attrs:{direction:"vertical"}},[n("tools"),n("sql-tabs")],1)},i=[],s=n("5530"),r=n("2f62"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.sys.water_mark?n("k-water-mark",{ref:"wm",attrs:{inputText:e.user.name}}):e._e(),n("div",[n("el-header",{staticClass:"query-tool"},[n("div",{staticClass:"query-tool-left"},[n("tool-db",{ref:"toolDbRef"}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{staticClass:"execute-sql",class:{"text-primary":!e.queryDisable},attrs:{text:"执行",icon:"&#xe62d;",disabled:e.queryDisable},on:{click:e.onRun}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{class:{"text-error":e.service.loading},attrs:{text:"中断执行",icon:"&#xe64c;",disabled:!e.service.loading},on:{click:e.onStop}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{class:{"text-primary":!e.queryDisable},attrs:{text:"创建工单",icon:"&#xe6bd;",disabled:e.queryDisable},on:{click:e.addNewWork}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{class:{"text-primary":!e.queryDisable},attrs:{text:"执行计划",icon:"&#xe627;",disabled:e.queryDisable},on:{click:e.onExplain}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{class:{"text-primary":e.hasRunner&&e.hasAsync},attrs:{text:"异步查询",icon:"&#xe747;",disabled:!e.hasRunner||!e.hasAsync},on:{click:e.onAsync}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{class:{"text-primary":e.hasRunner&&e.hasExport},attrs:{text:"异步导出",icon:"&#xe62f;",disabled:!e.hasRunner||!e.hasExport},on:{click:e.onExport}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{staticClass:"sn-font text-primary",attrs:{text:"格式化",icon:"&#xe6d1;"},on:{click:e.onFormatter}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool-favorite"),n("i",{staticClass:"sn-font"},[e._v("")]),n("el-dropdown",{attrs:{placement:"bottom"},on:{command:e.loadFile}},[n("i",{staticClass:"sn-font text-primary cursor-pointer hover-8"},[e._v("  ")]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"utf8",title:"可以打开utf*"}},[e._v("打开文件 - 编码utf-8")]),n("el-dropdown-item",{attrs:{command:"gbk",title:"可以打开gb*"}},[e._v("打开文件 - 编码gbk")]),n("el-dropdown-item",{attrs:{command:"gb2312",divided:""}},[e._v("打开文件 - 编码gb2312")]),n("el-dropdown-item",{attrs:{command:"gb18030"}},[e._v("打开文件 - 编码gb18030")]),n("el-dropdown-item",{attrs:{command:"utf16",divided:""}},[e._v("打开文件 - 编码utf16")]),n("el-dropdown-item",{attrs:{command:"utf32"}},[e._v("打开文件 - 编码utf32")])],1)],1),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{staticClass:"sn-font text-primary",attrs:{text:"保存到本地",icon:"&#xe615;"},on:{click:e.onSaveLocal}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool",{staticClass:"text-primary",attrs:{text:"系统管理",icon:"&#xea2d;"},on:{click:function(t){return e.onJumpManger()}}})],1),n("div",{staticClass:"query-tool-right"},[n("project-card",{on:{selProject:e.selProject}}),n("i",{staticClass:"sn-font"},[e._v("")]),n("tool-setting",{staticClass:"tool-settings"}),n("div",{staticClass:"my"},[n("k-avatar")],1)],1)])],1),n("dialog-work",{ref:"dialogWork"}),n("dialog-new-work",{ref:"dialogNewWork"}),n("dialog-exec",{ref:"dialogExec",on:{runExec:e.onRunExec}}),n("dialog-work-list",{ref:"dialogWorkList"}),n("div",{attrs:{hidden:""}},[n("input",{ref:"openFile",staticClass:"file",attrs:{id:"sql-upload",name:"sql-upload",accept:".sql",type:"file"},on:{change:e.getFile}})])],1)},l=[],c=(n("c975"),n("b0c0"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("1276"),n("2ca0"),n("ddb0"),n("2b3d"),n("96cf"),n("1da1")),u=n("da6f"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tooltip",{attrs:{content:e.text}},[n("el-button",{class:[e.disabled?"disabled-item":"query-tool-item"],attrs:{size:"mini",type:e.type},on:{click:e.onClick}},["iconfont"==e.iconType?n("i",{staticClass:"sn-font",domProps:{innerHTML:e._s(e.icon)}}):"elementui"==e.iconType?n("i",{staticClass:"sn-font sn-font-elementui",class:e.icon}):e._e()])],1)},f=[],h={data:function(){return{}},computed:{},props:{text:{},icon:{},iconType:{default:"iconfont"},type:{default:"text"},disabled:{},event:{}},watch:{},methods:{onClick:function(){if(this.disabled)return!1;this.event?this.$bus.emit(this.event):this.$emit("click")}},components:{},mounted:function(){}},p=h,m=(n("801f"),n("2877")),v=Object(m["a"])(p,d,f,!1,null,"71fbe85a",null),b=v.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-tooltip",{attrs:{content:"收藏代码"}},[n("el-popover",{ref:"fav_popover",attrs:{"popper-class":"favorite"},model:{value:e.is_show,callback:function(t){e.is_show=t},expression:"is_show"}},[n("el-button",{ref:"fav_btn",staticClass:"query-tool-item",attrs:{slot:"reference",type:"text",size:"mini",id:"fav_btn",trigger:"click"},slot:"reference"},[n("i",{staticClass:"sn-font text-primary"},[e._v("")])]),n("el-table",{attrs:{data:e.dataList,width:"100%",height:"350",border:""}},[n("el-table-column",{attrs:{type:"expand",width:"80",property:"content",label:"脚本"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticStyle:{cursor:"pointer"}},[e._v(e._s(t.row.content))])]}}])}),n("el-table-column",{attrs:{width:"300",property:"name",label:"标题"}}),n("el-table-column",{attrs:{width:"200",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("dateTime")(t.row.created_at)))]}}])}),n("el-table-column",{attrs:{width:"200",property:"createdAt",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"tools"},[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return n.stopPropagation(),e.onSelect(t.row)}}},[e._v("使用")]),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){return n.stopPropagation(),e.$refs.favoriteDialog.show(t.row)}}},[e._v("修改")]),n("k-btn-tip",{on:{click:function(n){return e.onDel(t.row)}}},[n("el-button",{staticClass:"text-error",attrs:{type:"text",size:"mini"}},[e._v("删除")])],1)],1)]}}])})],1),n("div",{staticClass:"lists"},[n("div",{staticClass:"add"},[n("el-button",{attrs:{type:"text",size:"small"},on:{click:e.onAdd}},[e._v("收藏该SQL")])],1)])],1)],1),n("dialog-favorite",{ref:"favoriteDialog",on:{refresh:e.refresh}})],1)},g=[],y=n("2ef0"),_=n.n(y),T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"收藏",visible:e.isShow,"custom-class":"dialog-favorite",width:"600px"},on:{"update:visible":function(t){e.isShow=t}}},[n("el-form",{ref:"form",attrs:{model:e.formData,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),n("el-form-item",{attrs:{label:"SQL"}},[n("el-input",{attrs:{type:"textarea",autosize:{maxRow:10}},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("保存")])],1)],1)},R=[],S=n("365c"),I={data:function(){return{isShow:!1,formData:{},treeData:[],treeProps:{label:"name"}}},props:{},watch:{},computed:Object(s["a"])({},Object(r["c"])(["user","sys"])),methods:{show:function(e){this.isShow=!0,this.formData=Object(s["a"])({},e)},hide:function(e){this.isShow=!1},onSubmit:function(){var e=this,t=this.formData;this.sys.encrypt_sql&&(t.content=S["default"].util.aesEncrypted(t.content)),this.$api.favorite.upd(t).then((function(){e.onSuccess("更新成功"),e.hide(),e.$emit("refresh")}))}},mounted:function(){},components:{}},L=I,w=(n("3129"),Object(m["a"])(L,T,R,!1,null,null,null)),O=w.exports,x={data:function(){return{is_show:!1,dataList:[]}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["runner","sys"])),Object(r["b"])(["context"])),{},{db:function(){return this.context.service&&this.context.service.data?{id:this.context.service.data.id}:{}},owner:function(){return this.context.service&&this.context.service.data?{id:this.context.service.data.owner}:{}}}),props:{},watch:{is_show:function(e){console.log("is_show:",e),e&&this.refresh()}},methods:{showSelf:function(e){e&&this.refresh(),this.show=e},deleteRow:function(e){},refresh:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("[tool.favorite methods] refresh: ",e.db,e.owner),t.next=3,e.$api.favorite.all(e.db.id,e.owner.id);case 3:e.dataList=t.sent;case 4:case"end":return t.stop()}}),t)})))()},onSelect:function(e){this.context.service.setSQL(e.content,!0),document.getElementById("fav_btn").click()},onAdd:function(){var e=this;this.$prompt("请输入名称").then((function(t){var n=t.value,a=e.context.service.getFullSQL();if(console.log("value:",n," sql:",a),!n)return"e:名称不能为空！";if(!a)return"e:收藏脚本不能为空！";var i=a;return e.sys.encrypt_sql&&(i=S["default"].util.aesEncrypted(i)),e.$api.favorite.add({name:n,instance:e.db.id,owner:e.owner.id,content:i,pid:0})})).then((function(t){t&&t.startsWith("e:")?e.onError(t.split(":")[1]):(e.onSuccess("收藏成功"),e.refresh())}))},onDel:function(e){var t=this;console.log(e),this.$api.favorite.del(e.id).then((function(){t.onSuccess("删除成功"),t.refresh()}))}},components:{DialogFavorite:O},mounted:function(){this.refresh()}},D=x,A=(n("10cf"),Object(m["a"])(D,E,g,!1,null,null,null)),N=A.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("el-tooltip",{attrs:{content:"设置"}},[n("el-button",{staticClass:"query-tool-item",attrs:{size:"mini",type:"text"},on:{click:e.show}},[n("i",{staticClass:"sn-font",domProps:{innerHTML:e._s("&#xe600;")}})])],1),n("div",{staticStyle:{"padding-right":"24px"}}),n("el-dialog",{attrs:{title:"设置",visible:e.isShow,width:"400px","custom-class":"dialog-setting"},on:{"update:visible":function(t){e.isShow=t}}},[n("el-form",{attrs:{size:"mini","label-suffix":":"}},[n("el-tabs",{attrs:{type:"card"}},[n("el-tab-pane",{attrs:{label:"快捷键"}},[n("el-form-item",{attrs:{label:"查询"}},[n("el-input",{attrs:{model:"item.search",value:"Alt + R"}})],1),n("el-form-item",{attrs:{label:"上一页"}},[n("el-input",{attrs:{model:"item.preSearch",value:"Alt + ,"}})],1),n("el-form-item",{attrs:{label:"下一页"}},[n("el-input",{attrs:{model:"item.nextSearch",value:"Alt + ."}})],1),n("el-form-item",{attrs:{label:"叠加查询"}},[n("el-input",{attrs:{model:"item.appendSearch",value:"Alt + A"}})],1),n("el-form-item",{attrs:{label:"复制窗口"}},[n("el-input",{attrs:{model:"item.newWindow",value:"Alt + T"}})],1),n("el-form-item",{attrs:{label:"关闭窗口"}},[n("el-input",{attrs:{model:"item.closeWindow",value:"Alt + W"}})],1)],1),n("el-tab-pane",{attrs:{label:"编辑器"}},[n("el-form-item",{attrs:{label:"字体大小(px)"}},[n("el-input-number",{attrs:{min:12,max:40},model:{value:e.formData.editFontSize,callback:function(t){e.$set(e.formData,"editFontSize",t)},expression:"formData.editFontSize"}})],1)],1)],1)],1)],1)],1)},k=[],U={data:function(){return{item:{},isShow:!1,formData:{}}},props:{},watch:{formData:{deep:!0,handler:function(){this.onSubmit()}}},computed:Object(s["a"])({},Object(r["c"])(["setting"])),methods:{refresh:function(){this.formData=Object(s["a"])({},this.setting)},show:function(e){this.refresh(),this.isShow=!0},hide:function(e){this.isShow=!1},onSubmit:function(){this.$store.commit("setting",this.formData)}},mounted:function(){},components:{}},P=U,M=(n("41c5"),Object(m["a"])(P,C,k,!1,null,null,null)),j=M.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tool-db-componet"},[n("el-select",{staticClass:"tool-type-select",attrs:{clearable:!!e.type,title:"筛选数据源类型",placeholder:"筛选数据源类型"},on:{change:e.onTypeChange,clear:e.onTypeClear},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[n("el-option",{attrs:{label:"全部",value:null}}),e._l(e.types,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}))],2),n("el-select",{ref:"select",staticClass:"tool-db-select",attrs:{filterable:"","popper-class":e.selectedValue?"tool-db-select2 tool-db-select-1":"tool-db-select2 tool-db-select-0",placeholder:e.filterDataList&&e.filterDataList.length>0?"请选择数据库实例":"无数据",title:e.selectedValue,"filter-method":e.filterDataMethod},on:{"visible-change":e.onVisibelChange},model:{value:e.selectedValue,callback:function(t){e.selectedValue=t},expression:"selectedValue"}},[e._l(e.filterDataList,(function(t){return n("el-option-group",{key:t.id,attrs:{label:t.name,name:t.name,title:"类型"}},[e._l(t.children,(function(t){return e._l(t.children,(function(a){return n("el-option",{key:a.id,attrs:{label:a.label,value:a},nativeOn:{click:function(n){return e.onChangeInstance(t,a)}}},[n("span",{staticStyle:{float:"left"},attrs:{title:"数据库实例"}},[n("el-tag",{staticClass:"auth-tag",class:"tags-"+a.rw,attrs:{title:e.rws[a.rw]+"权限"}},[e._v(" "+e._s(e.rws[a.rw])+" ")]),n("span",{staticStyle:{"margin-left":"5px"},attrs:{title:"数据库："+a.label}},[e._v(" "+e._s(a.label)+" ")])],1),n("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px","padding-left":"10px"},attrs:{title:"数据源"}},[e._v(e._s(t.name))])])}))}))],2)})),n("div",{staticClass:"select-end"},[e._v("- 结束 -")])],2),n("el-tooltip",{attrs:{content:"新建SQL编辑器"}},[n("el-button",{staticClass:"query-tool-item",staticStyle:{"padding-left":"10px"},attrs:{type:"text",size:"mini"},nativeOn:{click:function(t){return e.onNewWindow(t)}}},[n("i",{staticClass:"text-primary sn-font"},[e._v("")])])],1)],1)},F=[],B=(n("99af"),n("4de4"),n("4160"),n("d81d"),n("a9e3"),n("159b"),n("3835")),q=(n("a002"),{data:function(){return{rws:{1:"读",2:"读写",4:"管理"},isShow:!1,types:[],type:null,filterDataList:[],dataList:[],selectedInstance:null,selectedValue:"",selectedSource:null,values:[],cascaderProps:{label:"name",value:"id"}}},computed:Object(s["a"])({},Object(r["c"])(["runList","runActive","project","selecedDB"])),props:{},watch:{dataList:function(e){this.types=e?e.map((function(e){return e.id})):[]},project:function(e){console.log("[tool.db watch] project: ",e),this.auto()},isShow:function(e){var t=this;e&&(this.values=[],this.$nextTick((function(){console.log("获取焦点"),t.$refs.select.focus()})))},selecedDB:function(e){if(console.log("[tool.db watch] selecedDB",e),e){if(this.selectedSource=e.source,this.selectedInstance=e.instance,this.selectedValue="".concat(this.rws[e.instance.rw]," - ").concat(this.selectedInstance.label," - ").concat(e.source.label),this.type=e.source.db_type,0==this.runList.length)return this.$message({message:"新建SQL编辑器",type:"success"}),void this.onNewWindow()}else this.selectedSource=null,this.selectedInstance=null,this.selectedValue="",this.type=null}},methods:{reset:function(){var e=this.getFilterDataList(null,null);this.filterDataList=e,this.type=null},onVisibelChange:function(e){e&&this.filterDataMethod(null)},onTypeChange:function(){},onTypeClear:function(){this.type=null},filterDataMethod:function(e){console.log("沙宣：",this.type,e);var t=this.getFilterDataList(this.type,e);this.filterDataList=t},getFilterDataList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null;if(n=null===e?this.dataList:this.dataList.filter((function(t){return t.id.indexOf(e.toLowerCase())>=0})),null===t)return n;n=JSON.parse(JSON.stringify(n));var a=[],i={};for(var s in n){var r=n[s],o=[];for(var l in r.children){var c=r.children[l],u=[];for(var d in c.children){var f=c.children[d];(""==f.label||f.label.toLowerCase().indexOf(t.toLowerCase())>=0)&&(u.push(f),i[s]=!0)}o.push(c),c.children=u}i[s]&&(a.push(r),r.children=o)}return a},onNext:function(e){if(console.log(e),2==e.length){var t=Object(B["a"])(e,2),n=t[0],a=t[1],i=y["find"](this.dataList,{id:n});y["find"](i.children,{id:a})}},selectItems:function(){var e=Object(B["a"])(this.values,3),t=e[0],n=e[1],a=e[2];if(!a)return[];var i=y["find"](this.dataList,{id:t}),s=y["find"](i&&i.children||[],{id:n}),r=y["find"](s&&s.children||[],{id:a});return[i,s,r]},auto:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a,i,s,r,o,l,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.project&&e.project.id){t.next=3;break}return e.$store.commit("allRun",[]),t.abrupt("return");case 3:return t.next=5,e.$api.db.group_new(e.project.id);case 5:if(n=t.sent,a=n,a[0]){t.next=13;break}return e.$store.commit("allRun",[]),e.dataList=a,e.filterDataList=a,e.$store.commit("dataBaseList",a),t.abrupt("return");case 13:if(a[0].children){t.next=19;break}return e.$store.commit("allRun",[]),e.dataList=a,e.filterDataList=a,e.$store.commit("dataBaseList",a),t.abrupt("return");case 19:if(a[0].children[0].children){t.next=25;break}return e.$store.commit("allRun",[]),e.dataList=a,e.filterDataList=a,e.$store.commit("dataBaseList",a),t.abrupt("return");case 25:return i=a&&a.length>0?a.id:0,console.log(a),s=a&&a.length>0&&a[0].children&&a[0].children.length>0?a[0].children[0].id:0,r=a&&a.length>0&&a[0].children&&a[0].children.length>0&&a[0].children[0].children&&a[0].children[0].children.length>0?a[0].children[0].children[0].id:0,e.values=[i,s,r],console.log("this.values",e.values),o=Number(window.localStorage.getItem("".concat(e.project.id,"_runActive"))||0),console.log("-------------:",o),e.$store.commit("runActive",o),t.next=36,Object(u["b"])("runNames",{max:0});case 36:if(l=t.sent,c=[],!(l&&l.max>=1)){t.next=43;break}return t.next=41,Object(u["b"])("runList",[]);case 41:c=t.sent,c||(c=[]);case 43:console.log("结果：",c),c&&c.length>0?(d={},c.forEach((function(e){console.log("===============d",e),d[e.id]=1,d[e.id+e.name]=e})),a.forEach((function(e){console.log("===============d2",e),e.children&&e.children.length>0&&e.children.forEach((function(e){d[e.db_id]&&e.children&&e.children.length>0&&e.children.forEach((function(e){d[e.db_id+e.label]&&(d[e.db_id+e.label].hasAsynExport=1==e.asyn_export,d[e.db_id+e.label].hasAsynQuery=1==e.asyn_query,d[e.db_id+e.label].hasAsynSql=1==e.asyn_sql,d[e.db_id+e.label].hasRw=2==e.rw)}))}))})),c.map((function(e){return d[e.id+e.name]&&(e=d[e.id+e.name]),e})),e.$store.commit("allRun",c)):e.$store.commit("allRun",[]),e.dataList=a,e.filterDataList=a,e.$store.commit("dataBaseList",a);case 48:case"end":return t.stop()}}),t)})))()},onNewSQL:function(e,t){if(t){console.log("db, owner: ",e,t),this.isShow=!1;e.id,e.dbType;this.$store.commit("addRun",this.createRunConfig(e,t)),this.values=[],this.$bus.emit("new-sql-window")}},onChangeInstance:function(e,t){this.$store.commit("setSelectedDB",{source:e,instance:t});var n=this.runList[this.runActive];if(n){var a=this.createRunConfig(e,t);a.tabId=n.tabId,a.index=n.index,a.tabNo=n.tabNo?n.tabNo:1,console.log("run.tabId&tabNo: ",a.tabId,a.tabNo,this.runActive),console.log("before updateRun2 : ",a,this.runList),this.$store.commit("updateRun2",a),this.$bus.emit("on-selectdb-".concat(a.tabId),a),this.$bus.emit("index-result-change-tab_".concat(a.tabId),"result"),console.log("[tool.db methods] onChangeInstance 提交 on-selectdb-".concat(a.tabId," - ").concat(a.name),a),this.$bus.emit("".concat(a.tabId,"-card-db-refresh"),a)}else console.log("[tool.db methods] onChangeInstance() 当前run为空",this.runActive,this.runList)},createRunConfig:function(e,t){return console.log("in createRunConfig",e,t),{id:e.db_id,instance_id:t.id,db:e.name,name:t.label,auto_audit:e.auto_audit,dbType:e.db_type,script:"",rw:t.rw,owner:t.label,hasAsynExport:1==t.asyn_export,hasAsynQuery:1==t.asyn_query,hasAsynSql:1==t.asyn_sql,hasRw:2==t.rw}},onNewWindow:function(){this.selectedInstance?this.onNewSQL(this.selectedSource,this.selectedInstance):this.$message({message:"请选择数据库实例",type:"warning"})}},components:{},mounted:function(){0}}),H=q,V=(n("67fc"),Object(m["a"])(H,$,F,!1,null,null,null)),W=V.exports,G=n("c1df"),X=n.n(G),Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-drawer",{staticClass:"workList",attrs:{visible:e.isShow,direction:"ttb",size:"100%"},on:{"update:visible":function(t){e.isShow=t}}},[n("k-search-table",{ref:"st",attrs:{url:"/api/my/work/list",manual:!0,"search-data":e.searchAdvance},on:{reset:e.resetSearch}},[n("template",{slot:"searchs"},[n("div",{staticStyle:{"margin-left":"15px"}},[n("el-form-item",{attrs:{label:"时间范围:"}},[n("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"],"picker-options":e.$constant.pickOptions},model:{value:e.search.dateRange,callback:function(t){e.$set(e.search,"dateRange",t)},expression:"search.dateRange"}})],1),n("el-form-item",{attrs:{label:"工单名称",prop:"name",size:"mini"}},[n("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1)],1)]),n("template",{slot:"buttons"}),n("template",{slot:"columns"},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(e._s(t.row.sql))])]}}])}),n("el-table-column",{attrs:{label:"工单名称",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return e.goWorkDetail(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),n("el-table-column",{attrs:{label:"工单类型",prop:"type"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.type?n("el-tag",{attrs:{type:"danger"}},[e._v("DDL")]):1==t.row.type?n("el-tag",{attrs:{type:"success"}},[e._v("DML")]):n("el-tag",[e._v("未知")])]}}])}),n("el-table-column",{attrs:{label:"申请时间",prop:"created_at"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("dateTime")(t.row.created_at)))]}}])}),n("el-table-column",{attrs:{label:"数据源类型",prop:"db_type"}}),n("el-table-column",{attrs:{label:"数据源/数据库",prop:"db_name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.db_name)+"/"+e._s(t.row.owner))]}}])}),n("el-table-column",{attrs:{label:"工单状态",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.showStatus(t.row.status))+" ")]}}])}),n("el-table-column",{attrs:{label:"是否备份"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.back_up?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(n){return e.goWorkDetail(t.row)}}},[e._v("详情 ")]),6==t.row.status&&1==t.row.back_up?n("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(n){return e.goWorkBackUp(t.row)}}},[e._v(" 备份 ")]):e._e()]}}])})],1)],2),n("dialog-backup",{ref:"backupDialog",on:{hide:e.hide}}),n("dialog-detail",{ref:"detailDialog",on:{refresh:e.refresh}})],1)},z=[],Q=(n("841c"),n("c58e")),K=n("d170"),J={data:function(){return{isShow:!1,search2:{db_type:null},dateRange:[X()().startOf("d").toDate(),X()().endOf("d").toDate()],search:{db_type:null,project:0,name:""},status_types:[{k:"0",v:"全部"},{k:"1",v:"待审核"},{k:"2",v:"已通过"},{k:"3",v:"未通过"}]}},computed:Object(s["a"])({searchAdvance:function(){var e=Object(s["a"])({},this.search);return e.dateRange&&(e.start=X()(e.dateRange[0]).format("YYYY-MM-DD HH:mm:ss"),e.end=X()(e.dateRange[1]).format("YYYY-MM-DD HH:mm:ss"),delete e.dateRange),e}},Object(r["c"])(["runner","project"])),props:{},watch:{},methods:{goWorkBackUp:function(e){this.$refs.backupDialog.show(e.id,!1)},goWorkDetail:function(e){this.$refs.detailDialog.show(e.id)},onCancel:function(e){var t=this;this.$api.work.cancel({id:e.id,cancel_remark:e.cancel_remark,flag:2}).then((function(e){t.onSuccess("取消成功"),t.init()}),(function(e){var n="参数错误！";"301"!=e.result&&(n=e.data),t.onError(n)}))},showStatus:function(e){return this.$api.work.showStatus(e)},show:function(){var e=this;console.log("==================================== start"),console.dir(this.runner),console.log("==================================== end"),this.isShow=!0,this.$nextTick((function(){e.refresh()}))},hide:function(){this.drawer=!1},refresh:function(){this.project?this.search.project=this.project.id:this.search.project=0},resetSearch:function(){console.log("========resetSearch========="),this.search={project:this.project.id}},reload:function(){this.$refs.st.reload()},onSync:function(e){var t=this;2==e.con_state?this.$api.db.refresh(e.id).then((function(e){t.onSuccess(e),t.reload()})):this.onSuccess("请修复连接后再进行操作！")},onReset:function(e){var t=this;this.$api.db.reset(e.id).then((function(){t.onSuccess("重置成功"),t.reload()}),(function(e){}))},onDel:function(e){var t=this;this.$api.db.delete(e.id).then((function(){t.onSuccess("删除成功"),t.reload()}))}},components:{DialogDetail:Q["a"],DialogBackup:K["a"]},mounted:function(){}},Z=J,ee=(n("8101"),Object(m["a"])(Z,Y,z,!1,null,"1b81c981",null)),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dialog-work"},[n("el-dialog",{staticClass:"dialog-work-dialog",attrs:{title:"提交工单",visible:e.isShow,fullscreen:"",width:"100%","before-close":e.hide},on:{"update:visible":function(t){e.isShow=t}}},[n("el-form",{ref:"form",staticClass:"dialog-work-form",attrs:{model:e.formData,"label-width":"120px","label-suffix":":",rules:e.formRule}},[n("div",{staticClass:"left-section"},[n("monaco-lite",{ref:"monacoLite",staticClass:"work-sql",attrs:{"sql-data":e.sql},on:{change:e.monacoListChangeHandler}})],1),n("div",{staticClass:"right-section"},[n("div",{staticClass:"right-section-top"},[n("el-form-item",{staticClass:"project-name",attrs:{label:"项目"}},[e._v(" "+e._s(e.project.name)+" ")]),n("el-form-item",{attrs:{label:"导入文件"}},[n("el-input",{attrs:{readonly:!0,placeholder:"仅支持5M内的SQL文件"}},[n("template",{slot:"append"},[n("span",{staticClass:"open-file",on:{click:e.loadFile}},[e._v("打开文件")])])],2)],1),n("el-form-item",{staticClass:"work-name",attrs:{label:"工单名称",prop:"name"}},[n("el-input",{attrs:{type:"text",placeholder:"请输入工单名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),n("el-form-item",{attrs:{label:"数据库",prop:"db_id"}},[n("select-database",{ref:"selectDatabse",on:{"select-change":e.onSelectDatabseChangeHandler}})],1),n("el-form-item",{attrs:{label:"类型",prop:"type"}},[e.has_au?n("span",[e._v(e._s(e.currentSqlTypeText))]):e.has_au?n("el-tag",[e._v("未知")]):n("el-tag",[e._v("未审计")])],1),e.isAuditDQL?[n("el-form-item",{attrs:{label:"查询条数"}},[n("el-input-number",{attrs:{"controls-position":"right",min:1},model:{value:e.formData.fetch_size,callback:function(t){e.$set(e.formData,"fetch_size",t)},expression:"formData.fetch_size"}})],1),n("el-form-item",{attrs:{label:"查询类型"}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:!e.sqlTypeToolTip,content:e.sqlTypeToolTip,placement:"top"}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:e.formData2TypeHandler},model:{value:e.formData2.type,callback:function(t){e.$set(e.formData2,"type",t)},expression:"formData2.type"}},[n("el-option",{attrs:{title:e.sqlTypeToolTips[5],label:"快照查询",value:"5"}}),n("el-option",{attrs:{title:e.sqlTypeToolTips[3],label:"在线查询",value:"3"}}),n("el-option",{attrs:{title:e.sqlTypeToolTips[4],label:"文件导出",value:"4"}})],1)],1)],1),4==e.formData2.type?n("el-form-item",{attrs:{label:"导出方式"}},[n("el-select",{attrs:{placeholder:"文件类型"},model:{value:e.formData.file_type,callback:function(t){e.$set(e.formData,"file_type",t)},expression:"formData.file_type"}},e._l(e.fileTypes,(function(e,t){return n("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1):e._e()]:e._e(),e.isAuditDQL?n("el-form-item",{attrs:{label:"忽略脱敏的字段"}},[n("el-tooltip",{attrs:{content:"越过脱敏策略，查询源数据"}},[n("el-input",{attrs:{placeholder:"请使用 , 号(英文逗号)分割"},model:{value:e.formData.no_mask_field,callback:function(t){e.$set(e.formData,"no_mask_field",t)},expression:"formData.no_mask_field"}})],1)],1):e._e(),n("el-form-item",{attrs:{label:"自动审计"}},[e.has_au?99==e.formData.sql_type?n("el-tag",{attrs:{type:"warning"}},[e._v("不支持审计")]):0==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"success"}},[e._v("通过")]):1==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"warning"}},[e._v("警告")]):2==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"danger"}},[e._v("错误")]):1==e.level&&"7"==e.stage_status?n("el-tag",{attrs:{type:"warning"}},[e._v("不支持审计")]):n("el-tag",[e._v("未知")]):n("el-tag",[e._v("未审计")])],1),"0"==e.stage_status?n("el-form-item",{attrs:{label:"预估影响行数"}},[n("h3",{staticStyle:{color:"red","fond-weight":"blod"}},[e._v(e._s(e.affected_rows))])]):e._e(),n("el-form-item",{attrs:{label:"审计日志"}},[n("el-link",{on:{click:e.showLog}},[e._v("查看")])],1),n("el-form-item",{attrs:{label:"审批流程"}},[n("el-tag",[e._v(e._s(e.project.sql_audit_auth_str))])],1),n("el-form-item",{attrs:{label:"执行时间"}},[n("el-checkbox",{attrs:{disabled:e.isAuditDQL,"true-label":1,"false-label":2},on:{change:e.onExecFlagHandler},model:{value:e.formData.exec_flag,callback:function(t){e.$set(e.formData,"exec_flag",t)},expression:"formData.exec_flag"}},[e._v("不限 ")])],1),2==e.formData.exec_flag?n("el-form-item",{staticClass:"work-exec-time",attrs:{label:"时间范围",prop:"execTimes"}},[n("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.formData.execTimes,callback:function(t){e.$set(e.formData,"execTimes",t)},expression:"formData.execTimes"}})],1):e._e(),n("el-form-item",{attrs:{label:"工单说明",prop:"mark"}},[n("el-input",{attrs:{rows:4,type:"textarea",placeholder:"请输入工单说明"},model:{value:e.formData.mark,callback:function(t){e.$set(e.formData,"mark",t)},expression:"formData.mark"}})],1)],2),n("div",{staticClass:"dialog-footer"},[n("el-button",{on:{click:e.hide}},[e._v("取 消")]),e.has_au?n("el-button",{attrs:{type:"success",disabled:e.disabled},on:{click:e.onSubmit}},[e._v("提 交")]):n("el-button",{attrs:{type:"danger"},on:{click:e.handAudit}},[e._v("手 动 审 计")])],1)])]),n("dialog-audit-log",{ref:"sqlAuditLog"})],1),n("div",{attrs:{hidden:""}},[n("input",{ref:"openFile",staticClass:"file",attrs:{id:"sql-upload",name:"sql-upload",accept:".sql",type:"file"},on:{change:e.getFile}})])],1)},ae=[],ie=n("0107"),se=n("4e36"),re=n("55ce"),oe=n("e31c"),le=n("ff60"),ce={computed:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["project","sys","service","sqlTypes","fileTypes"])),{},{isAuditDQL:function(){var e=this.has_au&&(3==this.formData.type||4==this.formData.type||5==this.formData.type);return e&&(this.formData.exec_flag=2),e},sqlTypeToolTip:function(){var e=this.sqlTypeToolTips[this.formData.type];return e||!1},currentSqlTypeText:function(){return this.sqlTypes[this.formData.type]}}),data:function(){return{sqlTypeToolTips:{3:"在线查询：审批通过后，在工单执行时间范围内可多次查询实时数据",4:"文件导出：工单执行时根据查询结果生成文件，在工单执行时间范围内可重复下载",5:"查询快照：工单执行时根据结果生成数据快照，在工单执行时间范围内可多次查询数据快照"},has_au:!1,activeName:"工单详情",sql:"",workType:"auto",disabled:!1,disabled_backup:!0,typeText:null,role:{},level:0,affected_rows:0,stage_status:"",execTimes:[],isShow:!1,config:{lang:"sql"},data:{},db:{can_backup:1},formData2:{type:"3"},formData:this.resetFormData(),formRule:{execTimes:[{required:!0,message:"请选择时间范围"}],mark:[{required:!0,message:"请输入工单说明"}],name:[{required:!0,message:"请输入工单名称"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],audit_id:[{required:!0,message:"请选择审批人"}]},roleList:[]}},components:{DialogAuditLog:ie["a"],MonacoLite:se["a"],"select-database":re["a"]},methods:{loadFile:function(e){console.log("打开文件：",e),this.openFileEncode=e,this.$refs.openFile.click()},addContent:function(e){this.$refs.monacoLite.setSql(e)},getFile:function(e){if(window.FileReader){var t=e.target.files[0],n=t.size;if(n>1048576)this.$message({showClose:!0,type:"error",message:"打开失败，文件过大！（max=1M）"});else if(-1!=t.name.indexOf(".sql")){var a=new FileReader,i=this;a.onload=function(){i.addContent(this.result),e.target.value=""},a.readAsText(t,this.openFileEncode)}else this.$message.error("不支持该类型的文件上传")}},onExecFlagHandler:function(e){console.log(e),1==e&&(this.execTimes=[])},formData2TypeHandler:function(e){this.formData.exec_flag=3==e?2:1,this.formData.type=e},onSelectDatabseChangeHandler:function(e){var t=e.source,n=e.instance;console.log("触发数据库... ..."),this.formData.dbType=n.db_type,this.formData.db_id=n.db_id,this.formData.owner=n.label,this.formData.db=t.label,this.has_au=!1},monacoListChangeHandler:function(e){this.formData.sql=e,this.has_au=!1,console.log("触发，monacoListChangeHandler",this.formData.sql)},handAudit:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.formData.sql){t.next=3;break}return e.$message.error("审计内容不可为空，请输入SQL"),t.abrupt("return");case 3:return console.log("手动审计... ..",e.formData.sql),t.next=6,e.onAudit(e.formData.sql);case 6:n=t.sent,a=Object(s["a"])(Object(s["a"])({},e.service.data),{},{script:e.formData.sql}),e.show(a,n,"hand-audit");case 9:case"end":return t.stop()}}),t)})))()},onAudit:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return delete t.service.data.async,t.service.encrypt_sql=t.sys.encrypt_sql,t.service.onReset(),a=null,n.prev=4,i=Object(s["a"])(Object(s["a"])({},t.service.data),{},{sql:e}),i.project=t.project.id,i.iid=i.db_id,i.db_type=i.dbType,i.token=Object(le["a"])(),n.next=12,t.$api.work.work_audit(i);case 12:a=n.sent,n.next=19;break;case 15:n.prev=15,n.t0=n["catch"](4),console.log("dialg.work ==========   e:",n.t0),a=n.t0;case 19:return n.abrupt("return",a);case 20:case"end":return n.stop()}}),n,null,[[4,15]])})))()},show:function(e,t,n){var a=this,i=Object(s["a"])({},this.formData);t?(console.log("au: ",t),12==t.sql_type||13==t.sql_type||14==t.sql_type?i.type=1:15==t.sql_type?i.type=2:11==t.sql_type?i.type=3:i.type=9):t={},this.has_au=!0,this.data=e,i.id=t.token||Object(le["a"])(),i.exec_flag=1,i.sql_type=t.sql_type||99,i.exec_start=null,i.exec_end=null,"hand-audit"!=n&&(e.script=oe["a"].removeSoftRoute(e.script),this.sql=e.script,console.log("data.script: ",e.script),i.sql=e.script,i.mark="",i.name=""),i.dbType=t.db_type||e.dbType,i.db_id=t.db_id||e.id,i.owner=t.owner||e.owner,i.audit_id=0,this.level=t.level,this.affected_rows=t.affected_rows,this.stage_status=t.stage_status,this.formData=Object(s["a"])({},i),this.isShow=!0,this.$nextTick((function(){a.$refs.monacoLite&&(a.$refs.monacoLite.setCount(0),a.$refs.monacoLite.init(a.formData.sql),a.$refs.selectDatabse.init({db_id:a.formData.db_id,owner:a.formData.owner},!0))}))},tabHandleClick:function(e,t){console.log(e,t)},showLog:function(){this.$refs.sqlAuditLog.show(this.formData.id)},resetFormData:function(){return{id:"",exec_flag:1,exec_start:null,exec_end:null,source_type:"none",source_id:"none",sql:"",type:"",no_mask_field:"",fetch_size:500,file_type:"5",name:"",mark:"",audit_id:0,back_up:0,execTimes:[]}},hide:function(e){this.disabled=!1,this.isShow=!1,this.has_au=!1,this.level=0,this.affected_rows=0,this.formData=this.resetFormData(),this.formData2.type="3",this.$refs.monacoLite.setCount(0)},editorInit:function(){n("2099"),n("8882"),n("8ef6"),n("1d29")},onSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(t){var n=Object(s["a"])({},e.formData);if(delete n.execTimes,2==n.exec_flag){if(e.formData.execTimes<2)return void e.onError("时间范围出错，请重新选择！！");n.exec_start=X()(e.formData.execTimes[0]).format("YYYY-MM-DD HH:mm:ss"),n.exec_end=X()(e.formData.execTimes[1]).format("YYYY-MM-DD HH:mm:ss")}n.project=e.project.id,e.$api.work.add(n).then((function(){e.onSuccess("提交成功"),e.hide(),e.$emit("refresh")}))}}))}},mounted:function(){}},ue=ce,de=(n("064e"),Object(m["a"])(ue,ne,ae,!1,null,null,null)),fe=de.exports,he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"dialog-new-work",attrs:{title:"提交工单",visible:e.isShow,fullscreen:"",width:"100%","before-close":e.hide},on:{"update:visible":function(t){e.isShow=t},opened:e.onOpened,close:e.onClose}},[n("new-work",{ref:"newWokRef",on:{submit:e.onSubmit}})],1)},pe=[],me=n("8f1c"),ve={components:{NewWork:me["default"]},data:function(){return{isShow:!1,workPageData:null,tempData:{}}},methods:{onSubmit:function(e){console.log("提交工单结果：",e),e&&(this.hide(),this.$emit("action","submit"))},show:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$api.db.group_noauth(e.project.id);case 2:a=n.sent,e.dataBaseList=a,t.isShow=!0,t.tempData=e,console.log("xxxdata:",e);case 7:case"end":return n.stop()}}),n)})))()},onOpened:function(){var e=this;this.$nextTick((function(){e.$refs.newWokRef.init(e.tempData)}))},onClose:function(){this.$emit("action","close")},hide:function(){this.$refs.newWokRef.hide(),this.workPageData=null,this.isShow=!1,this.tempData={}}}},be=ve,Ee=(n("4755"),Object(m["a"])(be,he,pe,!1,null,null,null)),ge=Ee.exports,ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dialog-exec-pages",attrs:{title:"操作确认",visible:e.isShow,width:"300px;","before-close":e.hide,"append-to-body":!0},on:{"update:visible":function(t){e.isShow=t},opened:e.onOpened,close:e.onClose}},[n("monaco-lite",{ref:"monacoLite",staticClass:"exec-sql",attrs:{config:{readOnly:!0}}}),n("el-divider"),n("b",[e._v("基本信息：")]),n("el-form",{ref:"form",attrs:{model:e.formData,"label-width":"120px","label-suffix":":",rules:e.formRule}},[n("el-form-item",{staticStyle:{color:"#ff0000","font-weight":"bold"},attrs:{label:"类型"}},[e._v(" "+e._s(e.type)+" ")]),n("el-form-item",{attrs:{label:"数据库",prop:"db_id"}},[e._v(" ["+e._s(e.data.dbType)+"] "+e._s(e.data.db)+"/"+e._s(e.data.owner)+" ")]),n("el-form-item",{attrs:{label:"自动审计"}},[0==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"success"}},[e._v("通过")]):1==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"warning"}},[e._v("警告")]):2==e.level&&"0"==e.stage_status?n("el-tag",{attrs:{type:"danger"}},[e._v("错误")]):1==e.level&&"7"==e.stage_status?n("el-tag",{attrs:{type:"warning"}},[e._v("不支持审计")]):n("el-tag",[e._v("未知")])],1),"0"==e.stage_status?n("el-form-item",{attrs:{label:"预估影响行数"}},[n("h3",{staticStyle:{color:"red","fond-weight":"blod"}},[e._v(e._s(e.affected_rows))])]):e._e()],1),e.confirmMessage?[n("el-divider"),n("el-checkbox",{staticStyle:{color:"#ff0000","font-weight":"bold"},model:{value:e.checkedConfirmMessage,callback:function(t){e.checkedConfirmMessage=t},expression:"checkedConfirmMessage"}},[e._v(" "+e._s(e.confirmMessage)+" ")])]:e._e(),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{type:"success",disabled:e.disabled||!e.checkedConfirmMessage},on:{click:e.onSubmit}},[e._v("执行")])],1),n("dialog-audit-log",{ref:"sqlAuditLog"})],2)},_e=[],Te={data:function(){return{confirmMessage:null,checkedConfirmMessage:!1,activeName:"基本信息",showSql:!1,is_admin:!1,disabled:!1,disabled_backup:!0,sqlAuditData:[],type:null,role:{},level:0,affected_rows:0,stage_status:"",execTimes:[],isShow:!1,config:{lang:"sql"},data:{},db:{can_backup:1},au:{},runParams:{},formData:{id:"",exec_flag:1,exec_start:null,exec_end:null,source_type:"none",source_id:"none",sql:"",type:0,name:"",mark:"",audit_id:0,back_up:0},formRule:{name:[{required:!0,message:"请输入工单名称"}],audit_id:[{required:!0,message:"请选择审批人"}]},roleList:[]}},components:{DialogAuditLog:ie["a"],MonacoLite:se["a"]},props:{},watch:{},computed:Object(s["a"])({},Object(r["c"])(["project"])),mounted:function(){},methods:{showLog:function(){this.$refs.sqlAuditLog.show(this.formData.id)},show:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.confirmMessage=a,this.checkedConfirmMessage=!a,12==t.sql_type||13==t.sql_type||14==t.sql_type?(this.formData.type=1,this.type="DML"):15==t.sql_type&&(this.formData.type=2,this.type="DDL"),this.runParams=n,this.au=t,this.data=e,this.formData.id=t.token,this.formData.exec_flag=1,this.formData.sql_type=t.sql_type,this.formData.exec_start=null,this.formData.exec_end=null,this.formData.sql=e.script||e.sql,this.formData.db_id=e.id,this.formData.owner=e.owner,this.formData.mark="",this.formData.name="",this.formData.audit_id=0,this.level=t.level,this.affected_rows=t.affected_rows,this.stage_status=t.stage_status,this.showSql=!0,this.isShow=!0},onOpened:function(){this.$refs.monacoLite.setSql(this.formData.sql||"-- 未获取到SQL"),this.$bus.emit("workpace-loading",!1)},onClose:function(){this.activeName="基本信息",this.confirmMessage=null,this.checkedConfirmMessage=!1},hide:function(e){this.$emit("action",{type:"close",submit:"submit"==e}),this.disabled=!1,this.au={},this.data={},this.isShow=!1,this.formData={sql:""},this.showSql=!1,this.workData=[]},onSubmit:function(){this.disabled=!this.disabled,this.$emit("runExec",{au:this.au,params:this.runParams}),this.hide("submit")}}},Re=Te,Se=(n("c0b5"),Object(m["a"])(Re,ye,_e,!1,null,null,null)),Ie=Se.exports,Le={components:{Tool:b,ToolFavorite:N,ToolDb:W,DialogWork:fe,DialogNewWork:ge,DialogWorkList:te,ToolSetting:j,DialogExec:Ie},data:function(){return{day:this.getDay(),openFileEncode:"utf8"}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["selecedDB","dataBaseList","isMaxLine","user","project","runner","db","owner","sys","exportCount","service"])),Object(r["b"])(["run"])),{},{queryDisable:function(){var e=!this.hasRunner||(!this.service.data||this.service.loading);return e},hasRunner:function(){return Boolean(this.service)},hasAsync:function(){return this.service&&this.service.data?this.sys.asyn_query&&this.service.data.hasAsynQuery:this.sys.asyn_query},hasExport:function(){return this.service.data?this.sys.asyn_export&&this.service.data.hasAsynExport:this.sys.asyn_export}}),methods:{selProject:function(e){this.$refs.toolDbRef.reset(),this.$store.commit("project",e)},addContent:function(e){this.service.setSQL(e,!0)},loadFile:function(e){console.log("打开文件：",e),this.openFileEncode=e,this.$refs.openFile.click()},getFile:function(e){if(window.FileReader){var t=e.target.files[0],n=t.size;if(n>1048576)this.$message({showClose:!0,type:"error",message:"打开失败，文件过大！（max=1M）"});else if(-1!=t.name.indexOf(".sql")){var a=new FileReader,i=this;a.onload=function(){i.addContent(this.result),e.target.value=""},a.readAsText(t,this.openFileEncode)}else this.$message.error("不支持该类型的文件上传")}},getDay:function(){var e=X()(new Date).format("YYYY-MM-DD");return e},showWorks:function(){console.log("show works;"),this.$refs.dialogWorkList.show()},onExplain:function(){delete this.service.data.async,this.service.onReset(),this.service.explain=!0,this.service.onRun(!1)},onWork:function(e,t){var n={data:e,project:this.project,dataBaseList:this.dataBaseList,selecedDB:this.selecedDB};this.$refs.dialogNewWork.show(n,t.token)},addNewWork:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.service.getSelectSQL(),a=Object(s["a"])(Object(s["a"])({},e.service.data),{},{script:n}),i={data:a,project:e.project,dataBaseList:e.dataBaseList,selecedDB:e.selecedDB},e.$refs.dialogNewWork.show(i);case 4:case"end":return t.stop()}}),t)})))()},addWorkNewPage:function(){var e=Date.now(),t=this.service.getSQL();Object(u["g"])("work-sql-".concat(e),{data:Object(s["a"])(Object(s["a"])({},this.service.data),{},{script:t}),project:this.project,dataBaseList:this.dataBaseList,selecedDB:this.selecedDB});var n=this.$router.resolve({path:"/query/new-work",query:{time:e}});window.open(n.href,"_blank")},onExec:function(e,t,n){this.$refs.dialogExec.show(e,t,n)},onAudit2:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return delete e.service.data.async,e.service.encrypt_sql=e.sys.encrypt_sql,e.service.onReset(),n=null,t.prev=4,t.next=7,e.service.onAudit();case 7:n=t.sent,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](4),console.log("top/index onAudit2==========   e:",t.t0),n=t.t0;case 14:return t.abrupt("return",n);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})))()},onReusltRunsql:function(e){console.log("自动执行SQL：",e),this.onRun({single_script:e.sql})},onRun:function(){var e=arguments,t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a,i,r,o,l,c,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:{},t.service.clean(!0),delete t.service.data.async,t.service.encrypt_sql=t.sys.encrypt_sql,i={id:t.run.id,db_id:t.run.id,owner:t.run.owner,db:t.run.db,dbType:t.run.dbType},t.service.assignData(i),console.log("执行SQL：",t.service,t.run),t.run&&t.$bus.emit("index-result-change-tab_".concat(t.run.tabId),"result"),r=null,n.prev=9,n.next=12,t.service.onCheckAudit(a);case 12:r=n.sent,console.log("审计结果：",r),n.next=20;break;case 16:n.prev=16,n.t0=n["catch"](9),console.log("top/index onRun ==========   e:",n.t0),r=n.t0;case 20:r.error?(t.service.body={},t.service.head=[],t.service.affected_rows=0,t.service.result=!1,t.service.resultText="执行错误:"+r.error):(o=a.single_script||t.service.getSQL(),l=Object(s["a"])(Object(s["a"])({},t.service.data),{},{script:o}),c=r?r.atk:"",console.info("[top/index.vue mothods] onRun() : ",r),"DQL"==r.type||"标准"==r.mode||"在线查询-工单"==r.mode?t.service.onRunNormal(!1,c,a):"快照查询-工单"==r.mode||"查询-异步"==r.mode?(u={async:r.id},t.service.onRunAsyncData(!1,c,u)):r.audit_work?t.$confirm("工单已开启, 是否提交工单?","提示",{confirmButtonText:"提交工单",cancelButtonText:"取消",type:"warning"}).then((function(){t.onWork(l,r)})):t.onExec(l,r,a));case 21:case"end":return n.stop()}}),n,null,[[9,16]])})))()},onRunExec:function(e){var t=e.au,n=e.params;console.log("top/index onRunExec(): ",t);var a=t?t.atk:"";this.service.onRunNormal(!1,a,n)},onAudit:function(){delete this.service.data.async,this.service.encrypt_sql=this.sys.encrypt_sql,this.service.onReset(),this.service.onAudit();var e=this.service.getSQL();Object(s["a"])(Object(s["a"])({},this.service.data),{},{sql:e})},onStop:function(){this.service.onStop()},onAsync:function(){this.service.encrypt_sql=this.sys.encrypt_sql,this.service.onAsync()},onExport:function(){this.service.encrypt_sql=this.sys.encrypt_sql,this.service.onExport()},onExportResult:function(){this.service.onExportResult()},onFormatter:function(){this.service.onFormatter()},onSaveLocal:function(){var e=this;this.$prompt("保存到本地 - 请输入文件名称").then((function(t){var n=t.value,a=e.service.getSQL();return console.log("value:",n," sql:",a),n?a?{sql:a,name:n}:"e:收藏脚本不能为空！":"e:名称不能为空！"})).then((function(t){if(t&&t.sql&&t.name){var n=new Blob([t.sql],{type:"application/octet-stream"}),a=window.URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download="".concat(t.name,".sql"),i.click(),window.URL.revokeObjectURL(n)}else t&&t.startsWith("e:")?e.onError(t.split(":")[1]):e.onError("保存失败！")}))},onFavorite:function(){this.service.onFavorite()},onJumpManger:function(){this.$router.replace("/project_home")}},mounted:function(){this.$bus.on("saveToLocalFile",this.onSaveLocal),this.$bus.on("index-result-run",this.onReusltRunsql)}},we=Le,Oe=(n("d088"),n("4d0b"),Object(m["a"])(we,o,l,!1,null,"0cd31f52",null)),xe=Oe.exports,De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"hotkey",rawName:"v-hotkey",value:e.keymap,expression:"keymap"}],staticClass:"sql-query-tabs"},[n("el-tabs",{attrs:{type:"border-card"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.runList,(function(t,a){return n("el-tab-pane",{key:t.tabId,attrs:{name:a+""}},[n("div",{staticClass:"tabs-xxxx tab-label",attrs:{slot:"label"},on:{dblclick:function(n){return e.onDblTabClick(t.tabId)}},slot:"label"},[n("span",{ref:"tabname-"+t.tabId,refInFor:!0,staticClass:"xxxxxx",staticStyle:{"user-select":"none"},on:{click:function(t){return e.onTabClick(a)}}},[e._v(e._s(e.getTabName(t)))]),n("i",{staticClass:"sn-font rm",on:{click:function(n){return n.stopPropagation(),e.onRemove(t.tabId,a)}}},[e._v("")])]),n("sql-query-item",{ref:"queryItem"+a,refInFor:!0,attrs:{data:t,"tab-id":t.tabId,"data-index":a}})],1)})),1),n("el-dialog",{attrs:{title:"修改标签页名称",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-input",{attrs:{placeholder:"请输入标签页名称",clearable:""},model:{value:e.workspaceTabParams.runName,callback:function(t){e.$set(e.workspaceTabParams,"runName",t)},expression:"workspaceTabParams.runName"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.savaTabName}},[e._v("保 存")])],1)],1)],1)},Ae=[],Ne=n("ade3"),Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("split-pane",{staticClass:"sql-item",attrs:{"min-percent":5,"default-percent":e.defaultPercent,"max-percent":30,split:"vertical"}},[n("template",{slot:"paneL"},[n("sql-card-db",{key:e.tabId,ref:"left-"+e.tabId,attrs:{"tab-id":e.tabId,hasAsynSql:e.hasSql}})],1),n("template",{slot:"paneR"},[n("div",{staticClass:"right"},[n("sql-item",{key:e.tabId,attrs:{"run-tab-id":e.tabId}})],1)])],2)},ke=[],Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sql-query-card-db"},[n("k-cardx",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{head:"数据信息",db_type:e.currentRun.dbType,"is-filter":!0,"is-types":"redis"!=e.currentRun.dbType,"tab-id":e.tabId},on:{sel:e.selItem,refresh:e.refreshHandle},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[n("div",{staticClass:"keyword-info"},[e._v(" 列表数："+e._s(e.pages.nodeLength)+"/"+e._s(0==e.pages.nodeLength?0:e.pages.total)+" ")]),e.filterDataList&&e.filterDataList.length>0?n("virtual-list",{ref:"vlist",staticClass:"vlist",attrs:{"data-key":"id","estimate-size":e.itemHeight,keeps:e.vlistKeeps,"data-sources":e.filterDataList,"data-component":e.itemTempalte,"extra-props":{selectedItemId:e.selectedItemId,currentRun:e.currentRun,type:e.type,hasAsynSql:e.hasAsynSql}},on:{tobottom:e.onScrollToBottom}},[n("div",{staticClass:"loading-spinner no-user-select",attrs:{slot:"footer"},slot:"footer"},[e._v("结束.")])]):n("div",{ref:"vlist",staticClass:"empty"},[e._v(" 空数据 ")])],1),n("vue-context-menu",{ref:"rightMenu",staticClass:"right-menu",attrs:{target:e.contextMenuTarget,show:e.contextMenuVisible},on:{"update:show":e.onRightHandle}},[e._l(e.menuList,(function(t,a){return["redis"!=e.currentRun.dbType?n("a",{key:a,attrs:{href:"javascript:void(0);"},on:{click:function(n){return e.menuClickHandle(t.value)}}},[e._v(" "+e._s(t.label)+" ")]):e._e()]}))],2),n("dialog-table",{ref:"tableDialog"}),n("dialog-redis-info",{ref:"redisInfoDialog"}),n("dialog-table-edit",{ref:"tableDialogEdit"}),n("dialog-sql-export",{ref:"exportSqlDialog"})],1)},Pe=[],Me=(n("a15b"),n("a434"),n("498a"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.table_name+" 表定义",visible:e.isShow,width:"1024px"},on:{"update:visible":function(t){e.isShow=t},close:e.onClose}},[n("el-tabs",{staticClass:"table-info",attrs:{type:"border-card",lazy:"true"},on:{"tab-click":e.getTableInfo},model:{value:e.cur_name,callback:function(t){e.cur_name=t},expression:"cur_name"}},[n("el-tab-pane",{attrs:{label:"字段定义",name:"struct"}},[n("el-table",{attrs:{size:"mini",data:e.data.struct}},e._l(e.struct,(function(e,t,a){return n("el-table-column",{key:a,attrs:{label:t,prop:t}})})),1)],1),e.data.indexs?n("el-tab-pane",{attrs:{label:"索引",name:"indexs"}},[n("el-table",{attrs:{size:"mini",data:e.data.indexs}},e._l(e.indexs,(function(e,t,a){return n("el-table-column",{key:a,attrs:{label:t,prop:t}})})),1)],1):e._e(),!e.data.triggers||"mysql"!=e.db_type&&"oracle"!=e.db_type?e._e():n("el-tab-pane",{attrs:{label:"触发器",name:"triggers"}},[n("el-table",{attrs:{size:"mini",data:e.data.triggers}},e._l(e.triggers,(function(e,t,a){return n("el-table-column",{key:a,attrs:{label:t,prop:t}})})),1)],1),!e.data.constraints||"mysql"!=e.db_type&&"oracle"!=e.db_type?e._e():n("el-tab-pane",{attrs:{label:"约束",name:"constraints"}},[n("el-table",{attrs:{size:"mini",data:e.data.constraints}},e._l(e.constraints,(function(e,t,a){return n("el-table-column",{key:a,attrs:{label:t,prop:t}})})),1)],1),n("el-tab-pane",{attrs:{label:"建表语句",name:"info"}},[n("pre",{domProps:{innerHTML:e._s(e.table)}})]),"mysql"==e.db_type?n("el-tab-pane",{attrs:{label:"表信息",name:"tableInfo"}},[n("pre",{domProps:{innerHTML:e._s(e.data.tableInfo[0])}})]):e._e()],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")])],1)],1)}),je=[],$e={data:function(){return{type:"",db_type:"",isShow:!1,cur_name:"struct",table_name:"",data:{constraints:[{}],indexs:[{}],triggers:[{}],info:null,struct:[{}],tableInfo:[{}]}}},computed:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["runList","runActive"])),{},{table:function(){return this.data.info&&this.data.info["data"]?this.data.info["data"]:this.data.info?this.data.info["Create Table"]:""},struct:function(){return this.head("struct")},indexs:function(){return this.head("indexs")},triggers:function(){return this.head("triggers")},constraints:function(){return this.head("constraints")},tableInfo:function(){return this.head("tableInfo")}}),methods:{getTableInfo:function(e,t){console.log("getTableInfo:",e.name),this.load(e.name)},head:function(e){var t=this.data[e];return t&&t.length>0?t[0]:{}},load:function(e){var t=this,n=this.runList[this.runActive],a={id:n.id,dbType:n.dbType};console.log("[dialog.table methods] info 表定义：",n.name,a),this.$api.table.info(a,n.name,this.table_name,e,this.type).then((function(n){console.log("[dialog.table methods] info ：",n),t.data[e]=n}))},show:function(e,t,n){this.type=n,this.db_type=t,this.table_name=e,this.isShow=!0,this.load(this.cur_name,n)},onClose:function(){this.type=""},hide:function(e){this.isShow=!1,this.data={constraints:[{}],indexs:[{}],triggers:[{}],info:null,struct:[{}],tableInfo:[{}]}},onSubmit:function(){}}},Fe=$e,Be=(n("a7f3"),Object(m["a"])(Fe,Me,je,!1,null,"7fbe62f4",null)),qe=Be.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"dialog-redis-info",attrs:{title:"提示",visible:e.visible,"min-width":"600px",width:"90%"},on:{"update:visible":function(t){e.visible=t},close:e.closeHandle}},[n("div",{staticClass:"main"},[n("header",[n("span",{staticClass:"item type"},[e._v(e._s(e.tableData.type))]),e._v(": "),n("span",{staticClass:"item key"},[e._v(e._s(e.tableData.key))]),e._v(" "),n("span",{staticClass:"item ttl"},[e._v("TTL: "+e._s(e.tableData.ttl))])]),n("el-table",{ref:"tables",staticClass:"margin-top-12 dialog-redis-info-table",staticStyle:{width:"100%"},attrs:{border:"","header-cell-style":{background:"#f0f0f0"},data:e.tableData.list||[],stripe:!0,"default-sort":{prop:"index",order:"descending"},"highlight-current-row":""},on:{"row-click":e.rowClickHandle}},[e.tableData.headList&&e.tableData.headList.length>0?[n("el-table-column",{attrs:{sortable:"",type:"index",label:"序号",width:"60"}}),e._l(e.tableData.headList,(function(e,t){return[n("el-table-column",{key:t,attrs:{sortable:"",prop:e,label:e}})]}))]:e._e()],2),n("footer",{staticClass:"margin-top-12"},[e.currentRow.key?n("div",[e._v("key")]):e.currentRow.score?n("div",[e._v("score")]):e.currentRow.id?n("div",[e._v("id")]):e._e(),e.currentRow.key||e.currentRow.score||e.currentRow.id?n("div",{staticClass:"key"},[e._v(" "+e._s(e.currentRow.key||e.currentRow.score||e.currentRow.id)+" ")]):e._e(),n("div",{staticClass:"margin-top-12"},[e._v("值")]),n("el-input",{staticClass:"value",attrs:{type:"textarea",rows:10,placeholder:"请输入内容"},model:{value:e.currentRow.value,callback:function(t){e.$set(e.currentRow,"value",t)},expression:"currentRow.value"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")])],1)])},Ve=[],We=n("163b"),Ge={computed:Object(s["a"])({},Object(r["c"])(["runList","runActive"])),data:function(){return{visible:!1,tableName:"",dbType:"redis",tableData:{},currentRow:{key:"未选择",value:""}}},methods:{closeHandle:function(){this.tableData={},this.currentRow={key:"未选择",value:""},this.tableName=""},rowClickHandle:function(e){this.$refs.tables.setCurrentRow(e),this.currentRow=e},show:function(e){this.tableName=e,this.visible=!0,this.load()},load:function(){var e=this,t=this.runList[this.runActive],n={id:t.id,dbType:t.dbType};console.log("[dialog.table methods] info 表定义：",t.name,n),this.$api.table.info(n,t.name,this.tableName,"struct").then((function(t){console.log("[dialog.table methods] info ：",t),e.convart(t.info)}))},convart:function(e){if(We["a"].contains(e,["KEY","TTL","TYPE","VALUE"])){var t=this.convartResult(e);console.log("转换： ",t),this.tableData={key:e["KEY"],ttl:e["TTL"],type:e["TYPE"],list:t.list,headList:t.headList}}else console.error("[dialog.redis.info methods] _convart：",e)},convartResult:function(e){var t=[],n=[],a=e["VALUE"]&&e["VALUE"].length>0&&e["VALUE"][0].Result;if("hash"==e["TYPE"]||"zset"==e["TYPE"]){if(n="hash"==e["TYPE"]?["key","value"]:["value","score"],a)for(var i=e["VALUE"][0].Result,s=0;s<i.length;s+=2){var r=null;r="hash"==e["TYPE"]?{key:i[s],value:i[s+1]}:{value:i[s],score:i[s+1]},t.push(r)}}else if(a)if(n=["value"],"set"==e["TYPE"]){var o=e["VALUE"][0].Result;for(var l in o)t.push({value:o[l]})}else{var c=e["VALUE"];for(var u in c)t.push({value:c[u].Result})}return{list:t,headList:n}}}},Xe=Ge,Ye=(n("ed71"),n("b4a6"),Object(m["a"])(Xe,He,Ve,!1,null,"31876c27",null)),ze=Ye.exports,Qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.table_name+" 表修改",visible:e.isShow,width:"1248px"},on:{"update:visible":function(t){e.isShow=t}}},[n("el-tabs",{staticClass:"table-info",attrs:{type:"border-card"},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[n("el-tab-pane",{attrs:{label:"字段定义",name:"struct"}},[n("edit-field",{attrs:{type:e.type,table:e.table_name},on:{submit:e.onDDL}})],1),n("el-tab-pane",{attrs:{label:"索引定义",name:"index",lazy:!0}},[n("edit-index",{attrs:{type:e.type,table:e.table_name},on:{submit:e.onDDL}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")])],1)],1)},Ke=[],Je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"table-mysql-edit"},[n("el-table",{attrs:{size:"mini",data:e.dataList}},[e._l(e.head,(function(t,a,i){return[-1==e.ignreColumns.indexOf(a)?n("el-table-column",{key:i,attrs:{label:a,prop:a},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.edit&&e.tableEdit[a]?n("div",["input"==e.tableEdit[a].type?n("el-input",{attrs:{size:"mini"},model:{value:i[a],callback:function(t){e.$set(i,a,t)},expression:"row[k]"}}):"select"==e.tableEdit[a].type?n("el-select",{attrs:{size:"mini"},model:{value:i[a],callback:function(t){e.$set(i,a,t)},expression:"row[k]"}},[e._l(e.tableEdit[a].item,(function(t){return[t.values?n("el-option-group",{key:t.group,attrs:{label:t.group}},e._l(t.values,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1):n("el-option",{key:t,attrs:{label:t,value:t}})]}))],2):e._e()],1):n("span",[e._v(e._s(i[a]))])]}}],null,!0)}):e._e()]})),n("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(n){return e.onSubmitField(t.row,t.$index)}}},[e._v("提交")]):n("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(n){return e.onEditField(t.row,t.$index)}}},[e._v("修改")]),t.row.edit?n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.onCancelField(t.row,t.$index)}}},[e._v("取消")]):n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.onDropField(t.row,t.$index)}}},[e._v("删除")])]}}])})],2),n("div",{staticStyle:{padding:"4px 8px"}},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.onAddField()}}},[e._v("新增字段")])],1)],1)},Ze=[];function et(e,t){return e?t.replace("$$$",e):""}var tt={mysql:{table:{Field:{type:"input"},Type:{type:"select",item:[{group:"数值类型",values:["TINYINT","SMALLINT","MEDIUMINT","INT","BIGINT","FLOAT","DOUBLE","DECIMAL"].map((function(e){return e.toLocaleLowerCase()}))},{group:"日期和时间类型",values:["DATE","TIME","YEAR","DATETIME","TIMESTAMP"].map((function(e){return e.toLocaleLowerCase()}))},{group:"字符串类型",values:["CHAR","VARCHAR","TINYBLOB","TINYTEXT","BLOB","TEXT","MEDIUMBLOB","MEDIUMTEXT","LONGBLOB","LONGTEXT"].map((function(e){return e.toLocaleLowerCase()}))}]},Length:{type:"input"},Default:{type:"input"},Comment:{type:"input"}},index:{non_unique:{type:"select",item:["0","1"]},index_name:{type:"input"},column_name:{multi:!0,type:"field"}},changeField:function(e,t){return t.origin.Field?"ALTER TABLE ".concat(e," CHANGE ").concat(t.origin.Field," ").concat(t.Field," ").concat(t.Type).concat(et(t.Length.replace(",0",""),"($$$)")," ").concat(et(t.Default,"DEFAULT $$$")," ").concat(et(t.Comment,"COMMENT '$$$'")):"ALTER TABLE ".concat(e," ADD ").concat(t.Field," ").concat(t.Type).concat(et(t.Length.replace(",0",""),"($$$)")," ").concat(et(t.Default,"DEFAULT $$$")," ").concat(et(t.Comment,"COMMENT '$$$'"))},dropField:function(e,t){return"ALTER TABLE ".concat(e," DROP ").concat(t.Field)},addIndex:function(e,t){return"ALTER TABLE ".concat(e," ADD ").concat("1"==t.non_unique?"UNIQUE":""," INDEX `").concat(t.index_name,"` (").concat(t.column_name.join?t.column_name.join(","):t.column_name,")")},dropIndex:function(e,t){return"ALTER TABLE ".concat(e," DROP INDEX `").concat(t.index_name,"`")}},oracle:{table:{FIELD:{type:"input"},TYPE:{type:"select",item:[{group:"数值类型",values:["TINYINT","SMALLINT","MEDIUMINT","INT","BIGINT","FLOAT","DOUBLE","DECIMAL"].map((function(e){return e.toLocaleLowerCase()}))},{group:"日期和时间类型",values:["DATE","TIME","YEAR","DATETIME","TIMESTAMP"].map((function(e){return e.toLocaleLowerCase()}))},{group:"字符串类型",values:["CHAR","VARCHAR","TINYBLOB","TINYTEXT","BLOB","TEXT","MEDIUMBLOB","MEDIUMTEXT","LONGBLOB","LONGTEXT"].map((function(e){return e.toLocaleLowerCase()}))}]},LEN:{type:"input"},DATA_DEFAULT:{type:"input"},COMMENTS:{type:"input"},NULLABLE:{type:"select",item:["Y","N"]}},index:{UNIQUENESS:{type:"select",item:["0","1"]},INDEX_NAME:{type:"input"},COLUMN_NAME:{multi:!0,type:"field"}},changeField:function(e,t){var n=[];return t.origin.FIELD?(t.origin.FIELD!=t.FIELD&&n.push("ALTER TABLE ".concat(e," RENAME ").concat(t.origin.FIELD," to ").concat(t.FIELD)),n.push("ALTER TABLE ".concat(e," MODIFY ").concat(t.FIELD," ").concat(t.TYPE).concat(et(t.LEN.replace(",0",""),"($$$)")," ").concat(et(t.DATA_DEFAULT,"DEFAULT '$$$'")," ").concat("Y"==t.NULLABLE?"NULL":"NOT NULL"))):n.push("ALTER TABLE ".concat(e," ADD ").concat(t.FIELD," ").concat(t.TYPE).concat(et(t.LEN.replace(",0",""),"($$$)")," ").concat(et(t.DATA_DEFAULT,"DEFAULT '$$$'")," ").concat("Y"==t.NULLABLE?"NULL":"NOT NULL")),t.origin.COMMENTS!=t.COMMENTS&&n.push("COMMENT ON COLUMN ".concat(e,".").concat(t.FIELD," IS '").concat(t.COMMENTS,"'")),n.join(";")},dropField:function(e,t){return"ALTER TABLE ".concat(e," DROP column ").concat(t.Field)},addIndex:function(e,t){return"CREATE INDEX ".concat("1"==t.UNIQUENESS?"UNIQUE":"","  ").concat(t.INDEX_NAME," on ").concat(e,"(").concat(t.COLUMN_NAME.join?t.COLUMN_NAME.join(","):t.COLUMN_NAME,")")},dropIndex:function(e,t){return"DROP INDEX ".concat(t.INDEX_NAME)}}},nt={data:function(){return{ignreColumns:["edit","origin"],dataList:[]}},inject:["db","owner"],computed:{head:function(){return this.dataList[0]||{}},tableEdit:function(){return tt[this.db.dbType].table},tableEditSchema:function(){return tt[this.db.dbType]}},props:{table:{type:String,default:""},type:{type:String,default:""}},watch:{table:function(){this.dataList=[],this.refresh()}},methods:{refresh:function(){var e=this;this.$api.table.info(this.db,this.owner.id,this.table,"struct",this.type).then((function(t){e.dataList=t.map((function(e){return e.edit=!1,e}))}))},onSubmitField:function(e){this.$emit("submit",this.tableEditSchema.changeField(this.table,e),this.refresh)},onAddField:function(){var e=Object(s["a"])({},this.dataList[0]||{});for(var t in e)e[t]=null;this.onEditField(e),this.dataList.push(e)},onEditField:function(e,t){e.edit=!0,e.origin=Object(s["a"])({},e)},onCancelField:function(e,t){for(var n in e.origin)e[n]=e.origin[n];e.edit=!1},onDropField:function(e,t){this.$emit("submit",this.tableEditSchema.dropField(this.table,e),this.refresh)}},components:{},mounted:function(){this.refresh()}},at=nt,it=(n("a413"),Object(m["a"])(at,Je,Ze,!1,null,null,null)),st=it.exports,rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"table-mysql-edit"},[n("div",{staticStyle:{padding:"4px 8px"}},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.onAddField()}}},[e._v("新增索引")])],1),n("el-table",{attrs:{size:"mini",data:e.dataList}},[e._l(e.head,(function(t,a,i){return[-1==e.ignreColumns.indexOf(a)?n("el-table-column",{key:i,attrs:{label:a,prop:a},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.add&&e.tableEdit[a]?n("div",["input"==e.tableEdit[a].type?n("el-input",{attrs:{size:"mini"},model:{value:i[a],callback:function(t){e.$set(i,a,t)},expression:"row[k]"}}):"select"==e.tableEdit[a].type?n("el-select",{attrs:{size:"mini"},model:{value:i[a],callback:function(t){e.$set(i,a,t)},expression:"row[k]"}},[e._l(e.tableEdit[a].item,(function(t){return[t.values?n("el-option-group",{key:t.group,attrs:{label:t.group}},e._l(t.values,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1):n("el-option",{key:t,attrs:{label:t,value:t}})]}))],2):"field"==e.tableEdit[a].type?n("el-select",{attrs:{size:"mini",multiple:e.tableEdit[a].multi},model:{value:i[a],callback:function(t){e.$set(i,a,t)},expression:"row[k]"}},e._l(e.columns,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e()],1):n("span",[e._v(e._s(i[a]))])]}}],null,!0)}):e._e()]})),n("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.add?[n("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(n){return e.onSubmitField(t.row,t.$index)}}},[e._v("提交")]),n("el-button",{attrs:{size:"mini"},on:{click:function(n){return e.onCancelField(t.row,t.$index)}}},[e._v("取消")])]:n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.onDropField(t.row,t.$index)}}},[e._v("删除")])]}}])})],2)],1)},ot=[],lt={data:function(){return{ignreColumns:["add"],dataList:[]}},inject:["db","owner"],computed:{head:function(){return this.dataList[0]||{}},tableEdit:function(){return tt[this.db.dbType].index},tableEditSchema:function(){return tt[this.db.dbType]}},props:{table:{type:String,default:""},type:{type:String,default:""}},watch:{table:function(){this.dataList=[],this.refresh()}},methods:{refresh:function(){var e=this;this.$api.table.info(this.db,this.owner.id,this.table,"indexs",this.type).then((function(t){e.dataList=t})),this.$api.auto.column(this.db.id,this.owner.id,this.table).then((function(t){e.columns=t}))},onSubmitField:function(e){this.$emit("submit",this.tableEditSchema.addIndex(this.table,e),this.refresh)},onAddField:function(){var e=Object(s["a"])({},this.dataList[0]||{});for(var t in e)e[t]=null;e.add=!0,this.dataList.push(e)},onCancelField:function(e,t){this.dataList.splice(t,1)},onDropField:function(e,t){this.$emit("submit",this.tableEditSchema.dropIndex(this.table,e),this.refresh)}},components:{},mounted:function(){this.refresh()}},ct=lt,ut=(n("02d8"),Object(m["a"])(ct,rt,ot,!1,null,null,null)),dt=ut.exports,ft={data:function(){return{type:"",isShow:!1,active:"struct",table_name:""}},inject:["db","owner"],props:{},watch:{},computed:{},methods:{show:function(e,t){this.type=t,this.table_name=e,this.active="struct",this.isShow=!0},onClose:function(){this.type=""},hide:function(e){this.isShow=!1,this.data={constraint:[{}],indexs:[{}],info:null,struct:[{}]}},onDDL:function(e,t){var n=this;console.log(e),this.$api.sql.ddl(this.db,this.owner,e).then((function(){n.onSuccess("修改成功"),t&&t()}))}},mounted:function(){},components:{EditField:st,EditIndex:dt}},ht=ft,pt=(n("3beb"),Object(m["a"])(ht,Qe,Ke,!1,null,"5157265c",null)),mt=pt.exports,vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"导出SQL",visible:e.isShow,width:"450px"},on:{"update:visible":function(t){e.isShow=t}}},[n("el-form",{attrs:{"label-width":"120px"}},[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{model:{value:e.formData.mark,callback:function(t){e.$set(e.formData,"mark",t)},expression:"formData.mark"}})],1),n("el-form-item",{attrs:{label:"导出条数"}},[n("el-select",{model:{value:e.formData.max_rows,callback:function(t){e.$set(e.formData,"max_rows",t)},expression:"formData.max_rows"}},e._l(e.rows,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)},bt=[],Et={data:function(){return{isShow:!1,notifys:["钉钉","微信","邮件"],rows:[10,2e3,3e3,5e3,1e5,2e5,5e5,1e6,5e6,2e7],tasktypes:[{l:"XLS",v:5}],formData:this.reset()}},props:{},watch:{},computed:{},methods:{reset:function(){return{mark:"",max_rows:2e3,notify:null,task_type:3,export:!0}},show:function(e){this.formData=this.reset(),this.cb=e,this.isShow=!0},hide:function(e){this.isShow=!1},onSubmit:function(){this.cb(this.formData),this.hide()}},mounted:function(){},components:{}},gt=Et,yt=Object(m["a"])(gt,vt,bt,!1,null,null,null),_t=yt.exports,Tt=n("89c1"),Rt=n.n(Tt),St=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-db-item-tempalte",class:{"card-db-item-tempalte-selected":e.source.id==e.selectedItemId}},[n("div",{staticClass:"item-name",attrs:{title:e.source.label},on:{click:function(t){return e.onItemClick(t,"left")},contextmenu:function(t){return t.preventDefault(),e.onItemClick(t,"right")}}},[e._v(e._s(e.source.label))]),n("i",{staticClass:"sn-font text-primary no-user-select",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.onItemClick(t,"custom-right")}}},[e._v("")])])},It=[],Lt=n("2708"),wt={name:"card-db-item-template",mixins:[Lt["a"]],components:{},props:{index:{type:Number},selectedItemId:{type:String},type:{},hasAsynSql:{},currentRun:{type:Object,default:function(){return{}}},source:{type:Object,default:function(){return{}}}},methods:{onItemClick:function(e,t){this.dispatch("card-db","selected-item",{source:this.source,type:t,e:e})}}},Ot=wt,xt=(n("d5da"),Object(m["a"])(Ot,St,It,!1,null,"046e1b7f",null)),Dt=xt.exports,At=n("ac9c"),Nt=n("0f1c"),Ct={name:"card-db",data:function(){return{menuList:{TABLE_LIST:{MENU_LIST:[{label:"COUNT",value:7},{label:"新增语句",value:4},{label:"修改语句",value:3},{label:"删除语句",value:2},{label:"表定义",value:6},{label:"导出SQL",value:8}]}}.TABLE_LIST.MENU_LIST,loading:!1,type:"table",treeProps:{label:"label",isLeaf:"leaf"},filter:"",itemTempalte:Dt,itemHeight:24,selectedItem:{},selectedItemId:"",vlistFooterVisible:!1,vlistFooterText:"loading...",nodeList:[],pages:{no:0,size:500,cursor:!0,nodeLength:0,total:0},contextMenuTarget:null,contextMenuVisible:!1}},inject:["db","owner","dataIndex"],computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["selecedDB","runner","sys","project","runList","runActive","vlistKeeps"])),Object(r["b"])(["run","context"])),{},{isDB:function(){switch(this.db.dbType){case"mysql":case"oracle":return!0;default:return!1}},currentRun:function(){var e=this;console.log("[card.db computed] currentRun:",this.tabId,this.db);var t=this.runList.filter((function(t){return t.tabId==e.tabId}));return t.length>0?t[0]:{}},filterDataList:function(){var e=this;return""==this.filter.trim()?this.nodeList:y["filter"](this.nodeList,(function(t){return-1!=t.label.toUpperCase().indexOf(e.filter.toUpperCase())}))}}),props:{db:{},owner:{},hasAsynSql:{type:Boolean,default:!1},tabId:{}},methods:{onScrollToBottom:function(){if(this.vlistFooterVisible)console.info("[card.db methods] onScrollToBottom() 防止多次查询");else{if(!this.pages.cursor)return this.vlistFooterVisible=!0,void(this.vlistFooterText="结束");this.pages.no=this.pages.cursor,console.log("[card.db methods] onScrollToBottom：",this.pages),this.onChangeDB(null,!1)}},onRightHandle:function(e){this.contextMenuVisible=e},onClickDefineInRoot:function(e){console.log("点击了item: ",e),this.otherProp="otherProp "+Math.random()},showTableDialog:function(e){this.$refs.tableDialog.show(e,this.db.dbType)},selItem:function(e){var t=this.context.service.getConfig("itemType");t!=e&&this.context.service.setConfig({itemType:e}),this.type=e,this.onChangeDB(null,!0)},refreshHandle:function(){this.$message({message:"刷新列表...",type:"success",duration:3e3}),this.onChangeDB({f:!0},!0)},exportSql:function(e){var t=this;this.$refs.exportSqlDialog.show((function(n){n.single_script=e,t.context.service.onRunAsync(n).then((function(e){e.error?t.$message.error(e.error):t.$bus.emit("runExport")}))}))},vlistToTop:function(){this.$refs.vlist&&this.$refs.vlist.scrollToIndex&&this.$refs.vlist.scrollToIndex(0)},vlistReset:function(){this.$refs.vlist&&this.$refs.vlist.reset&&this.$refs.vlist.reset()},onChangeDB:function(e,t){var n=this,a={id:this.currentRun.id,name:this.currentRun.name,type:this.type,project:this.project.id,pageSize:this.pages.size,pageNo:this.pages.no};Boolean(e)&&We["a"].has(e,["f","id","type","name","project"])&&(console.log("[card.db methods] onChangeDB 自带config参数：",e),a=Object.assign(a,e)),"redis"==this.currentRun.dbType&&(a.type=null),this.loading=!0,this.$api.auto.new_tree(a.id,a.type,"".concat(a.name,"."),!0,!0,!1,a.project,null,a.pageNo,a.pageSize,a.f).then((function(e){e.list?t||a.f?(n.vlistReset(),n.nodeList=e.list):n.nodeList=n.nodeList.concat(e.list):n.nodeList=[],n.pages.cursor=e.cursor,n.pages.total=e.total,n.pages.nodeLength=n.nodeList.length,console.log("[card.db methods] onChangeDB 查询结果：",e)})).finally((function(){n.loading=!1,n.vlistFooterVisible=!1,n.setMenus()}))},menuClickHandle:function(e){var t=this,n=this.selectedItem.label;switch(e){case 6:return"redis"==this.currentRun.dbType?this.$refs.redisInfoDialog.show(n):this.$refs.tableDialog.show(n,this.currentRun.dbType,this.type)}var a=this.runList[this.runActive],i={id:a.id,dbType:a.dbType};this.$api.auto.columns(i.id,"".concat(a.name,".").concat(n),!0,this.type,this.project.id).then((function(i){var s={columns:i,command:e,name:n,type:t.type,dbType:a.dbType,dbName:a.name,rw:a.rw,comment:!0};if("redis"==a.dbType){var r=n.split(":");r.length>0?(s.type=r[0],r=r.splice(1,r.length-1),console.log("arr:",r),s.name=r.join(":")):(s.type="string",s.name=n)}t.selecedDB&&t.selecedDB.source&&(s.sourceName=t.selecedDB.source.label);var o=oe["a"].generate(s);8==e&&t.exportSql(o),t.context.service.insertSQL(o,{clean:!1})})),this.contextMenuVisible=!1},setMenus:function(){this.$refs.vlist&&this.$refs.vlist.$el&&(this.contextMenuTarget=this.$refs.vlist.$el)}},components:{DialogTable:qe,DialogSqlExport:_t,DialogTableEdit:mt,DialogRedisInfo:ze,"virtual-list":Rt.a,"vue-context-menu":Nt["component"]},created:function(){var e=this;this.$on("selected-item",(function(t){var n=t.source,a=t.type,i=t.e;console.log("type: ",a),e.selectedItem=n,e.selectedItemId=n.id,"left"==a&&e.menuClickHandle(1),"custom-right"==a&&e.$refs.rightMenu.contextMenuHandler(i)})),this.$bus.off("".concat(this.tabId,"-card-db-refresh")),this.$bus.on("".concat(this.tabId,"-card-db-refresh"),(function(t){var n={id:t.id,name:t.name};e.onChangeDB(n,!0)}))},mounted:function(){var e=this;console.log("计算keeps: ",Object(At["a"])(this.$refs.vlist,this.itemHeight));var t=Object(At["a"])(this.$refs.vlist,this.itemHeight);t&&this.$store.commit("updateVlistKeeps",t);var n=this.runList.filter((function(t){return e.tabId==t.tabId}));console.log("card.db mounted: ",this.owner.name,this.tabId,this.dataIndex,n),this.onChangeDB(null,!0)},beforeDestroy:function(){this.$bus.off("".concat(this.tabId,".card.db.refresh"))}},kt=Ct,Ut=(n("fcf1"),n("32ec"),Object(m["a"])(kt,Ue,Pe,!1,null,null,null)),Pt=Ut.exports,Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sql-query-item"},[n("split-pane",{staticClass:"editor-container",attrs:{"min-percent":20,"default-percent":43,"max-percent":80,split:"horizontal"},on:{resize:e.onResize}},[n("template",{slot:"paneL"},[n("pre",{staticClass:"editor"})]),n("template",{slot:"paneR"},[n("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.resultJumpLoading,expression:"resultJumpLoading"}],staticClass:"results",attrs:{type:"border-card"},on:{"tab-click":e.onResultClick},model:{value:e.tabsValue,callback:function(t){e.tabsValue=t},expression:"tabsValue"}},[n("el-tab-pane",{attrs:{name:"result"}},[n("span",{staticClass:"no-user-select",attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-s-grid"}),e._v(" 结果 ")]),n("result-result",{ref:"tab-result",attrs:{"run-tab-id":e.runTabId}})],1),n("el-tab-pane",{attrs:{name:"info",disabled:e.infoDisable}},[n("span",{staticClass:"no-user-select",class:{"not-allowed":!!e.infoDisable},attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"el-icon-info"}),e._v(" 信息 ")]),n("result-info",{ref:"tab-info"})],1),n("el-tab-pane",{attrs:{name:"export"}},[n("span",{staticClass:"no-user-select",attrs:{slot:"label",title:"点击标签刷新"},slot:"label"},[n("i",{staticClass:"sn-font"},[e._v("")]),e._v(" 导出及异步 ")]),n("result-export",{ref:"tab-export",attrs:{"run-tab-id":e.runTabId}})],1),n("el-tab-pane",{attrs:{name:"history"}},[n("span",{staticClass:"no-user-select",attrs:{slot:"label",title:"点击标签刷新"},slot:"label"},[n("i",{staticClass:"sn-font"},[e._v("")]),e._v(" 历史操作 ")]),n("result-history",{ref:"tab-history",attrs:{"run-tab-id":e.runTabId}})],1),n("el-tab-pane",{attrs:{name:"work"}},[n("span",{staticClass:"no-user-select",attrs:{slot:"label"},slot:"label"},[0==e.workTotal?[n("i",{staticClass:"sn-font"},[e._v("")]),e._v(" 我的工单 ")]:[n("el-badge",{staticClass:"item",attrs:{value:e.workTotal}},[n("i",{staticClass:"sn-font"},[e._v("")]),e._v(" 我的工单 ")])]],2),n("result-work",{ref:"tab-work",attrs:{"run-tab-id":e.runTabId},on:{total:e.onTotalHandler}})],1)],1)],1)],2),n("dialog-async",{ref:"dialogAsync"}),n("dialog-export",{ref:"dialogExport"}),n("dialog-favorite",{ref:"dialogFavorite"})],1)},jt=[];n("a4d3"),n("e01a"),n("d28b");function $t(e){return $t="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$t(e)}var Ft,Bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"异步查询",visible:e.isShow,width:"450px"},on:{"update:visible":function(t){e.isShow=t}}},[n("el-form",{attrs:{"label-width":"120px"}},[n("el-form-item",{attrs:{label:"查询标题"}},[n("el-input",{model:{value:e.formData.mark,callback:function(t){e.$set(e.formData,"mark",t)},expression:"formData.mark"}})],1),n("el-form-item",{attrs:{label:"查询条数"}},[n("el-select",{model:{value:e.formData.max_rows,callback:function(t){e.$set(e.formData,"max_rows",t)},expression:"formData.max_rows"}},e._l(e.rows,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)},qt=[],Ht={data:function(){return{isShow:!1,notifys:["钉钉","微信","邮件"],rows:[10,2e3,3e3,5e3,1e4,5e4],formData:this.reset()}},props:{},watch:{},computed:{},methods:{reset:function(){return{mark:"",max_rows:2e3,notify:null,async:!0}},show:function(e){this.formData=this.reset(),this.cb=e,this.isShow=!0},hide:function(e){this.isShow=!1},onSubmit:function(){this.cb(this.formData),this.hide()}},mounted:function(){},components:{}},Vt=Ht,Wt=Object(m["a"])(Vt,Bt,qt,!1,null,null,null),Gt=Wt.exports,Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"异步导出",visible:e.isShow,width:"450px"},on:{open:e.onOpen,"update:visible":function(t){e.isShow=t}}},[n("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.formData,rules:e.rules}},[n("el-form-item",{attrs:{label:"查1询标题",prop:"mark"}},[n("el-input",{ref:"xxxx",model:{value:e.formData.mark,callback:function(t){e.$set(e.formData,"mark",t)},expression:"formData.mark"}})],1),n("el-form-item",{attrs:{label:"查询条数"}},[n("el-select",{model:{value:e.formData.max_rows,callback:function(t){e.$set(e.formData,"max_rows",t)},expression:"formData.max_rows"}},e._l(e.rows,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),n("el-form-item",{attrs:{label:"导出方式",prop:"task_type"}},[n("el-radio-group",{model:{value:e.formData.task_type,callback:function(t){e.$set(e.formData,"task_type",t)},expression:"formData.task_type"}},e._l(e.fileTypes,(function(t,a){return n("el-radio",{key:t,attrs:{label:a}},[e._v(e._s(t))])})),1)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{type:"success"},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)},Yt=[],zt={computed:Object(s["a"])({},Object(r["c"])(["fileTypes"])),data:function(){return{autofocus:!1,isShow:!1,notifys:["钉钉","微信","邮件"],rows:[10,2e3,3e3,5e3,1e5,2e5,5e5,1e6,5e6,2e7],rules:{mark:[{required:!0,message:"请输入文件名"}],task_type:[{required:!0,message:"请选文件类型",trigger:"change"}]},tasktypes:[{l:"CSV",v:2},{l:"SQL",v:3},{l:"XLS",v:5},{l:"JSON",v:6}],formData:this.reset()}},props:{},watch:{},methods:{reset:function(){return{mark:"",max_rows:2e3,notify:null,task_type:"5",export:!0}},show:function(e){this.formData=this.reset(),this.cb=e,this.isShow=!0},hide:function(e){this.isShow=!1,this.autofocus=!1},onSubmit:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.cb(e.formData),e.hide())}))},onOpen:function(){var e=this;this.$nextTick((function(){e.$refs["xxxx"].focus()}))}},mounted:function(){},components:{}},Qt=zt,Kt=Object(m["a"])(Qt,Xt,Yt,!1,null,null,null),Jt=Kt.exports,Zt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"收藏",visible:e.isShow,"custom-class":"dialog-favorite",width:"600px"},on:{"update:visible":function(t){e.isShow=t}}},[n("el-form",{ref:"form",attrs:{model:e.formData,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"标题"}},[n("el-input",{model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),n("el-form-item",{attrs:{label:"SQL"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRow:4}},model:{value:e.formData.script,callback:function(t){e.$set(e.formData,"script",t)},expression:"formData.script"}})],1),n("el-form-item",{attrs:{label:"目录"}},[n("el-tree",{attrs:{data:e.treeData,props:e.treeProps},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var a=t.data;return n("div",{staticClass:"tree-item hbox-between hbox-center"},[n("div",{staticClass:"left"},[e._v(e._s(a.name))]),0==a.id?n("div",{staticClass:"right"},[n("i",{staticClass:"sn-font",attrs:{title:"新增子目录"}},[e._v("")])]):e._e()])}}])})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{type:"success"},on:{click:e.hide}},[e._v("保存")])],1)],1)},en=[],tn={data:function(){return{isShow:!1,formData:{},treeData:[],treeProps:{label:"name"}}},props:{},watch:{},computed:{},methods:{show:function(e){var t=this;this.isShow=!0,this.formData=e,console.log("[dialog.favorite methods] show: ",e),this.$api.post("/api/sql/favorite/all",{dbId:e.id}).then((function(e){e=y["orderBy"](e,["pid","asc"],["id","desc"]);var n=[],a=(y["keyBy"](e,"id"),{});e.forEach((function(e){if(-1==e.pid)n.push(e);else{var t=a[e.pid];t.children=t.children||[],t.children.push(e)}a[e.id]=e})),t.treeData=n}))},hide:function(e){this.isShow=!1},onAddFolder:function(){},onEditFolder:function(){},onRemoveFolder:function(){},onSubmit:function(){}},mounted:function(){},components:{}},nn=tn,an=(n("750d"),Object(m["a"])(nn,Zt,en,!1,null,null,null)),sn=an.exports,rn=n("19ab"),on=n.n(rn),ln=n("5c96"),cn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"ref-result",staticClass:"result-result"},[n("div",{staticClass:"tools hbox-center"},[n("span",{staticClass:"vr"}),n("div",{staticClass:"edit-tools",class:{"disabled-all":!e.isTableAllowEdit||!e.isAllowEdit}},[n("k-icon",{staticClass:"pointer-active",class:{disabled:!e.isEffectData},attrs:{title:"提交",type:"image",icon:"accept@2x"},nativeOn:{click:function(t){return e.onSubmit(t)}}}),n("k-icon",{staticClass:"pointer-active",class:{disabled:!e.isEffectData},attrs:{title:"关闭/还原",type:"image",icon:"cancel@2x"},nativeOn:{click:function(t){return e.onCancel(t)}}}),n("k-icon",{staticClass:"pointer-active",class:{disabled:!e.isAllowAdd},attrs:{title:"添加行",type:"image",icon:"row_add@2x"},nativeOn:{click:function(t){return e.addRow(!1)}}}),n("k-icon",{staticClass:"pointer-active",class:{"disabled-all":0==e.selectItems.length||!e.isAllowAdd},attrs:{title:"复制行",type:"image",icon:"row_copy@2x"},nativeOn:{click:function(t){return e.addRow(!0)}}}),n("k-icon",{staticClass:"pointer-active",class:{"disabled-all":!e.isAllowDelete},attrs:{title:"删除行",type:"image",icon:"row_delete@2x"},nativeOn:{click:function(t){return e.deleteRow(t)}}})],1),n("span",{staticClass:"vr"}),n("span",{staticClass:"tool"},[e._v(" 第 "),n("span",{staticClass:"text-primary"},[e._v(e._s(e.service.page+1))]),e._v(" 页 ")]),n("span",{staticClass:"vr"}),n("tool",{attrs:{icon:"&#xe7ea;",text:"第一页",disabled:e.disable||e.notHasPrev},on:{click:function(t){return e.service.onFirst()}}}),n("tool",{attrs:{icon:"&#xe7ec;",text:"前一页",disabled:e.disable||e.notHasPrev},on:{click:function(t){return e.onPre()}}}),n("tool",{attrs:{icon:"&#xe7eb;",text:"后一页",disabled:e.disable||e.notHasNext},on:{click:function(t){return e.onNext()}}}),n("tool",{attrs:{icon:"&#xe7ed;",text:"累加",disabled:e.disable||e.notHasNext},on:{click:function(t){return e.onNext(!0)}}}),n("span",{staticClass:"vr"}),n("el-select",{staticClass:"tool size",attrs:{size:"mini",value:e.pageSize},on:{change:e.pageSizeChangeHandle}},e._l(e.sizes,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1),n("span",{staticClass:"vr"}),n("tool",{attrs:{icon:"&#xe65b;",text:"字体变大"},on:{click:function(t){return e.onChangeFontSize(!0)}}}),n("tool",{attrs:{icon:"&#xe65a;",text:"字体变小"},on:{click:function(t){return e.onChangeFontSize()}}}),n("span",{staticClass:"vr"}),n("tool",{class:{"text-info":e.showLine,"text-disable":!e.showLine},attrs:{icon:"&#xe61c;",text:e.showLine?"取消行号":"显示行号"},on:{click:function(t){return e.onShowLine()}}}),n("tool",{class:{"text-info":e.showCheck,"text-disable":!e.showCheck},attrs:{icon:"&#xe939;",text:e.showCheck?"取消多选":"多选"},on:{click:function(t){return e.onShowCheck()}}}),n("span",{staticClass:"vr"}),n("tool",{attrs:{text:"比较数据",title:"多选记录比较数据",icon:"&#xe624;",disabled:e.selectItems.length<1},on:{click:function(t){return e.$refs.dialogDiff.show(e.selectItems)}}}),n("span",{staticClass:"vr"}),n("span",{staticClass:"tool",class:{"text-success":e.service.result,"text-error":!e.service.result},staticStyle:{cursor:"default"}},[e._v(e._s(e.service.resultText)+" "),""!=e.service.resultText&&e.worTypeText?n("span",[e._v(" ("+e._s(e.worTypeText)+") ")]):e._e()]),n("div",{staticClass:"empty"}),e.xgridData.length>0?n("tool",{attrs:{text:"全屏",title:"全屏",icon:"&#xe6f7;"},on:{click:e.maximizeHandle}}):e._e(),n("tool-column")],1),e.xgridData.length>=0||e.service.loading?n("div",{staticClass:"table-scrollbar",style:{height:e.tabHeight}},[n("vxe-grid",{ref:"xGrid",attrs:{border:"",resizable:"",height:"auto",width:"auto","highlight-hover-row":"",stripe:"","auto-resize":"","show-header-overflow":"title","show-overflow":"title","edit-config":e.editConfig,"checkbox-config":{trigger:"cell",highlight:!0,range:!0},data:e.xgridData,"header-cell-style":{"font-size":e.fontSize+"px"},"cell-style":{"font-size":e.fontSize+"px"},"seq-config":{startIndex:e.startIndex},loading:e.service.loading},on:{"checkbox-change":e.onCheckSelected,"checkbox-all":e.onCheckSelectedAll,"cell-click":e.onCellClick,"cell-dblclick":e.onCellDbClick,"edit-actived":e.onCellActived,"edit-closed":e.onCellClosed}},[e.showCheck?n("vxe-table-column",{attrs:{type:"checkbox",field:"vxe__checkbox",width:"40px",fixed:"left"}}):e._e(),e.showLine?n("vxe-table-column",{attrs:{type:"seq",field:"vxe__no",width:"60px",title:"No.",fixed:"left"}}):e._e(),e._l(e.filterHead,(function(t,a){return[n("vxe-table-column",{key:t.label+"-"+a,attrs:{field:t.label,title:t.label,width:e.getWidth(t.label),"edit-render":{name:"input"}},scopedSlots:e._u([{key:"edit",fn:function(t){var a=t.row,i=t.column;return n("div",{staticClass:"table-edit-render"},[n("input",{directives:[{name:"model",rawName:"v-model",value:a[i.title],expression:"row[column.title]"}],staticClass:"vxe-custom-input",attrs:{type:"text"},domProps:{value:a[i.title]},on:{focus:function(t){return e.onEditRenderFocusOrBlur(t,a,i)},blur:function(t){return e.onEditRenderFocusOrBlur(t,a,i)},input:function(t){t.target.composing||e.$set(a,i.title,t.target.value)}}})])}},{key:"default",fn:function(a){var i=a.row,s=a.column;return[e.service.explain&&e.service.data&&"oracle"==e.service.data.dbType?n("pre",{staticClass:"vxe-cell--label data-xxxxxxxxxx",class:[i._XID_TYPE,i["_XID_TYPE_"+s.title]]},[e._v(e._s(i[t.label]))]):n("div",{staticClass:"vxe-cell--label data-xxxxxxxxxx",class:[i._XID_TYPE,i["_XID_TYPE_"+s.title]]},[e._v(" "+e._s(i[t.label])+" ")])]}}],null,!0)})]}))],2)],1):n("div",{staticClass:"empty"},[e._v("查询结果")]),n("dialog-long-text",{ref:"dialogLongTextRef",on:{action:e.onLongTextAction}}),n("dialog-diff",{ref:"dialogDiff"}),n("dialog-effect",{ref:"dialogEffectRef",on:{action:e.onEffectAction}}),n("dialog-error",{ref:"dialogErrorRef",on:{action:e.onErrorAction}}),n("dialog-new-work",{ref:"dialogNewWorkRef",on:{action:e.onNewWorkAction}}),n("dialog-exec",{ref:"dialogExecRef",on:{runExec:e.onDialogExec,action:e.onEexecAction}})],1)},un=[],dn=(n("caad"),n("b64b"),n("07ac"),n("2532"),n("b85c")),fn=new Uint8Array(16);function hn(){if(!Ft&&(Ft="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!Ft))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ft(fn)}var pn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function mn(e){return"string"===typeof e&&pn.test(e)}for(var vn=mn,bn=[],En=0;En<256;++En)bn.push((En+256).toString(16).substr(1));function gn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(bn[e[t+0]]+bn[e[t+1]]+bn[e[t+2]]+bn[e[t+3]]+"-"+bn[e[t+4]]+bn[e[t+5]]+"-"+bn[e[t+6]]+bn[e[t+7]]+"-"+bn[e[t+8]]+bn[e[t+9]]+"-"+bn[e[t+10]]+bn[e[t+11]]+bn[e[t+12]]+bn[e[t+13]]+bn[e[t+14]]+bn[e[t+15]]).toLowerCase();if(!vn(n))throw TypeError("Stringified UUID is invalid");return n}var yn=gn;function _n(e,t,n){e=e||{};var a=e.random||(e.rng||hn)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return yn(a)}var Tn=_n,Rn={iid:null,sql:null,project:null,encrypt_flag:!1,owner:null,db_type:null,token:null},Sn={item_type:null,atk:null,iid:null,project:null,sql:null,encrypt_flag:!1,owner:null,db_type:null,token:null,page_index:0,page_size:10,explain:!1},In=function(e){return e=S["default"].util.aesEncrypted(e),e},Ln=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Object(s["a"])(Object(s["a"])({},Rn),e),e.encrypt_flag&&(e.sql=In(e.sql)),e.token||(e.token=Object(le["a"])());var t=Date.now();return new Promise((function(n,a){S["default"].sql.audit(e).then((function(e){var a=Date.now();return n({spend:a-t,data:e})})).catch((function(e){var n=Date.now();return a({spend:n-t,event:e})}))}))},wn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Object(s["a"])(Object(s["a"])({},Sn),e),e.encrypt_flag&&(e.sql=In(e.sql));var t=Date.now();return new Promise((function(n,a){S["default"].sql.exec(e).then((function(a){a.ok,a.head,a.type;var i=a.data,s=a.count,r=a.error,o=a.sql_type,l=a.work,c=a.table_name,u=Date.now(),d={spend:u-t,table_name:c,sql_type:o,error:r,work:l,hasNext:i.length>=e.page_size,affected_rows:11==o?s:s||i.length,data:i};return n(d)})).catch((function(e){var n=Date.now();return a({spend:n-t,event:e})}))}))},On=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tooltip",{attrs:{content:e.text}},[n("el-button",{staticClass:"sql-query-tool",attrs:{size:"mini",type:e.type,disabled:e.disabled},on:{click:function(t){return e.$emit("click")}}},[n("div",{staticClass:"hbox-center"},[n("i",{staticClass:"sn-font",domProps:{innerHTML:e._s(e.icon)}})])])],1)},xn=[],Dn={data:function(){return{}},computed:{},props:{text:{},icon:{},type:{default:"text"},disabled:{}},watch:{},methods:{},components:{},mounted:function(){}},An=Dn,Nn=(n("a278"),Object(m["a"])(An,On,xn,!1,null,null,null)),Cn=Nn.exports,kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.service.head.length>0,expression:"service.head.length > 0"}],staticClass:"tool-column"},[n("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[n("div",{staticClass:"col_lists"},[n("el-checkbox",{on:{change:e.checkAll},model:{value:e.chk_all,callback:function(t){e.chk_all=t},expression:"chk_all"}},[n("span",[e._v("全部")])]),e._l(e.headList,(function(t){return n("div",{key:t.k.label,staticClass:"col_list"},[n("el-checkbox",{model:{value:t.v,callback:function(n){e.$set(t,"v",n)},expression:"v.v"}},[n("span",[e._v(e._s(t.k.label))])])],1)}))],2),n("i",{staticClass:"sn-font text-primary",attrs:{slot:"reference"},slot:"reference"},[e._v("")])])],1)},Un=[],Pn={data:function(){this.$route.params;return{chk_all:!0,headList:[]}},inject:["service"],computed:{},props:{},watch:{"service.head":function(e){this.headList=e.map((function(e){return{k:e,v:!0}}))},headList:{deep:!0,handler:function(){this.service.filterHead=this.headList.filter((function(e){return e.v})).map((function(e){return e.k}))}}},methods:{checkAll:function(e){this.headList.forEach((function(t){console.log("v:",t.v," k:",t.k),t.v=e}))}}},Mn=Pn,jn=(n("0142"),Object(m["a"])(Mn,kn,Un,!1,null,"b5ac312e",null)),$n=jn.exports,Fn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"",visible:e.isShow,width:"800px"},on:{"update:visible":function(t){e.isShow=t},open:function(t){return e.onVisiable(!0)},opened:e.onOpened,close:function(t){return e.onVisiable(!1)}}},["blob"==e.type?n("el-tabs",{attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:"text"}},[n("pre",{staticStyle:{height:"600px","overflow-y":"scroll","word-break":"break-all",border:"1px solid #72767b","font-size":"12px",padding:"5px",width:"760px","word-wrap":"normal"},attrs:{id:"longtext"}},[e._v("    "+e._s(e.b2s(e.text))+"\n        ")])]),n("el-tab-pane",{attrs:{label:"image"}},[n("img",{staticStyle:{width:"100%"},attrs:{src:"data:image/png;base64,"+e.text,alt:"Red dot"}})]),n("el-tab-pane",{attrs:{label:"hex"}},[n("pre",{staticStyle:{height:"600px","overflow-y":"scroll","word-break":"break-all",border:"1px solid #72767b","font-size":"12px",padding:"5px",width:"760px","word-wrap":"normal"},attrs:{id:"longtext",contenteditable:"true"}},[e._v("        "+e._s(e.s2b(e.text))+"\n      ")])])],1):n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],ref:"focusRef",staticStyle:{color:"blue",height:"600px","overflow-y":"scroll","word-break":"break-all",border:"1px solid #72767b","font-size":"12px",padding:"5px",width:"760px","word-wrap":"normal"},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.submit}},[e._v("确定")])],1)],1)},Bn=[],qn=n("491f"),Hn=qn["a"],Vn=(n("6961"),Object(m["a"])(Hn,Fn,Bn,!1,null,"5ec34bf0",null)),Wn=Vn.exports,Gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"dialog-effect-pages",attrs:{title:"修改数据",visible:e.isShow,"append-to-body":!0,width:"600px"},on:{"update:visible":function(t){e.isShow=t}}},[n("monaco-lite",{ref:"monacoLite",staticClass:"effect-sql",on:{change:e.monacoListChangeHandler}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.isShow=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onClick("exec")}}},[e._v("提 交")])],1)],1)},Xn=[],Yn={name:"dialog-effect",components:{MonacoLite:se["a"]},data:function(){return{isShow:!1,sql:""}},methods:{onClick:function(e){"exec"==e?(this.$emit("action",this.sql),this.isShow=!1):"copy"==e||this.$message.error("参数错误")},monacoListChangeHandler:function(){console.log("修改了")},show:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{sql:null},n=t.sql;this.isShow=!0,this.$nextTick((function(){n&&(e.sql=n),e.$refs.monacoLite.setSql(n||"-- SQL生成错误")}))}}},zn=Yn,Qn=(n("208e"),Object(m["a"])(zn,Gn,Xn,!1,null,null,null)),Kn=Qn.exports,Jn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"dialog-error-pages",attrs:{title:"SQL错误",visible:e.isShow,"append-to-body":!0,width:"600px"},on:{"update:visible":function(t){e.isShow=t}}},[n("monaco-lite",{ref:"monacoLite",staticClass:"error-sql",on:{change:e.monacoListChangeHandler}}),n("el-divider"),n("div",[n("span",[e._v("错误信息：")]),n("span",{staticClass:"error"},[e._v(e._s(e.spend))])]),n("el-input",{staticClass:"table-scrollbar",attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:e.params.error,callback:function(t){e.$set(e.params,"error",t)},expression:"params.error"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.onClick("exec")}}},[e._v("确 定")])],1)],1)},Zn=[],ea=(n("b680"),{name:"dialog-error",components:{MonacoLite:se["a"]},data:function(){return{isShow:!1,params:{sql:"",error:"",spend:0},spend:"0毫秒"}},methods:{onClick:function(e){"exec"==e&&(this.$emit("action",this.sql),this.isShow=!1)},monacoListChangeHandler:function(){console.log("修改了")},show:function(e){var t=this;this.isShow=!0,this.$nextTick((function(){t.params=Object(s["a"])({},e),e.spend>1e3?t.spend="耗时 ".concat((e.spend/1e3).toFixed(2)," 秒"):t.spend="耗时 ".concat(e.spend," 毫秒"),t.$refs.monacoLite.setSql(e.sql||"-- SQL生成错误")}))}}}),ta=ea,na=(n("b50c"),Object(m["a"])(ta,Jn,Zn,!1,null,null,null)),aa=na.exports,ia=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"dialog-diff",attrs:{title:"数据对比",visible:e.isShow},on:{"update:visible":function(t){e.isShow=t}}},[n("template",{slot:"title"},[n("span",[e._v("数据对比")]),n("el-checkbox",{staticStyle:{"padding-left":"64px","font-size":"12px"},model:{value:e.onlyDiff,callback:function(t){e.onlyDiff=t},expression:"onlyDiff"}},[e._v("只显示不同")])],1),n("el-form",{attrs:{size:"mini","label-position":"top"}},[e._l(e.dataList,(function(t,a){return[!e.onlyDiff||t.diff?n("el-form-item",{key:a,attrs:{label:t.label}},[n("el-row",{attrs:{type:"flex",gutter:10}},e._l(t.values,(function(e,a){return n("el-col",{key:a},[n("el-input",{class:{"text-error":t.diff},attrs:{readonly:"",value:e}})],1)})),1)],1):e._e()]}))],2),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.hide}},[e._v("取消")]),n("el-button",{attrs:{type:"success"},on:{click:e.hide}},[e._v("保存")])],1)],2)},sa=[],ra={data:function(){return{isShow:!1,onlyDiff:!1,dataList:[]}},props:{},watch:{},computed:{},methods:{show:function(e){this.onlyDiff=!1;var t=e[0],n=[],a=function(a){var i={label:a,values:[],diff:!1};e.forEach((function(e){e[a]!=t[a]&&(i.diff=!0),i.values.push(e[a])})),n.push(i)};for(var i in t)a(i);this.dataList=n,console.log(this.dataList),this.isShow=!0},hide:function(){this.isShow=!1},onSubmit:function(){}},mounted:function(){},components:{}},oa=ra,la=(n("452e"),Object(m["a"])(oa,ia,sa,!1,null,null,null)),ca=la.exports,ua="_XID",da="row-type-update",fa="column-type-update",ha="row-type-insert",pa="row-type-delete",ma="<nil>",va=[2,4],ba=["mysql","oracle"],Ea={name:"result-result",components:{Tool:Cn,ToolColumn:$n,DialogLongText:Wn,DialogDiff:ca,DialogEffect:Kn,DialogError:aa,DialogNewWork:ge,DialogExec:Ie},inject:["service"],props:{runTabId:{type:Number,default:function(){return null}}},computed:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["selecedDB","dataBaseList","project","pageSize"])),{},{isTableAllowEdit:function(){var e=this.service.execResult,t=this.service.auditResult,n=!e.work&&11==e.sql_type&&"table"==this.service.runParams.item_type&&e.table_name&&va.includes(e.table_rw)&&ba.includes(t.db_type);return console.log("[computed] isTableAllowEdit: ",n),n},editConfig:function(){return this.isTableAllowEdit?{trigger:"dblclick",mode:"cell",autoClear:!1,showIcon:!0,showStatus:!0}:{autoClear:!1,showIcon:!1}},isAllowAdd:function(){return this.isTableAllowEdit&&!this.insertOrDeleteRowData.data&&!this.isEffectData},isAllowDelete:function(){return this.isTableAllowEdit&&!this.insertOrDeleteRowData.data&&!this.isEffectData&&this.selectItems.length>0},isEffectData:function(){var e=this.isTableAllowEdit&&this.effectData.rows&&Object.keys(this.effectData.rows).length>0;return console.log("[computed] isEffectData this.effectData.rows: ",e),e},disable:function(){return this.service.loading},notHasPrev:function(){return this.service.page<=0},notHasNext:function(){return!this.service.hasNext},worTypeText:function(){return!(!this.service.mode||!this.service.mode.mode)&&this.service.mode.mode},getWidth:function(){var e=this;return function(t){var n=e.service.colsWidth[t],a=n*e.fontSize/1.5;return a=Math.ceil(a)+10,"Mac"==window.os&&(a+=16),a}},filterHead:function(){var e=this.service.filterHead;return e}}),data:function(){return{submitLoading:!1,xgridData:[],currentSoftRoute:"",isAllowEdit:!0,longTextVisiable:!1,insertOrDeleteRowData:{},handleCancelEditReander:!1,multiRowOpend:!1,isEffect:!1,effectDataDefault:{type:"update",wheres:{},rows:{},oldRows:{}},tableInfo:{wheres:[],pks:[],columns:[]},activeEffect:{},effectData:{type:"update",wheres:{},rows:{},oldRows:{}},workTypes:{work:"工单查询",async:"异步查询",normal:""},startIndex:0,tableLoading:!1,tableToolbar:{perfect:!0,refresh:!0,zoom:!0,custom:!0,slots:{buttons:"toolbar_buttons"}},treeConfig:{toggleMethod:this.toggle},sizes:[10,20,50,100,500,1e3,2e3],showLine:!1,showCheck:!1,fontSize:13,selectItems:[],selectInfos:[],tabHeight:"200px",colMaxWidth:200,colMinWidth:50,cols:{}}},watch:{submitLoading:function(e){this.$bus.emit("workpace-loading",e)},"service.body":{handler:function(){var e=this,t=this.service.body,n=Object.values(t);console.log("[watch service.body]结果集：",n),this.$nextTick((function(){try{e.startIndex=e.service.cli_page*e.service.size}catch(t){e.startIndex=0}e.resize()})),this.clearEffectDataAndIsEffect(),this.clearOrCheck();var a=this.service.auditResult;ba.includes(a.db_type)&&this.setEffectDataWhere(!0),this.reSetSoftRoute(),0!=this.service.affected_rows&&n?this.xgridData=n:this.xgridData=[]}}},mounted:function(){this.resize()},methods:{reSetSoftRoute:function(){this.service.runSql&&(this.currentSoftRoute=oe["a"].getSoftRoute(this.service.runSql))},onSubmit:function(){this.submitLoading=!0,console.log(this.effectData,this.activeEffect),console.log("表信息：",this.tableInfo),this.submitInsertOrDeleteEffectData()},onCancel:function(e){this.submitLoading=!1,console.log("修改的内容：",this.effectData),"insert"==this.effectData.type?this.xgridData.splice(this.insertOrDeleteRowData.index+1,1):"update"==this.effectData.type&&this.cancelRestoreEffectData(),this.clearEffectDataAndIsEffect(),this.clearOrCheck(),console.log("修改的内容：",this.effectData)},clearOrCheck:function(e){var t=this.$refs.xGrid;if(t.clearCheckboxRow(),t.clearCheckboxReserve(),this.selectItems=[],this.selectInfos=[],e&&e.row)return console.log("选中：",e),t.setCheckboxRow(e.row,!0),this.selectItems=[e.row],void(this.selectInfos=[{columnIndex:e.columnIndex,rowIndex:e.rowIndex}])},addRow:function(e){this.isEffectData&&(console.log("[result.result.vue] #addRow() 还原数据"),this.onCancel());var t=0,n=null;if(this.selectInfos.length>0){if(t=this.selectInfos[this.selectInfos.length-1].rowIndex,console.log(this.selectInfos[this.selectInfos.length-1].rowIndex),n=JSON.parse(JSON.stringify(this.xgridData[t])),delete n._XID,delete n._XID_VUE_UUID_,e)this.activeEffect={row:n,column:{}};else for(var a in n)n[a]=ma;n._XID_VUE_UUID_=Tn(),n._XID_TYPE=ha,n._XID_IS_INSERT=!0,this.insertOrDeleteRowData={type:"insert",index:t,data:n},console.log("row 插入数据：",n),this.effectData.type="insert",this.effectData.oldRows[n._XID_VUE_UUID_]={},this.$set(this.effectData.rows,n._XID_VUE_UUID_,n),this.xgridData.splice(this.insertOrDeleteRowData.index+1,0,this.insertOrDeleteRowData.data)}else{for(var i in console.log(this.filterHead),n={},n._XID_VUE_UUID_=Tn(),n._XID_TYPE=ha,n._XID_IS_INSERT=!0,this.filterHead){var s=this.filterHead[i];n[s.label]=ma}this.insertOrDeleteRowData={type:"insert",index:-1,data:n},this.effectData.type="insert",this.effectData.oldRows[n._XID_VUE_UUID_]={},this.$set(this.effectData.rows,n._XID_VUE_UUID_,n),this.xgridData.splice(this.insertOrDeleteRowData.index+1,0,this.insertOrDeleteRowData.data)}this.clearOrCheck({row:n,columnIndex:0,rowIndex:t+1})},deleteRow:function(){this.isEffectData&&this.onCancel();var e=0;if(this.selectInfos.length>0){e=this.selectInfos[this.selectInfos.length-1].rowIndex;var t=this.xgridData[e];if(t._XID_TYPE==ha)return void this.xgridData.splice(e,1);this.$set(this.xgridData[e],"_XID_TYPE",pa),this.insertOrDeleteRowData={type:"delete",index:e,data:t},this.activeEffect={row:t,column:{}},console.log("[deleteRow] this.activeEffect: ",this.activeEffect,this.selectInfos.length),this.effectData.type="delete",this.effectData.oldRows[t._XID_VUE_UUID_]=t,this.$set(this.effectData.rows,t._XID_VUE_UUID_,t)}else this.$message.error("请选择行后再删除！")},onCellClick:function(e){e.$event.stopPropagation();var t=this.$refs.xGrid;t.isCheckedByCheckboxRow(e.row)||(t.clearCheckboxRow(),t.clearCheckboxReserve(),t.setCheckboxRow(e.row,!0),this.selectItems=[e.row],this.selectInfos=[{columnIndex:e.columnIndex,rowIndex:e.rowIndex}])},onCheckSelected:function(e){e.$event.stopPropagation(),console.log("[#onCheckSelected()]选中的数据: ",e);var t=e.selection;this.selectItems=t,e.checked?this.selectInfos.push({rowIndex:e.rowIndex,columnIndex:e.columnIndex}):this.selectInfos=this.selectInfos.filter((function(t){return t.rowIndex!=e.rowIndex})),console.log("选中的数据: 2",this.selectItems)},onCheckSelectedAll:function(e){console.log("选中全部.: ",e);var t=e.selection;this.selectItems=t},onNext:function(e){this.service.onNext(!!e)},onPre:function(){this.service.onPre()},pageSizeChangeHandle:function(e){this.service.setSize(e)},clean:function(){this.service.clean()},maximizeHandle:function(){this.$message({message:"Esc键退出全屏",type:"success"}),this.$refs.xGrid.maximize()},calculateWidth:function(e){return e.length/1.2*this.fontSize},onLongTextAction:function(e){if("submit-effect"==e.type){if(e.data!=e.row[e.key]){var t=this.effectData.rows,n=t[e.row._XID_VUE_UUID_]||{};this.$set(t,e.row._XID_VUE_UUID_,Object(s["a"])({},n)),t[e.row._XID_VUE_UUID_][e.key]=e.data;var a=this.xgridData.filter((function(t){return t._XID_VUE_UUID_==e.row._XID_VUE_UUID_}));this.$set(a[0],e.key,e.data)}this.$refs.xGrid.clearActived()}else"visiable"==e.type&&(this.longTextVisiable=e.data)},onErrorAction:function(e){console.log("错误关闭：",e)},onNewWorkAction:function(e){"submit"==e?this.onCancel():this.submitLoading=!1},onEexecAction:function(e){"close"==e.type&&0==e.submit&&(this.submitLoading=!1)},onEffectAction:function(e){this.effectData=JSON.parse(JSON.stringify(this.effectDataDefault)),this.$bus.emit("index-result-run",{runTabId:this.runTabId,sql:e})},onCellActived:function(e){var t=e.row,n=e.column,a=this.activeEffect.row;console.log("编辑验证: ",a&&a._XID,t._XID,this.insertOrDeleteRowData),console.log("编辑数据：",t,n),this.insertOrDeleteRowData&&"delete"==this.insertOrDeleteRowData.type&&this.insertOrDeleteRowData.data._XID==t._XID||"insert"!=this.effectData.type&&a&&a._XID!=t._XID?this.onCancel():!this.insertOrDeleteRowData||"insert"!=this.insertOrDeleteRowData.type&&"delete"!=this.insertOrDeleteRowData.type||this.insertOrDeleteRowData.data._XID==t._XID||this.onCancel(),this.handleCancelEditReander=!1,t._XID_TYPE&&t._XID_TYPE!=da||(t._XID_TYPE=da,t["_XID_TYPE_"+n.title]=fa),this.effectData.oldRows[t._XID_VUE_UUID_]||(this.effectData.oldRows[t._XID_VUE_UUID_]=Object(s["a"])({},t)),this.activeEffect={row:t,column:n},this.isEffect=!0},onCellClosed:function(e){var t=e.row,n=e.column;if(this.handleCancelEditReander)this.handleCancelEditReander=!1;else{var a=this.effectData.oldRows,i=this.effectData.oldRows[t._XID_VUE_UUID_],r=i[n.title],o=t[n.title];console.log("原值&修改后的值: 原值：".concat(r,", 修改后：").concat(o));var l=this.effectData.rows;if(o==r)delete t["_XID_TYPE_"+n.title],l[t._XID_VUE_UUID_]&&Object.keys(l[t._XID_VUE_UUID_]).length>0&&delete l[t._XID_VUE_UUID_][n.title],l[t._XID_VUE_UUID_]&&0!=Object.keys(l[t._XID_VUE_UUID_]).length||delete a[t._XID_VUE_UUID_];else if(r!=o){var c=l[t._XID_VUE_UUID_]||{};this.$set(l,t._XID_VUE_UUID_,Object(s["a"])({},c)),l[t._XID_VUE_UUID_][n.title]=o;var u=this.tableInfo.wheres,d=this.effectData.wheres[t._XID_VUE_UUID_];if(!d){d={};var f,h=Object(dn["a"])(u);try{for(h.s();!(f=h.n()).done;){var p=f.value;d[p]=i[p]}}catch(m){h.e(m)}finally{h.f()}this.effectData.wheres[t._XID_VUE_UUID_]=d}}this.isEffect=this.calculateHasEffect()}},calculateHasEffect:function(){return!!(this.effectData.rows&&Object.keys(this.effectData.rows).length>0)&&(this.isEffect=!0,!0)},clearEffectDataAndIsEffect:function(e){if(e){if("delete"==this.effectData.type){this.xgridData.splice(this.insertOrDeleteRowData.index,1),this.selectItems=[],this.selectInfos=[];var t=this.$refs.xGrid;t.clearCheckboxRow(),t.clearCheckboxReserve()}for(var n in this.activeEffect.row)n.startsWith("_XID_TYPE_")&&delete this.activeEffect.row[n];return this.activeEffect.row._XID_TYPE="",this.activeEffect={},this.insertOrDeleteRowData={},this.effectData=JSON.parse(JSON.stringify(this.effectDataDefault)),this.isEffect=!1,!0}if(this.activeEffect&&this.activeEffect.row&&this.activeEffect.row._XID_TYPE)this.activeEffect.row._XID_TYPE="";else{var a=this.selectInfos[this.selectInfos.length-1]&&this.selectInfos[this.selectInfos.length-1].rowIndex,i=this.xgridData[a];i&&(i._XID_TYPE="")}this.insertOrDeleteRowData={},this.effectData=JSON.parse(JSON.stringify(this.effectDataDefault)),this.isEffect=!1},cancelRestoreEffectData:function(){this.submitLoading=!1;var e=this.service.body,t=this.effectData.oldRows,n=this.effectData.rows;if("insert"==this.effectData.type)return console.log("[cancelRestoreEffectData] 还原insert"),!0;if("delete"==this.effectData.type)return console.log("[cancelRestoreEffectData] 还原delete"),!0;if(Object.keys(n).length>0)for(var a in n){var i=t[a],s=n[a],r=e[a];for(var o in s)r[o]=i[o],r["_XID_TYPE"]="",r["_XID_TYPE_"+o]=""}},onEditRenderFocusOrBlur:function(e,t,n){this.longTextVisiable||"blur"!=e.type||this.$refs.xGrid.clearActived()},submitInsertOrDeleteEffectData:function(){var e=this.activeEffect.row;if(!e||!e._XID_TYPE)return this.submitLoading=!1,"insert"==this.effectData.type?(this.$message.error("请完善插入行信息"),!1):(console.error("[submitInsertOrDeleteEffectData] 参数错误：",this.activeEffect,this.effectData),this.$message.error("参数错误"),!1);e._XID_TYPE==ha||e._XID_TYPE==pa||e._XID_TYPE==da?this.confirmEffectData():(console.error("[submitInsertOrDeleteEffectData] 参数错误：",this.activeEffect,this.effectData),this.$message.error("未知错误"))},confirmEffectData:function(){var e=this.activeEffect,t=e.row;e.column;if(t._XID_TYPE!=ha){var n=null,a=this.tableInfo.pks,i=this.effectData.oldRows[t._XID_VUE_UUID_],s=[];if(t._XID_TYPE!=ha&&0==a.length)n="当前表未设置主键，是否继续操作？";else{var r,o=Object(dn["a"])(a);try{for(o.s();!(r=o.n()).done;){var l=r.value;t._XID_TYPE==ha||i.hasOwnProperty(l)||s.push(l)}}catch(f){o.e(f)}finally{o.f()}s.length>0&&(n="当前结果集缺失主键: ".concat(s.join(","),"，是否继续操作？"))}if(null!==n){var c=[],u=this.tableInfo.allColumns;for(var d in i)u.includes(d)&&c.push(d);this.submitEffectData(c,n)}else this.submitEffectData(this.tableInfo.pks)}else this.submitEffectData()},submitEffectData:function(e,t){var n=this,a=this.activeEffect,i=a.row,r=a.column,o="update";o=i._XID_TYPE&&i._XID_TYPE.split("-")[2];var l=this.effectData.oldRows[i._XID_VUE_UUID_];if(i._XID_TYPE!=ha&&i._XID_TYPE!=pa||(l=this.effectData.rows[i._XID_VUE_UUID_]),l[r.title]==i[r.title]&&i._XID_TYPE==da)return this.$message.warning("没有更改数据!"),this.isEffect=!1,void(this.submitLoading=!1);var c={};if(c[i._XID_VUE_UUID_]={},i._XID_TYPE==ha)for(var u in l)u.startsWith(ua)||(c[i._XID_VUE_UUID_][u]=l[u]);else i._XID_TYPE==pa||i._XID_TYPE==da&&(c[i._XID_VUE_UUID_]=Object(s["a"])({},this.effectData.rows[i._XID_VUE_UUID_]));console.log("rowsParams:",c,Object.keys(l));var d=e||this.tableInfo.wheres,f={},h={};console.log("wheres: ",d);var p,m=Object(dn["a"])(d);try{for(m.s();!(p=m.n()).done;){var v=p.value;f[v]=l[v]}}catch(g){m.e(g)}finally{m.f()}h[i._XID_VUE_UUID_]=f;var b=[];b=oe["a"].generateEffects(this.service.execResult.table_name,c,h,o),console.log("sqls: ",b);var E=b.join("\n");this.auditSql(E).then((function(e){var a=e.spend,i=e.data;i.error?n.$refs.dialogErrorRef.show({title:"SQL审计错误",sql:E,error:i.error,spend:a}):i.audit_work?n.onWork(Object(s["a"])(Object(s["a"])({},n.service.data),{},{script:E}),i):n.$refs.dialogExecRef.show(Object(s["a"])(Object(s["a"])(Object(s["a"])({},n.service.data),i),{},{script:"",sql:E}),i,{sql:E},t)}))},auditSql:function(e){var t=this.service.auditResult,n={iid:t.db_id,sql:e,project:this.project.id,encrypt_flag:!1,owner:t.owner,db_type:t.db_type,token:null};return Ln(n)},onDialogExec:function(e){var t=this,n=e.au,a=e.params;this.execSql(Object(s["a"])(Object(s["a"])({},n),{},{sql:a.sql})).then((function(e){e.error?t.$refs.dialogErrorRef.show({title:"SQL执行错误",sql:a.sql,error:e.error,spend:e.spend}):(t.$message.success("数据编辑成功！"),t.clearEffectDataAndIsEffect(!0),t.onCancel())}))},execSql:function(e){var t=this.service.auditResult,n={item_type:this.service.itemType,atk:e.atk,iid:t.db_id,project:this.project.id,sql:e.sql,encrypt_flag:!1,owner:t.owner,db_type:t.db_type,token:e.token};return wn(n)},onWork:function(e){var t={data:e,project:this.project,dataBaseList:this.dataBaseList,selecedDB:this.selecedDB};this.$refs.dialogNewWorkRef.show(t)},setEffectDataWhere:function(e){var t=this;console.log("setEffectDataWhere");var n=this.service.runParams;if(0==Object.keys(n).length)return!1;this.tableInfo.wheres=[],this.tableInfo.pks=[],this.tableInfo.columns=[],this.tableInfo.allColumns=[];var a=this.service.auditResult,i=this.service.execResult;console.log("表结构： params",Object.keys(n).length,a),this.$api.table.info({id:a.db_id,dbType:a.db_type},a.owner,i.table_name,"struct",n.item_type).then((function(e){if(e&&Array.isArray(e)&&e.length>0){var n,i=[],s=[],r=[],o=Object(dn["a"])(e);try{for(o.s();!(n=o.n()).done;){var l=n.value;if("mysql"==a.db_type)"PRI"==l["索引"]?i.push(l["名字"]):s.push(l["名字"]),r.push(l["名字"]);else{if("oracle"!=a.db_type)return t.$message.error("".concat(a.db_type,"类型数据库未支持修改结果集")),!1;"PK"==l["KEY"]?i.push(l["FIELD"]):s.push(l["FIELD"]),r.push(l["FIELD"])}}}catch(u){o.e(u)}finally{o.f()}var c=i&&i.length>0?i:s;console.log("表索引：",i,c),t.tableInfo.wheres=c,t.tableInfo.pks=i,t.tableInfo.columns=s,t.tableInfo.allColumns=r}})).finally((function(){}))},onCellDbClick:function(e){var t=e.row,n=e.column,a=this.filterHead.filter((function(e){return e.label==n.title}))[0];if(t[n.title]){var i=t[n.title].length;i>=20&&this.$refs.dialogLongTextRef.show(Object(s["a"])({},t),n.title,a.type)}},resize:function(){var e=this.$refs["ref-result"];if(e){var t=e.offsetHeight;this.tabHeight=t-38+"px"}},indexMethod:function(e){return 0==e?"#":e+this.service.cli_page*this.service.size},onShowLine:function(){this.showLine=!this.showLine},onShowCheck:function(){this.showCheck=!this.showCheck},onChangeFontSize:function(e){e?this.fontSize=this.fontSize+1:this.fontSize>3&&(this.fontSize=this.fontSize-1),console.log("改变字体大小：",this.fontSize)}}},ga=Ea,ya=(n("635c"),n("ac78"),Object(m["a"])(ga,cn,un,!1,null,"617cb03e",null)),_a=ya.exports,Ta=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"ref-info",staticClass:"result-info"},[n("div",{staticClass:"overflow"},[n("div",{staticClass:"info-item result"},[n("span",[e._v("操作结果：")]),n("i",{staticClass:"icon",class:e.service.result?"el-icon-success icon-success":"el-icon-error icon-error",attrs:{title:e.service.result?"成功":"错误"}})]),n("div",{staticClass:"info-item explain"},[n("span",[e._v("执行计划：")]),n("i",{staticClass:"el-icon-success icon",class:e.service.explain?"icon-success":"el-icon-error icon-disable",attrs:{title:e.service.explain?"执行成功":"未执行"}})]),n("div",{staticClass:"margin-top-20 info-item page-no"},[n("span",[e._v("页码：")]),n("span",[e._v("第 "+e._s(e.service.page+1)+" 页")])]),n("div",{staticClass:"info-item page-size"},[n("span",[e._v("分页大小：")]),n("span",[e._v(e._s(e.service.size)+"条")])]),n("div",{staticClass:"margin-top-20 info-item exc"},[n("span",[e._v("执行： ")]),n("span",{staticClass:"run-sql",attrs:{title:e.service.runSql}},[e._v(e._s(e.service.runSql)+" ")])]),e.service.result?n("div",{staticClass:"exc-sucess"},[e._v(" 共查询 "),n("span",{staticClass:"text-info"},[e._v(e._s(e.service.affected_rows))]),e._v(" 条记录，"+e._s(e.service.resultText)+" ")]):n("div",{staticClass:"info-item exec-error error"},[e._v(" "+e._s(e.service.resultText)+" ")])])])},Ra=[],Sa={name:"result-info",inject:["service","data"],data:function(){return{tabHeight:"150px"}},methods:{resize:function(){var e=this.$refs["ref-info"];if(e){var t=e.offsetHeight;this.tabHeight=t-80+"px"}}},mounted:function(){console.log("this.service",this.service,this.data)}},Ia=Sa,La=(n("80d0"),Object(m["a"])(Ia,Ta,Ra,!1,null,"76e67f05",null)),wa=La.exports,Oa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"ref-export",staticClass:"export-result"},[e.hasExport||e.hasAsync||e.hasSql?n("sql-card-async",{ref:"card-async",attrs:{hasAsynExport:e.hasExport,hasAsynSql:e.hasSql,hasAsynQuery:e.hasAsync,height:e.tabHeight,"run-tab-id":e.runTabId,title:"异步及导出"}}):n("div",{staticClass:"empty"},[e._v("空")])],1)},xa=[],Da=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sql-query-card-async"},[n("div",{staticClass:"inputs"},[n("el-input",{attrs:{size:"mini",placeholder:"筛选导出及异步"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),n("span",{staticClass:"update-time"},[e._v("更新于："+e._s(e.updateTime))])],1),n("div",{staticClass:"overflow"},[e.dataList&&e.dataList.length>0?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"list-items",style:{height:e.height}},e._l(e.filterDataList,(function(t){return n("div",{key:t.id,staticClass:"item",class:{"text-primary":0==t.state,"text-success":1==t.state,"text-error":2==t.state}},[n("div",{staticClass:"hbox-between"},[n("div",{staticClass:"name pointer",attrs:{title:1==t.type?"查看SQL语句、查询异步结果，并显示":"查看SQL语句"},on:{click:function(n){return e.onRun(t)}}},[n("span",[e._v(e._s(e.showFileName(t)))]),0==t.state?n("span",[e._v(" [查询中]")]):e._e(),1==t.state?n("span",[e._v(" [完成]")]):e._e(),2==t.state?n("span",[n("el-tooltip",{attrs:{content:t.result,placement:"bottom"}},[n("span",{staticClass:"name-error"},[e._v(" [失败]")])])],1):e._e()]),n("div"),n("div",{staticClass:"images hbox hbox-center no-user-select"},[1==t.state&&t.data_count>0?n("i",{staticClass:"sn-font pointer click-active",attrs:{title:"下载文件"},on:{click:function(n){return n.stopPropagation(),e.onDownload(t)}}},[e._v("")]):e._e(),n("k-btn-tip",{on:{click:function(n){return e.onDelete(t)}}},[n("i",{staticClass:"pointer sn-font text-error click-active",attrs:{title:"删除"}},[e._v("")])])],1)]),n("div",{staticClass:"time hbox-between"},[n("span",[e._v(e._s(e._f("dateTime")(t.start_time,"MM/DD HH:mm")))]),n("span",[e._v("共"+e._s(t.data_count)+"条/耗时 "+e._s(e.showExecTime(t.exec_time)))])])])})),0):n("div",{staticClass:"empty-body"},[n("span",[e._v("空数据")])])])])},Aa=[],Na={data:function(){return{isLoading:!1,dataList:[],filter:"",updateTime:""}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["selecedDB","runner","service","runList","runActive"])),Object(r["b"])(["run","context"])),{},{filterDataList:function(){var e=this,t=y["filter"](this.dataList,(function(t){return-1!=t.mark.indexOf(e.filter)}));return t},db:function(){return this.service&&this.service.data?{id:this.service.data.id}:{}},owner:function(){return this.service&&this.service.data?{id:this.service.data.owner}:{}}}),props:{height:{default:"150px"},title:{},type:{},index:{type:Number,default:function(){return 0}},hasAsynExport:{type:Boolean,default:function(){return!1}},hasAsynQuery:{type:Boolean,default:function(){return!1}},hasAsynSql:{type:Boolean,default:function(){return!1}},runTabId:{}},watch:{},methods:{showExecTime:function(e){if(!e)return"0毫秒";if(e<1e3)return e+"毫秒";var t=Math.floor(e/1e3/3600%24),n=Math.floor(e/1e3/60%60),a=Math.floor(e/1e3%60),i=a+"秒";return n>0&&(i=n+"分"+i),t>0&&(i=t+"小时"+i),i},canDownloads:function(e){var t=1==e.state&&e.data_count>0;return 1==e.type||2==e.type?t&&this.hasAsynExport:t&&this.hasAsynSql},showFileName:function(e){var t="";if(e.file_name){var n=e.file_name.split(".");n.length>1&&(t="."+n[1])}var a="";return a=1==e.type?"[异步] ":3==e.type?"[SQL] ":"[导出] ",a+e.mark+t},onRun:function(e){var t=this;this.$store.commit("resultJumpLoading",!0),this.service.clean();var n={hasAsynQuery:this.hasAsynExport,hasAsynExport:this.hasAsynExport,index:this.runList[this.runActive].index,id:e.db_id,db_id:e.db_id,name:e.mark,db_type:e.db_type,dbType:e.db_type,script:e.script,async:e.id,owner:e.owner},a=1==e.type?11:3==e.type?13:-1;console.log("item: ",e);var i={mode:"查询-异步",sql:n.script,id:e.id,name:e.mark,comment:!0,command:a,dbName:n.owner};this.selecedDB&&this.selecedDB.instance&&(i.dbName=this.selecedDB.instance.label,i.dbType=this.selecedDB.instance.db_type,i.rw=this.selecedDB.instance.rw),this.selecedDB&&this.selecedDB.source&&(i.sourceName=this.selecedDB.source.label),n.script=oe["a"].generate(i);var s=oe["a"].parserComments(n.script);if(console.log("[card.async methods] onRun: ",n,e),this.service.setData(n,!0),1==e.type){var r=this.service.onRunAsyncData(null,null,{mode:s});Promise.all([r]).then((function(e){console.log("[coard.async methods] onRun - 1：",t.runTabId),t.$bus.emit("index-result-change-tab_".concat(t.runTabId),"result")})).catch((function(){t.$store.commit("resultJumpLoading",!1)}))}else this.$store.commit("resultJumpLoading",!1)},onAsync:function(){var e=this;console.log("获取导出及异步列表...",this.run),this.isLoading=!0,clearTimeout(this.timeId),this.$api.task.asyncList(this.run.id,this.run.dbType,this.run.owner).then((function(t){var n=t.dataList,a=t.isComplete;e.dataList=n,a?clearTimeout(e.timeId):e.timeId=setTimeout((function(){e.onAsync()}),5e3)})).finally((function(){e.isLoading=!1,e.updateTime=X()(new Date).format("MM-DD HH:mm:ss")}))},onChangeDB:function(){var e=this,t=this.runList.filter((function(t){return e.runTabId==t.tabId})),n=t[0];console.log("card.async.vue onChangeDB",this.runTabId,n),this.onAsync()},onDownload:function(e){var t=window.localStorage.getItem("token");1==e.type?this.$api.download("/api/sql/task/async/downloads",{id:e.id,access_token:t}):2!=e.type&&3!=e.type||this.$api.download("/api/sql/task/export/downloads",{id:e.id,access_token:t})},onDelete:function(e){var t=this;this.$api.task.asyncRemove(e).then((function(){t.onSuccess("删除成功"),t.onChangeDB()}))}},created:function(){var e=this;console.log("dbUtils - :",oe["a"]),this.$bus.on("on-selectdb-".concat(this.runTabId),(function(t){e.onChangeDB()}))},mounted:function(){console.log("runTabId:xxx ",this.runTabId),this.onChangeDB(),this.$bus.on("runExport",this.onAsync)},beforeDestroy:function(){console.log("销毁 on runExport"),this.$bus.off("runExport")}},Ca=Na,ka=(n("5836"),Object(m["a"])(Ca,Da,Aa,!1,null,null,null)),Ua=ka.exports,Pa={components:{SqlCardAsync:Ua},props:{runTabId:{}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["sys","runList","runActive"])),Object(r["b"])(["run"])),{},{currentRun:function(){var e=this,t=this.runList.filter((function(t){return t.tabId==e.runTabId}));return t.length>0?t[0]:{}},hasSql:function(){return console.log("currentRun改变了: ",this.currentRun),this.sys.asyn_sql&&this.currentRun.hasAsynSql},hasAsync:function(){return this.sys.asyn_query&&this.currentRun.hasAsynQuery},hasExport:function(){return console.log("this.runList.length ",this.runList.length,this.currentRun),this.sys.asyn_export&&this.currentRun.hasAsynExport}}),mounted:function(){console.log("xxxx----------:2")},methods:{onAsync:function(){console.log("查询导出及异步：",this.$refs["card-async"]),console.log(this.sys,this.currentRun,this.runList[this.runActive]),this.$refs["card-async"]&&this.$refs["card-async"].onAsync()},resize:function(){var e=this.$refs["ref-export"];if(e){var t=e.offsetHeight;this.tabHeight=t-80+"px"}}},data:function(){return{tabHeight:"150px"}}},Ma=Pa,ja=(n("ea87"),Object(m["a"])(Ma,Oa,xa,!1,null,"2ddd2c53",null)),$a=ja.exports,Fa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"ref-history",staticClass:"result-history"},[n("div",{staticClass:"inputs"},[n("el-input",{attrs:{size:"mini",placeholder:"筛选历史操作"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),n("span",{staticClass:"update-time"},[e._v("更新于："+e._s(e.updateTime))])],1),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"overflow",style:{height:e.tabHeight}},[n("div",{staticClass:"lists"},e._l(e.dataList,(function(t){return n("div",{key:t.id,staticClass:"item hbox hbox-center"},[n("div",{staticClass:"sql"},[n("span",{staticClass:"time"},[e._v("["+e._s(e.showTime(t.start_time))+"]")]),n("span",{staticClass:"sql-code",class:{"text-primary":1==t.state,"text-error":1!=t.state},on:{click:function(n){return e.onSelect(t)}}},[e._v(e._s(t.script))])])])})),0),e.dataList&&0!=e.dataList.length?e._e():n("div",{staticClass:"empty"},[e._v(" 空数据 ")])])])},Ba=[],qa={data:function(){return{keyword:"",dataList:[],tabHeight:"150px",loading:!1,updateTime:""}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["runner","project","service","runList","selecedDB"])),Object(r["b"])(["run"])),{},{db:function(){return this.service&&this.service.data?{id:this.service.data.id}:{}}}),props:{runTabId:{}},watch:{keyword:y["debounce"]((function(){this.refresh()}),300)},methods:{resize:function(){var e=this.$refs["ref-history"];if(e){var t=e.offsetHeight;this.tabHeight=t-80+"px"}},showTime:function(e){return X()(new Date(e)).format("MM-DD HH:mm")},refresh:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$api.sql.history(e.project.id,e.db.id,e.run.owner,e.keyword);case 3:e.dataList=t.sent,e.updateTime=X()(new Date).format("MM-DD HH:mm:ss"),e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},onSelect:function(e){var t=e.script,n={command:62,comment:!0,sql:t,dbType:e.db_type};this.selecedDB&&this.selecedDB.instance&&(n.dbName=this.selecedDB.instance.label),this.selecedDB&&this.selecedDB.source&&(n.sourceName=this.selecedDB.source.label),t=oe["a"].generate(n),console.log("历史记录：",t),this.service.insertSQL(t)}},created:function(){},mounted:function(){},beforeDestroy:function(){console.log("销毁 on runExport"),this.$bus.off("runHistory")}},Ha=qa,Va=(n("eb09"),Object(m["a"])(Ha,Fa,Ba,!1,null,"fe66b1d4",null)),Wa=Va.exports,Ga=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"ref-work",staticClass:"result-work"},[n("el-form",{ref:"searchForm",staticClass:"search-container",attrs:{size:"small",inline:!0}},[n("div",{staticStyle:{"margin-left":"15px"}},[n("el-form-item",{attrs:{label:"项目",prop:"project",size:"mini"}},[n("el-select",{staticStyle:{"margin-right":"15px","max-width":"150px"},attrs:{size:"small",placeholder:"请选择项目"},on:{change:e.selProject},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},[n("el-option",{attrs:{label:"全部",value:0}}),e._l(e.projectList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),n("el-form-item",{attrs:{label:"时间范围:"}},[n("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"],"picker-options":e.$constant.pickOptions},model:{value:e.search.dateRange,callback:function(t){e.$set(e.search,"dateRange",t)},expression:"search.dateRange"}})],1),n("el-form-item",{attrs:{label:"工单名称",prop:"name",size:"mini"}},[n("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),n("el-form-item",{staticStyle:{float:"right"}},[e._t("searchs-right"),n("el-button",{staticClass:"add-btn",attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("搜索")]),n("el-button",{staticClass:"add-btn",on:{click:e.onReset}},[e._v("重置")])],2),n("div",{staticClass:"clearfix"})],1)]),n("div",{style:{height:e.tabHeight}},[n("vxe-table",{attrs:{border:"",resizable:"",height:"auto",width:"auto","highlight-hover-row":"","auto-resize":"","show-header-overflow":"title","show-overflow":"title",data:e.dataList,loading:e.loading}},[n("vxe-table-column",{attrs:{type:"expand",width:"40"},scopedSlots:e._u([{key:"content",fn:function(t){var a=t.row;return[n("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left","label-width":"100px"}},[n("el-form-item",{attrs:{label:"数据源类型"}},[n("el-tag",{attrs:{type:"danger"}},[e._v(e._s(a.db_type))])],1),n("el-form-item",{attrs:{label:"数据源/数据库"}},[n("el-tag",{attrs:{type:"danger"}},[e._v(e._s(a.db_name+"/"+a.owner))])],1),n("el-form-item",{attrs:{label:"SQL"}},[a.sql&&a.sql.length>3e3?n("strong",{staticClass:"sql"},[e._v(" SQL语句过长，请在详情查看 ")]):n("pre",{staticClass:"sql"},[e._v(e._s(a.sql))])])],1)]}}])}),n("vxe-table-column",{attrs:{field:"name",title:"工单名称"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"text"},on:{click:function(t){return e.goWorkDetail(a)}}},[e._v(e._s(a.name))])]}}])}),n("vxe-table-column",{attrs:{field:"type",title:"工单类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",{attrs:{title:e.showWorkType(a.type)}},[e._v(e._s(e.showWorkType(a.type)))])]}}])}),n("vxe-table-column",{attrs:{field:"created_at",title:"申请时间"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._v(" "+e._s(e._f("dateTime")(n.created_at))+" ")]}}])}),n("vxe-table-column",{attrs:{field:"status",title:"工单状态"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",{class:e.showTagType(a.status)},[e._v(" "+e._s(e.showStatus(a.status))+" ")])]}}])}),n("vxe-table-column",{attrs:{field:"back_up",title:"是否备份",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1==a.back_up?n("span",[e._v("是")]):n("span",[e._v("否")])]}}])}),n("vxe-table-column",{attrs:{title:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{size:"mini",type:"info",title:"详情"},on:{click:function(t){return e.goWorkDetail(a)}}},[e._v(" 详情 ")]),6!=a.status||3!=a.type&&4!=a.type&&5!=a.type?e._e():[4==a.type?n("el-button",{attrs:{title:"下载",size:"mini",type:"info"},on:{click:function(t){return e.moreHandler(a.type,a)}}},[e._v(" 下载 ")]):n("el-button",{attrs:{title:"查询",size:"mini",type:"info"},on:{click:function(t){return e.moreHandler(a.type,a)}}},[e._v(" 查询 ")])],6==a.status&&1==a.back_up?n("el-button",{attrs:{title:"备份",size:"mini",type:"info"},on:{click:function(t){return e.goWorkBackUp(a)}}},[e._v(" 备份 ")]):e._e()]}}])})],1)],1),n("vxe-pager",{attrs:{background:"",size:"small",loading:e.loading,"current-page":e.pageNo,"page-size":e.pageSize,total:e.total,"page-sizes":[10,20,100],layouts:["PrevPage","JumpNumber","NextPage","FullJump","Sizes","Total"]},on:{"page-change":e.onPageChange}}),n("dialog-backup",{ref:"backupDialog",on:{hide:e.hide}}),n("dialog-detail",{ref:"detailDialog",on:{refresh:e.refresh}})],1)},Xa=[],Ya={components:{DialogDetail:Q["a"],DialogBackup:K["a"]},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["runner","project","sqlTypes","service","runActive","runList"])),Object(r["b"])(["showWorkType"])),{},{searchAdvance:function(){var e=Object(s["a"])({},this.search);return e.dateRange&&e.dateRange.length>=2&&(e.start=X()(e.dateRange[0]).format("YYYY-MM-DD HH:mm:ss"),e.end=X()(e.dateRange[1]).format("YYYY-MM-DD HH:mm:ss"),delete e.dateRange),e}}),data:function(){return{projectId:0,projectList:[],loading:!1,pageNo:0,pageSize:10,dataList:[],total:0,tabHeight:"200px",isShow:!1,search2:{db_type:null},dateRange:[X()().startOf("d").toDate(),X()().endOf("d").toDate()],search:{dateRange:null,db_type:null,project:0,name:"",status:-1},status_types:[{k:"0",v:"全部"},{k:"1",v:"待审核"},{k:"2",v:"已通过"},{k:"3",v:"未通过"}]}},props:{runTabId:{}},watch:{searchAdvance:{handler:_.a.debounce((function(){this.load(this.searchAdvance)}),500,{leading:!0})}},mounted:function(){this.getProjectList()},created:function(){this.load(this.searchAdvance)},methods:{getProjectList:function(){var e=this;this.$api.my.myProjectList().then((function(t){e.projectList=t||[]}))},selProject:function(){this.onSearch()},showTagType:function(e){return this.$api.work.showTagType(e)},onTableRowClassName:function(e,t){return 1===t?"info-row":3===t?"positive-row":""},onPageChange:function(e){this.pageSize=e.pageSize,this.pageNo=e.currentPage,this.load(this.searchAdvance)},onSizeChange:function(e){this.size=e,this.search()},onSearch:function(){this.load(this.searchAdvance)},onReset:function(){console.log("onReset: ")},load:function(e){var t=this;this.loading=!0,e=e||this.searchAdvance||{},e.page_no=this.pageNo>=1?this.pageNo-1:this.pageNo,e.page_size=this.pageSize,e.project=this.projectId,this.$api.page("/api/my/work/list",e).then((function(e){e.length?(t.dataList=e,t.total=e.length):(t.dataList=e.data||e.list,t.total=e.total||e.count),t.$emit("total",t.total),t.$emit("data",t.dataList)})).finally((function(){t.loading=!1}))},resize:function(){var e=this.$refs["ref-work"];if(e){var t=e.offsetHeight;this.tabHeight=t-30-51-32+"px"}},goWorkBackUp:function(e){this.$refs.backupDialog.show(e.id,!1)},goWorkDetail:function(e){this.$refs.detailDialog.show(e.id,!0)},moreHandler:function(e,t){var n=this,a={db_id:t.db_id,owner:t.owner,db:t.db_name,dbType:t.db_type,script:t.sql,token:Object(le["a"])()},i=oe["a"].generate({sql:t.sql,comment:!0,mode:3==e?"在线查询-工单":"快照查询-工单",id:t.id,name:t.name,src:t.db_name,db:t.owner,db_type:t.db_type});a.script=i;var s=oe["a"].parserComments(a.script);if(3==e){this.$store.commit("resultJumpLoading",!0),this.service.assignData(a,!0);var r=this.service.onRunNormal(!1,null,{single_script:i,mode:s});Promise.all([r]).then((function(){console.log("[result.work methods] 在线查询：",n.service.data),n.$bus.emit("index-result-change-tab_".concat(n.runTabId),"result")})).catch((function(e){console.log("[result.work methods] #moreHandler(请求错误)",e),n.$store.commit("resultJumpLoading",!1)})).finally((function(){n.$store.commit("resultJumpLoading",!1)}))}else if(4==e){var o=window.localStorage.getItem("token");this.$api.download("/api/sql/task/export/downloads",{id:t.id,access_token:o})}else 5==e&&(this.$store.commit("resultJumpLoading",!0),this.service.assignData(a,!0),this.onShowAsyncData(t,s));console.log("moreHandler: ",e,t)},onShowAsyncData:function(e,t){var n=this,a=this.service.onRunAsyncData(null,null,{mode:t,async:e.id});Promise.all([a]).then((function(){console.log("[result.work methods] 快照查询：",n.service.data),n.$bus.emit("index-result-change-tab_".concat(n.runTabId),"result")})).catch((function(){n.$store.commit("resultJumpLoading",!1)}))},onExportFile:function(){},onDownload:function(e){var t=window.localStorage.getItem("token");4==e.type?this.$api.download("/api/sql/task/export/downloads",{id:e.id,access_token:t}):e.type},onCancel:function(e){var t=this;this.$api.work.cancel({id:e.id,cancel_remark:e.cancel_remark,flag:2}).then((function(e){t.onSuccess("取消成功"),t.init()}),(function(e){var n="参数错误！";"301"!=e.result&&(n=e.data),t.onError(n)}))},showStatus:function(e){return this.$api.work.showStatus(e)},show:function(){var e=this;console.log("==================================== start"),console.dir(this.runner),console.log("==================================== end"),this.isShow=!0,this.$nextTick((function(){e.refresh()}))},hide:function(){this.drawer=!1},refresh:function(){this.project?this.search.project=this.project.id:this.search.project=0},resetSearch:function(){console.log("========resetSearch========="),this.search={project:this.project.id}},reload:function(){this.$refs.st.reload()},onSync:function(e){var t=this;2==e.con_state?this.$api.db.refresh(e.id).then((function(e){t.onSuccess(e),t.reload()})):this.onSuccess("请修复连接后再进行操作！")},onDel:function(e){var t=this;this.$api.db.delete(e.id).then((function(){t.onSuccess("删除成功"),t.reload()}))}}},za=Ya,Qa=(n("f93b"),n("324f"),Object(m["a"])(za,Ga,Xa,!1,null,"771e130f",null)),Ka=Qa.exports,Ja={inject:["data","service"],provide:function(){return{data:this.data}},data:function(){return{tabsValue:"result",workTotal:0}},computed:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["user","runner","project","exportCount","selecedDB","resultJumpLoading"])),{},{infoDisable:function(){return this.service.loading},db:function(){return this.service&&this.service.data?{id:this.service.data.id}:{}},owner:function(){return this.service&&this.service.data?{id:this.service.data.owner}:{}},queryKeymap:function(e){return{}},count:function(){var e="_default";Boolean(this.db)&&Boolean(this.owner)&&(e="".concat(this.db.id,"_").concat(this.owner.id));var t=this.exportCount[e];return void 0===t?"0":t}}),props:{runTabId:{}},watch:{tabsValue:function(e,t){var n=this;console.log("tabsValue: ",e,t),this.$nextTick((function(){n.onResize()}))}},methods:{onTotalHandler:function(e){},triggerTab:function(e){this.tabsValue!=e&&(this.tabsValue=e)},onFavorite:function(){var e=Object(s["a"])({},this.data);this.$refs.dialogFavorite.show(e)},onAsync:function(e){var t=this;this.$refs.dialogAsync.show((function(n){t.service.onRunAsync(Object(s["a"])(Object(s["a"])({},n),e)).then((function(e){e&&e.error?ln["Message"].error({title:"请求失败",message:e.error,type:"error",duration:4e3}):t.$bus.emit("runExport")})).catch((function(e){ln["Message"].error({title:"请求失败",message:e?e.error:e,type:"error",duration:4e3})}))}))},onExport:function(e){var t=this;this.$refs.dialogExport.show((function(n){t.service.onRunAsync(Object(s["a"])(Object(s["a"])({},n),e)).then((function(e){e&&e.error?ln["Message"].error({title:"请求失败",message:e.error,type:"error",duration:4e3}):t.$bus.emit("runExport")})).catch((function(e){ln["Message"].error({title:"请求失败",message:e?e.error:e,type:"error",duration:4e3})}))}))},onResize:function(e){console.log("[ritht.vue methods] onResize()");var t=document.createEvent("HTMLEvents");t.initEvent("resize",!0,!0),window.dispatchEvent(t),this.$refs["tab-result"].resize(),this.$refs["tab-info"].resize(),this.$refs["tab-export"].resize(),this.$refs["tab-history"].resize(),this.$refs["tab-work"].resize()},resetAsyncList:function(e){"export"==e&&this.$refs["tab-export"].onAsync()},loadWorkList:function(e){"work"==e&&this.$refs["tab-work"].load()},resetHistoryList:function(e){"history"==e&&this.$refs["tab-history"].refresh()},onResultClick:function(e){var t=this,n=e.name;console.log("延迟设置高度，并获取列表...",n),setTimeout((function(){n?(t.$refs["tab-".concat(n)].resize(),t.resetAsyncList(n),t.resetHistoryList(n),t.loadWorkList(n)):t.onResize()}),600)}},components:{DialogAsync:Gt,DialogExport:Jt,DialogFavorite:sn,SplitPane:on.a,"result-result":_a,"result-info":wa,"result-export":$a,"result-history":Wa,"result-work":Ka},mounted:function(){var e=this.$el.getElementsByTagName("pre")[0];this.service.init(e,this.data,this.project),console.log("service 初始化",this.data,this.project),this.service.onAsync=this.onAsync,this.service.onExport=this.onExport},created:function(){var e=this,t=this;this.$bus.on("index-result-change-tab_".concat(this.runTabId),(function(n){e.$store.commit("resultJumpLoading",!1),t.tabsValue=n,console.log("[tab right index.vue] on index-result-change-tab_".concat(e.runTabId,":"),n)})),this.$bus.on("current-tab_".concat(this.runTabId,"-exec"),(function(n){if(n&&"object"==$t(n)&&n.type)switch(n.type){case"change-tab":t.tabsValue=n.value;break;case"exec-cleanInfo":t.cleanInfo();break}else console.warn("current-tab_".concat(e.runTabId,"-exec"),"参数错误：",n)}))},beforeDestroy:function(){this.$bus.off("index-result-change-tab_".concat(this.runTabId)),this.$bus.off("current-tab_".concat(this.runTabId,"-exec"))}},Za=Ja,ei=(n("7660"),n("8688"),Object(m["a"])(Za,Mt,jt,!1,null,null,null)),ti=ei.exports;function ni(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ai(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ii(e,t,n){return t&&ai(e.prototype,t),n&&ai(e,n),e}var si=n("4360"),ri=n("f9ae"),oi=n.n(ri),li=n("2909"),ci={template1:[{}],template2:{},sql:null,mysql:null,pgsql:null,oracle:null,mongodb:null},ui=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,a,i,s,r,o,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!ci[t]){e.next=2;break}return e.abrupt("return");case 2:if(n=languagesmore.getLanguage(t,!0),n){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,n.loader();case 7:a=e.sent,i=a.language,s=fi(i.keywords,"Keyword","关键字"),r=fi(i.operators,"Operator","分隔符"),o=fi(i.builtinFunctions,"Function","方法"),l=[].concat(Object(li["a"])(s),Object(li["a"])(r),Object(li["a"])(o)),ci[t]=l;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),di={Keyword:" ",Function:"()",Operator:""},fi=function(e,t,n){return n=n||"",e.map((function(e){var a=null;return a="Function"==t&&languagesmore.functionExt[e]?"".concat(e).concat(languagesmore.functionExt[e]):e+di[t],{label:e,insertText:a,kind:monaco.languages.CompletionItemKind[t],detail:n,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet}}))},hi=function(e){return ui(e),ci[e]},pi=function e(t){if(ni(this,e),Object(Ne["a"])(this,"databaseLanguage",void 0),Object(Ne["a"])(this,"suggs",void 0),Object(Ne["a"])(this,"get",Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ui(this.databaseLanguage);case 2:return t=ci[this.databaseLanguage],console.log("[service.auto.db.dbsuggest] get: ",this.databaseLanguage,ci),e.abrupt("return",t||[]);case 5:case"end":return e.stop()}}),e,this)})))),!t)throw console.error("databaseLanguage必填：",t),"databaseLanguage undefined";console.log("dbsuggest constructor :",t),this.databaseLanguage=t,this.suggs=hi(t)},mi={"表":monaco.languages.CompletionItemKind.Class,"列":monaco.languages.CompletionItemKind.Property},vi={},bi=function(){function e(t){ni(this,e),Object(Ne["a"])(this,"data",void 0),Object(Ne["a"])(this,"dbSuggest",void 0),Object(Ne["a"])(this,"tables",void 0),Object(Ne["a"])(this,"columns",void 0),this.data=t,this.dbSuggest=new pi(this.data.databaseLanguage)}return ii(e,[{key:"registerCompletionItemProvider",value:function(e){if(this.data&&this.data.databaseLanguage){var t=this,n="".concat(this.data.tabId,"_").concat(this.data.databaseLanguage);vi.hasOwnProperty(n)&&vi[n].dispose();var a=this.data,i=monaco.languages.registerCompletionItemProvider(this.data.databaseLanguage,{provideCompletionItems:function(){var n=Object(c["a"])(regeneratorRuntime.mark((function n(i,s){var r,o,l,c,u,d,f,h,p,m,v,b,E,g,y;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.getModel()!==i){n.next=21;break}return r=s.lineNumber,o=s.column,l=i.getFullModelRange(),c=i.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:r,endColumn:o}).replace(/\/\*(.|\n)*\*\//g,"\n"),u=i.getValueInRange({startLineNumber:r,startColumn:o,endLineNumber:l.endLineNumber,endColumn:l.endColumn>100?100:l.endColumn}).replace(/^\s*--.*/gm,"\n").replace(/\/\*(.|\n)*\*\//g,"\n"),d="",f="",h=c.split(/\n{2,}|\r{2,}|(\r\n){2,}|;/gm),p=t.getEndText(h),m=oe["a"].parserComments(p),console.log("解析SQL：",m),d=p.replace(/^\s*--.*/gm,""),v=u.split(/\n{2,}|\r{2,}|(\r\n){2,}|;/gm),f=t.getStartText(v),b=d+" "+f,console.info("自动提示获取的sql: ",b),E=i.getWordUntilPosition(s),g={startLineNumber:s.lineNumber,endLineNumber:s.lineNumber,startColumn:E.startColumn,endColumn:E.endColumn},y=[],n.next=20,t.autoKeys(a,y,b,d,g,m);case 20:return n.abrupt("return",{suggestions:y});case 21:case"end":return n.stop()}}),n)})));function i(e,t){return n.apply(this,arguments)}return i}(),triggerCharacters:["."]});vi[n]=i}else console.warn("[service.auto.db.js] registerCompletionItemProvider() databaseLanguage数据错误：",this.data)}},{key:"autoKeys",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n,a,i,s){var r,o,l,c,u,d,f,h,p,m,v,b=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=b.length>5&&void 0!==b[5]?b[5]:null,o=r&&r.db?r.db:t.owner,l=a.split(/\s+|,|;/),c=this.isMatch2(/^([^\.]+)\.$/,i),!c){e.next=17;break}if(u=c[1],d=null,this.tables&&this.tables.indexOf(u)>-1?d=u:(f=l.indexOf(u),f>0&&(d=l[f-1])),!d){e.next=15;break}return console.log("查询字段...this.data"),e.next=12,S["default"].auto.meta(t.id,"".concat(o,".").concat(d),"列");case 12:return h=e.sent,this._convert2Suggestions(n,h,"列",s),e.abrupt("return");case 15:e.next=23;break;case 17:return console.log("查询表...this.data"),e.next=20,S["default"].auto.meta(t.id,o,"表");case 20:p=e.sent,this._convert2Suggestions(n,p,"表",s),this.setTables(p);case 23:return e.next=25,this.dbSuggest.get();case 25:for(v in m=e.sent,m)m[v]["range"]=s;n.push.apply(n,Object(li["a"])(m));case 28:case"end":return e.stop()}}),e,this)})));function t(t,n,a,i,s){return e.apply(this,arguments)}return t}()},{key:"_convert2Suggestions",value:function(e,t,n,a){var i=mi[n];if(t&&t.length>0)for(var s=0;s<t.length;s++){var r=t[s];e.push({label:r.name,kind:i,insertText:r.value,range:a,detail:n})}}},{key:"setTables",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].value);this.tables=t}},{key:"isMatch2",value:function(e,t){var n=this.toExp2(t);n=n.split(/,|\(/).pop();var a=e.exec(n);return a}},{key:"toExp2",value:function(e){var t=/\s([^\s]+)$/.exec(e);return t?t[1]:""}},{key:"getStartText",value:function(e){for(var t=0;t<e.length;t++){if(void 0==e[t])return"";if(""!=e[t])return e[t].trim()}return""}},{key:"getEndText",value:function(e){for(var t=e.length-1;t>=0;t--){if(void 0==e[t])return"";if(""!=e[t])return e[t].trim()}return""}},{key:"isMatch",value:function(e,t,n){var a=this.toExp(t,n),i=e.exec(a);return i}},{key:"toExp",value:function(e,t){var n=e.getLine(t.row).substring(0,t.column),a=/\s([^\s]+)$/.exec(n);return a?a[1]:""}}]),e}();console.log("执行一次"),languagesmore.about(),languagesmore.init(["oracle","custom-redis"],{suggest:!1});var Ei=function(){function e(t,n,a){ni(this,e),Object(Ne["a"])(this,"editorType","monaco"),Object(Ne["a"])(this,"index",void 0),Object(Ne["a"])(this,"editor",void 0),Object(Ne["a"])(this,"bus",void 0),Object(Ne["a"])(this,"data",void 0),Object(Ne["a"])(this,"project",void 0),Object(Ne["a"])(this,"token",void 0),Object(Ne["a"])(this,"auto",void 0),Object(Ne["a"])(this,"itemType","table"),Object(Ne["a"])(this,"head",[]),Object(Ne["a"])(this,"filterHead",[]),Object(Ne["a"])(this,"body",{}),Object(Ne["a"])(this,"rowUnique","_XID_VUE_UUID_"),Object(Ne["a"])(this,"rows",{}),Object(Ne["a"])(this,"colsWidth",{}),Object(Ne["a"])(this,"hasNext",!1),Object(Ne["a"])(this,"colsMaxLength",60),Object(Ne["a"])(this,"colsMinLength",8),Object(Ne["a"])(this,"affected_rows",0),Object(Ne["a"])(this,"result",!0),Object(Ne["a"])(this,"encrypt_sql",!1),Object(Ne["a"])(this,"encrypt_flag",!1),Object(Ne["a"])(this,"resultText",""),Object(Ne["a"])(this,"queryType",""),Object(Ne["a"])(this,"mode",!1),Object(Ne["a"])(this,"auditResult",{}),Object(Ne["a"])(this,"runParams",{}),Object(Ne["a"])(this,"execResult",{}),Object(Ne["a"])(this,"errorText",""),Object(Ne["a"])(this,"loading",!1),Object(Ne["a"])(this,"explain",!1),Object(Ne["a"])(this,"runSql",""),Object(Ne["a"])(this,"page",0),Object(Ne["a"])(this,"size",10),Object(Ne["a"])(this,"cli_page",0),Object(Ne["a"])(this,"pastePosition",{}),console.info("[service.js] service constructor：",t,n),this.setSize(),this.index=t,this.data=n,this.data.db_id=this.data.id,this.bus=a,this.supportLanguage(),this.auto=new bi(this.data)}return ii(e,[{key:"setSize",value:function(e){this.size="number"!==typeof e||isNaN(e)?si["a"].state.pageSize?si["a"].state.pageSize:this.size:e,si["a"].commit("setPageSize",this.size),console.log("[service.js setSize()] 设置：",e,this.size)}},{key:"supportLanguage",value:function(){this.data.dbType&&-1!=["sql","postgres","oracle","mysql","mssql","mongodb","redis","doris"].indexOf(this.data.dbType)?"redis"==this.data.dbType?this.data.databaseLanguage="custom-redis":this.data.databaseLanguage=this.data.dbType:this.data.databaseLanguage="mycat"==this.data.dbType?"mysql":"sql"}},{key:"update",value:function(e){if(console.log("[service.js] xxxxxxxx : data",e.name),this.data=Object(s["a"])(Object(s["a"])({},e),{},{db_id:e.id}),this.supportLanguage(),this.updateEditor(),this.auto=new bi(this.data),!this.editor)return console.warn("[service.js] update() this.editor is undefined：",this.editor);this.auto.registerCompletionItemProvider(this.editor)}},{key:"updateEditor",value:function(){var e=this.editor.getModel();console.log("[service.js] updateEditor(): ",e.id),monaco.editor.setModelLanguage(e,this.data.databaseLanguage)}},{key:"init",value:function(e,t,n){var a=this,i=this;this.data=Object(s["a"])(Object(s["a"])({},t),{},{db_id:t.id}),this.project=n,console.info("[service.js class] init 初始化参数：",this.index,this.data.dbType,this.data.databaseLanguage),this.setSize();var r=monaco.editor.create(e,{value:t.script,language:this.data.databaseLanguage,theme:"vs",automaticLayout:!0,selectionHighlight:!0,wordWrap:"on",scrollbar:{useShadows:!1,verticalHasArrows:!0,horizontalHasArrows:!0,vertical:"hidden",horizontal:"hidden",verticalScrollbarSize:0,horizontalScrollbarSize:17,arrowSize:30}});this.editor=r,this.auto.registerCompletionItemProvider(this.editor),this.editor.setValue||(this.editor.setValue=r.getModel().setValue()),this.editor.getSelectedText||(this.editor.getSelectedText=function(){var e=r.getModel().getValueInRange(r.getSelection());return e}),this.editor.clearSelection||(r.clearSelection=function(){i.editor.setPosition(i.editor.getPosition())}),this.editor.addAction({id:"exec-sql",label:"执行SQL",keybindings:[monaco.KeyMod.Alt|monaco.KeyCode.KEY_R],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){return i.onRun(),null}});var o=this.editor.getModel();Object(u["b"])("historyList",{}).then((function(e){console.info("[service.js] init  获取历史记录列表：",e,a.data.index,e[a.data.index]),languagesmore.setEditStack(o,e[a.data.index])})),this.editor.onDidChangeModelContent((function(e){if(-1!=si["a"].state.MAX_LINE){var t=a.editor.getModel().getLineCount();if(t>si["a"].state.MAX_LINE)return void si["a"].commit("isMaxLine",si["a"].state.isMaxLine+1);si["a"].commit("isMaxLine",0)}var n=languagesmore.getEditStack(o,10);si["a"].commit("saveHistory",{history:n,index:a.data.index}),si["a"].commit("updateScript",{script:a.editor.getValue(),index:a.data.index})})),console.info("monaco editor init end...")}},{key:"emit",value:function(e,t){this.bus.emit("".concat(this.index,".").concat(e),t)}},{key:"setFontSize",value:function(e){e&&"ace"==this.editorType.toLowerCase()?this.editor.setOptions({fontSize:"".concat(e,"px")}):e&&this.editor.updateOptions({fontSize:e})}},{key:"assignData",value:function(e,t){Object.assign(this.data,e),Object.assign(this.auto.data,e),e.script&&(t?this.insertSQL(e.script):this.setSQL(e.script))}},{key:"setData",value:function(e,t){this.data=e,this.auto.data=e,this.data.script&&(t?this.insertSQL(this.data.script):this.setSQL(this.data.script))}},{key:"getCursorRange",value:function(){var e=this.editor.getPosition();return{startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column}}},{key:"insertSQL",value:function(e,t){this.page=0,this.cli_page=0;var n=Object(s["a"])({clean:!1,selection:this.editor.getSelection(),wrap:[0,0]},t);this.editor.executeEdits(null,[{range:n.selection,text:e,forceMoveMarkers:!1}]),console.log("[service.js#insertSQL()]: ",this.editor.getModel().id,n.selection,this.editor.getSelection()),this.editor.focus(),n.clean&&this.clean()}},{key:"clean",value:function(e){this.colsWidth={},this.head=[],this.filterHead=[],this.body={},this.affected_rows=0,this.resultText="",this.runParams={},this.execResult={},e&&(this.explain=!1,this.page=0,this.cli_page=0,this.hasNext=!1)}},{key:"onReset",value:function(){this.explain=!1,this.page=0,this.cli_page=0}},{key:"setConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t in e){var n=e[t];this[t]=n}}},{key:"getConfig",value:function(e){return e?this[e]:null}},{key:"setSQL",value:function(e,t){console.info("[service setSQL] start..."),this.page=0,this.cli_page=0,this.editor.executeEdits("",[{range:this.editor.getModel().getFullModelRange(),text:e,forceMoveMarkers:!0}]),this.editor.clearSelection(),t&&(this.colsWidth={},this.head=[],this.filterHead=[],this.body={})}},{key:"getSQL",value:function(){var e=this.editor.getSelectedText()||this.editor.getValue();return e}},{key:"getSelectSQL",value:function(){var e=this.editor.getSelectedText();return e}},{key:"getSQLValue",value:function(){return this.getSQL().replace(/^\s*--.*\r?\n?/gm,"").replace(/\/\*(.|\n)*\*\//g,"")}},{key:"getFullSQL",value:function(){return this.editor.getValue()}},{key:"onStop",value:function(){var e=this;return S["default"].post("/api/sql/stop",{iid:this.data.db_id,token:this.token}).then((function(){Object(ln["Notification"])({title:"提示信息",message:"中断成功",type:"success",duration:2e3,position:"top-right",offset:100})})).finally((function(){e.loading=!1}))}},{key:"onFirst",value:function(){this.page=0,this.cli_page=this.page,this.onRun(!1,null,{single_script:this.runSql,is_change_pagesize:!0})}},{key:"onPre",value:function(){this.page=this.page>1?this.page-1:0,this.cli_page=this.page,this.onRun(!1,null,{single_script:this.runSql,is_change_pagesize:!0})}},{key:"onNext",value:function(e){if(!this.hasNext)return console.log("======没有下一页====="),!1;this.page=this.page+1,e||(this.cli_page=this.page),this.onRun(e,null,{single_script:this.runSql,is_change_pagesize:!0})}},{key:"onRun",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n,a){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("快照查询-工单"!=this.mode.mode&&"查询-异步"!=this.mode.mode){e.next=2;break}return e.abrupt("return",this.onRunAsyncData(t,n,a));case 2:if("在线查询-工单"!=this.mode.mode){e.next=4;break}return e.abrupt("return",this.onRunNormal(t,n,a));case 4:return i=null,e.prev=5,e.next=8,this.onAudit(a);case 8:i=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](5),i=e.t0;case 14:if(!i||!i.error){e.next=24;break}this.body={},this.head=[],this.filterHead=[],this.affected_rows=0,this.colsWidth={},this.result=!1,this.resultText="执行错误:"+i.error,e.next=26;break;case 24:return n=i?i.atk:"",e.abrupt("return",this.onRunNormal(t,n,a));case 26:case"end":return e.stop()}}),e,this,[[5,11]])})));function t(t,n,a){return e.apply(this,arguments)}return t}()},{key:"onAudit",value:function(e){return this.queryType="",console.log("onAudit encode:",this.encrypt_sql),this.onRunAudit(e)}},{key:"onCheckAudit",value:function(e){var t="";return t=e&&(e.no_check_script||e.single_script)?e.single_script:this.getSQL(),this.mode=oe["a"].parserComments(t),console.log("this.mode: ",this.mode),this.mode&&this.mode.mode&&"标准"!=this.mode.mode?(console.log("跳过审计：",this.mode),Promise.resolve(this.mode)):this.onAudit(e)}},{key:"onRunAudit",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=null,n=t&&(t.no_check_script||t.single_script)?t.single_script:this.getSQL(),!this.loading){e.next=4;break}return e.abrupt("return");case 4:if(this.loading=!0,this.runSql=n,this.token=Object(le["a"])(),this.resultText="",this.encrypt_sql&&(n=this.encryptSql(n)),n){e.next=12;break}return this.loading=!1,e.abrupt("return",Promise.reject({error:"请输入脚本！"}));case 12:return console.log("this.data: ",this.data),e.abrupt("return",S["default"].sql.audit({iid:this.data.id,sql:n,project:this.project.id,encrypt_flag:this.encrypt_flag,owner:this.data.owner,db_type:this.data.dbType,token:this.token}).then((function(e){return a.auditResult=e,e})).catch((function(){a.auditResult={}})).finally((function(){a.loading=!1})));case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onRunNormal",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n,a){var i,r,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=null,i=a&&a.single_script?a.single_script:this.getSQL(),a&&a.mode&&(this.mode=a.mode),this.runSql=i,!this.loading){e.next=6;break}return e.abrupt("return");case 6:return this.loading=!0,r=Date.now(),this.resultText="",this.affected_rows=0,this.encrypt_sql&&(i=this.encryptSql(i)),this.setSize(),this.runParams={item_type:this.itemType,atk:n,iid:this.data.id,project:this.project.id,sql:i,encrypt_flag:this.encrypt_flag,owner:this.data.owner,db_type:this.data.dbType,token:this.data.token||this.token,page_index:this.page,page_size:this.size,explain:this.explain},e.abrupt("return",S["default"].sql.exec(this.runParams).then((function(e){var n=e.ok,a=e.head,i=e.type,l=e.data,c=e.count,u=e.error,d=e.sql_type,f=e.work,h=e.table_name,p=e.table_rw;if(o.execResult=Object(s["a"])(Object(s["a"])({},o.execResult),{},{table_name:h,table_rw:p,sql_type:d,work:f}),o.result=n,n){if(l){o.hasNext=l.length>=o.size,o.affected_rows=11==d?c:c||l.length;var m=o.transformHeadAndData(a,i,l);o.head=m.head,o.filterHead=[].concat(a),o.body=t?Object.assign(o.body,m.data):Object.assign({},m.data),o.calculateColsWidth(o.head,o.body)}if(u)o.result=!n,o.resultText="执行错误:".concat(u);else if(l.error)o.result=!n,o.resultText="执行错误:".concat(l.error);else{var v=Date.now()-r;o.resultText=v>1e3?"共耗时 ".concat((v/1e3).toFixed(2)," 秒"):"共耗时 ".concat(v," 毫秒")}}else o.resultText="执行错误: ".concat(l.data)})).finally((function(){o.loading=!1,o.queryType="同步"})));case 14:case"end":return e.stop()}}),e,this)})));function t(t,n,a){return e.apply(this,arguments)}return t}()},{key:"onRunAsync",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.onAudit(t);case 2:if(n=e.sent,console.log("----------onAudit--------------:",n),!n||!n.error){e.next=9;break}return console.log("错误：",n.error),e.abrupt("return",Promise.resolve(n));case 9:return a=n?n.atk:"",i=this.getSQL(),t&&t.single_script&&(i=t.single_script),this.encrypt_sql&&(i=this.encryptSql(i)),this.runSql=i,this.setSize(),e.abrupt("return",S["default"].sql.exec(Object(s["a"])(Object(s["a"])({},t),{},{item_type:this.itemType,iid:this.data.id,atk:a,project:this.project.id,sql:i,encrypt_flag:this.encrypt_flag,owner:this.data.owner,db_type:this.data.dbType,token:this.token,page_index:this.page,page_size:this.size})));case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onRunAsyncData",value:function(e,t,n){var a=this;this.data.async=n&&n.async?n.async:this.data.async,n&&n.mode&&(this.mode=n.mode);var i=Date.now();return this.setSize(),S["default"].task.data({id:this.data.async,page_index:this.page,page_size:this.size}).then((function(t){var n=t.ok,s=t.head,r=t.data,o=t.count;if(a.result=n,n){a.hasNext=r.length>=a.size,a.affected_rows=o;var l=a.transformHeadAndData(s,{},r);return a.head=l.head,a.body=e?Object.assign(a.body,l.data):Object.assign({},l.data),a.calculateColsWidth(a.head,a.body),void(a.resultText="共耗时 ".concat(((Date.now()-i)/1e3).toFixed(2)," 秒"))}a.resultText="执行错误: ".concat(r.data)})).finally((function(){a.loading=!1,a.queryType="异步"}))}},{key:"onFormatter",value:function(){var e="sql";"oracle"==this.data.dbType?e="pl/sql":"db2"==this.data.dbType&&(e="db2");var t=this.getSQL(),n=oi.a.format(t,{language:e,indent:"    "});console.log("getSelect: ",this.editor.getSelectedText()||"你好");var a=this.editor.getSelectedText()?this.editor.getSelection():this.editor.getModel().getFullModelRange();this.editor.executeEdits("",[{range:a,text:n,forceMoveMarkers:!0}])}},{key:"onSaveLocal",value:function(){}},{key:"onOpenLocal",value:function(){}},{key:"calculateColsWidth",value:function(e,t){for(var n=0;n<e.length;n++){var a=e[n].label,i=this.strlen(a);i=this.explain?Math.max(i,this.colsMinLength):i>this.colsMaxLength?this.colsMaxLength:i<this.colsMinLength?this.colsMinLength:i,i+=1.5,"id"==a&&console.log("id--： ",i),this.colsWidth[a]=i}for(var s=Object.values(t),r=0,o=s;r<o.length;r++){var l=o[r];for(var c in l)if(this.explain||this.colsWidth[c]!=this.colsMaxLength){var u=this.strlen(l[c]),d=this.colsWidth[c];this.explain?this.colsWidth[c]=Math.max(u,d):this.colsWidth[c]=u>d?u>this.colsMaxLength?this.colsMaxLength:u:d}}console.log("列宽：",this.colsWidth)}},{key:"strlen",value:function(e){for(var t=0,n=0;n<e.length;n++){var a=e.charCodeAt(n);a>=1&&a<=126||65376<=a&&a<=65439?t++:t+=2}return t}},{key:"transformHeadAndData",value:function(e,t,n){t=t||{};var a={},i={};if(n&&n.length>0)for(var s=0;s<n.length;s++){var r=n[s];for(var o in r._XID_VUE_UUID_=Tn(),a[r._XID_VUE_UUID_]=r,r)r[o].length>100&&(i[o.toLowerCase()]=1)}var l=(e||[]).map((function(e){var n=t[e]||{},a={label:e,width:null,type:(n.type||"").toLowerCase()};switch((n.type||"").toLowerCase()){case"varchar":break;case"text":a.width=250;break;case"blob":a.width=250;break;case"longtext":a.width=250;break}return i[e.toLowerCase()]&&(a.width=250),a}));return{head:l,data:a}}},{key:"hasScript",value:function(){return!!this.editor.getValue()}},{key:"encryptSql",value:function(e){return e=S["default"].util.aesEncrypted(e),this.encrypt_flag=!0,console.log("开始加密sql。。。",e),e}}]),e}(),gi={data:function(){return{height:null,service:new Ei(this.tabId,this.data,this.$bus),defaultPercent:12}},provide:function(){var e=this.data,t=e.id,n=e.dbType,a=e.name;return{db:{id:t,dbType:n},owner:{id:a,name:a,db:t},data:this.data,service:this.service,dataIndex:this.dataIndex}},computed:Object(s["a"])(Object(s["a"])({},Object(r["c"])(["sys","setting","runList","runActive"])),{},{hasSql:function(){return this.sys.asyn_sql&&this.data.hasAsynSql}}),props:{data:{},dataIndex:{},tabId:{}},watch:{setting:{deep:!0,handler:"onSetting"},data:function(e,t){console.log("tab/index: ",e.name,t.name)}},methods:{onSetting:function(e){this.service.setFontSize(e.editFontSize)},onActive:function(){console.log("[tab index.vue methods] onActive: ",this.data,this.service);var e=this.service.data,t={hasAsynExport:this.data.hasAsynExport,hasAsynQuery:this.data.hasAsynQuery,hasAsynSql:this.data.hasAsynSql,hasRw:this.data.hasRw};this.service.data=Object(s["a"])(Object(s["a"])({},e),t),this.$store.commit("activeRunner",this.service),this.$store.commit("updateService",this.service),this.$store.commit("updateContext",{tabId:this.tabId,key:"service",data:this.service})},onResize:function(){var e=this.$el.getElementsByClassName("left")[0];console.log(e)},listenTab:function(){var e=this,t=e.runList.filter((function(t){return t.tabId==e.tabId})),n=t[0];console.log("tab/index.vue mounted: ",e.tabId,e.data),console.log("监听： on-selectdb-".concat(n.tabId)),this.$bus.off("on-selectdb-".concat(n.tabId)),this.$bus.on("on-selectdb-".concat(n.tabId),(function(t){console.log("执行 on-selectdb-".concat(n.tabId),e.tabId,t,e.service.data.index,e.service.editor.getModel().id),console.log("run: ",t),e.service.update(t)}))}},components:{SqlCardDb:Pt,SqlItem:ti,SplitPane:on.a},created:function(){this.listenTab()},mounted:function(){this.defaultPercent=Math.floor(240/document.documentElement.clientWidth*100),this.onActive(),this.onResize(),this.onSetting(this.setting)},beforeDestroy:function(){}},yi=gi,_i=(n("87c9"),Object(m["a"])(yi,Ce,ke,!1,null,null,null)),Ti=_i.exports,Ri=null,Si=Object(Ne["a"])({data:function(){return{active:0,tabNames:[],workspaceTabParams:{runName:null,tabId:null},dialogVisible:!1}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(r["c"])(["runList","runNames","runner","runActive","sys"])),Object(r["b"])(["run"])),{},{getTabName:function(){var e=this;return function(t){return e.runNames[t.tabId]}},keymap:function(e){return console.log("hotkey:",e),{"alt+r":this.onRun,"alt+t":this.copyCur,"alt+w":this.closeCur,"alt+.":this.queryNext,"alt+,":this.queryPrv,"alt+a":this.queryAppendNext,"ctrl+s":this.saveToLocalFile}}}),props:{},watch:{active:{immediate:!0,handler:function(e){console.log("[tabs watch] active: ",e)}},run:function(e){var t=this;console.log("[tabs watch] run:",e),Boolean(e)&&Boolean(e.instance_id)&&(this.active=String(e.index),this.onActive(this.active),this.$nextTick((function(){var n=e.instance_id;t.$store.commit("getSelectedDB",n)})))}},methods:{onTabClick:function(e){var t=this;console.log("单击："),clearTimeout(Ri),Ri=setTimeout((function(){console.log("[tabs methods] onTabClick:",t.active,e),t.$nextTick((function(){t.onActive(String(e))}))}),350)},onDblTabClick:function(e){clearTimeout(Ri),this.dialogVisible=!0,this.workspaceTabParams={runName:this.runNames[e],tabId:e},console.log("双击tabId: ",e,this.tabName)},savaTabName:function(){this.workspaceTabParams.runName?(console.log("修改标签页名称： ",this.workspaceTabParams),this.$store.commit("setWorkspaceTabName",this.workspaceTabParams),this.dialogVisible=!1):this.$message({message:"请输入标签名称",type:"warning"})},copyCur:function(){this.$store.commit("copyActiveRunner")},closeCur:function(){var e=this.runList[this.runActive];this.$store.commit("delRun",{index:this.runActive,tabId:e.tabId})},queryNext:function(){console.log("======queryNext====="),this.runner.onNext()},queryAppendNext:function(){console.log("======queryAppendNext====="),this.runner.onNext(!0)},saveToLocalFile:function(e){e.preventDefault(),console.log("======saveToLocalFile====="),this.$bus.emit("saveToLocalFile")},queryPrv:function(){console.log("======queryPrv====="),this.runner.onPre()},onRun:function(){this.runner.encrypt_sql=this.sys.encrypt_sql,this.runner.page=0,this.runner.onRun(!1),this.onWork()},onCopy:function(e){this.clone=Object(s["a"])({},this.runList[e]),this.$store.commit("addRun",this.clone)},onRemove:function(e,t){console.log("销毁  on-selectdb-".concat(e)),this.$bus.off("on-selectdb-".concat(e)),this.$store.commit("delRun",{index:t,tabId:e}),console.log("[tabs methods] onRemove: ",String(this.runList.length-1)),this.onActive(String(this.runList.length-1))},onActive:function(e){var t=this;console.log("[tabs methods] onActive: ",e,this.active,this.runActive),this.$store.commit("updateRunActive",e),this.active=e,setTimeout((function(){t.$nextTick((function(){var e=t.$refs["queryItem".concat(t.active)];Boolean(e)&&Boolean(e[0])&&e[0].onActive()}))}),500)}},components:{SqlQueryItem:Ti},created:function(){var e=this;console.log("....... tabs created"),this.$bus.on("new-sql-window",(function(){e.onActive(String(e.runList.length-1))}))},beforeDestroy:function(){this.$bus.off("new-sql-window")},mounted:function(){var e=this,t="runNames";Object(u["b"])(t,{max:0}).then((function(t){console.log("resp: ",t),console.log("获取runNames： ",t),t&&e.$store.commit("setAllRunNames",t)})).catch((function(e){console.log("获取runNames：e",e)})),this.onActive(String(this.runActive)||"0")}},"beforeDestroy",(function(){})),Ii=Si,Li=(n("c960"),Object(m["a"])(Ii,De,Ae,!1,null,null,null)),wi=Li.exports,Oi={data:function(){return{workpaceLoading:!1,sql:this.$route.params.sql,db_id:this.$route.params.db_id,owner:this.$route.params.owner}},computed:Object(s["a"])({},Object(r["c"])(["sys","setting","isMaxLine","MAX_LINE"])),props:{},watch:{isMaxLine:function(e){e&&this.onError("SQL行数超过了最大值限制(max = ".concat(this.MAX_LINE,"行)，删除多余行！"),"错误",3500)}},methods:{goBack:function(){console.log("don't go back;")},updateData:function(){try{var e=window.localStorage.getItem("loc_update");if(!e){console.log("==========本地升级开始=========="),window.localStorage.setItem("loc_update",1);var t=window.localStorage.getItem("runList"),n=window.localStorage.getItem("runActive"),a=window.localStorage.getItem("runner");t&&window.localStorage.setItem("1_runList",t),n&&window.localStorage.setItem("1_runActive",n),a&&window.localStorage.setItem("1_runner",a),console.log("==========本地升级结束==========")}}catch(i){console.log("==========本地升级出错=========="),console.error(i)}},refreshSys:function(){var e=this;this.$api.sys.config().then((function(t){e.$store.commit("sys",t)}))}},components:{Tools:xe,SqlTabs:wi},mounted:function(){var e=this;this.$bus.off("workpace-loading"),this.$bus.on("workpace-loading",(function(t){e.workpaceLoading=t})),this.updateData(),this.refreshSys(),window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1))},created:function(){this.$store.dispatch("initStore")},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)}},xi=Oi,Di=(n("1881"),Object(m["a"])(xi,a,i,!1,null,null,null));t["default"]=Di.exports},ac78:function(e,t,n){"use strict";var a=n("849e"),i=n.n(a);i.a},ad30:function(e,t,n){},b047:function(e,t){function n(e){return function(t){return e(t)}}e.exports=n},b0a8:function(e,t){var n=9007199254740991,a=Math.floor;function i(e,t){var i="";if(!e||t<1||t>n)return i;do{t%2&&(i+=e),t=a(t/2),t&&(e+=e)}while(t);return i}e.exports=i},b218:function(e,t){var n=9007199254740991;function a(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}e.exports=a},b4a6:function(e,t,n){"use strict";var a=n("be61"),i=n.n(a);i.a},b4b0:function(e,t,n){var a=n("1a8c"),i=n("ffd6"),s=NaN,r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;function d(e){if("number"==typeof e)return e;if(i(e))return s;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var n=l.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):o.test(e)?s:+e}e.exports=d},b50c:function(e,t,n){"use strict";var a=n("5634"),i=n.n(a);i.a},b5a7:function(e,t,n){var a=n("0b07"),i=n("2b3e"),s=a(i,"DataView");e.exports=s},bc2f:function(e,t,n){},be61:function(e,t,n){},c0983:function(e,t){var n=9007199254740991,a=/^(?:0|[1-9]\d*)$/;function i(e,t){var i=typeof e;return t=null==t?n:t,!!t&&("number"==i||"symbol"!=i&&a.test(e))&&e>-1&&e%1==0&&e<t}e.exports=i},c0b5:function(e,t,n){"use strict";var a=n("1148b"),i=n.n(a);i.a},c57a:function(e,t,n){},c6be:function(e,t,n){},c869:function(e,t,n){var a=n("0b07"),i=n("2b3e"),s=a(i,"Set");e.exports=s},c960:function(e,t,n){"use strict";var a=n("6eed5"),i=n.n(a);i.a},ce86:function(e,t,n){var a=n("9e69"),i=n("7948"),s=n("6747"),r=n("ffd6"),o=1/0,l=a?a.prototype:void 0,c=l?l.toString:void 0;function u(e){if("string"==typeof e)return e;if(s(e))return i(e,u)+"";if(r(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-o?"-0":t}e.exports=u},ceb8:function(e,t,n){},cf03:function(e,t,n){},d088:function(e,t,n){"use strict";var a=n("ad30"),i=n.n(a);i.a},d370:function(e,t,n){var a=n("253c"),i=n("1310"),s=Object.prototype,r=s.hasOwnProperty,o=s.propertyIsEnumerable,l=a(function(){return arguments}())?a:function(e){return i(e)&&r.call(e,"callee")&&!o.call(e,"callee")};e.exports=l},d5da:function(e,t,n){"use strict";var a=n("757c"),i=n.n(a);i.a},d9a8:function(e,t){function n(e){return e!==e}e.exports=n},da03:function(e,t,n){var a=n("2b3e"),i=a["__core-js_shared__"];e.exports=i},dc57:function(e,t){var n=Function.prototype,a=n.toString;function i(e){if(null!=e){try{return a.call(e)}catch(t){}try{return e+""}catch(t){}}return""}e.exports=i},e2a0:function(e,t,n){var a=n("3729"),i=n("6747"),s=n("1310"),r="[object String]";function o(e){return"string"==typeof e||!i(e)&&s(e)&&a(e)==r}e.exports=o},e86f:function(e,t,n){},ea87:function(e,t,n){"use strict";var a=n("26bc"),i=n.n(a);i.a},eaab:function(e,t,n){},eac5:function(e,t){var n=Object.prototype;function a(e){var t=e&&e.constructor,a="function"==typeof t&&t.prototype||n;return e===a}e.exports=a},eb09:function(e,t,n){"use strict";var a=n("eea9"),i=n.n(a);i.a},ec24:function(e,t,n){},ec69:function(e,t,n){var a=n("6fcd"),i=n("03dd"),s=n("30c9");function r(e){return s(e)?a(e):i(e)}e.exports=r},ed71:function(e,t,n){"use strict";var a=n("4b8d"),i=n.n(a);i.a},eea9:function(e,t,n){},f121:function(e,t,n){},f779:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a={WHITESPACE:"whitespace",WORD:"word",STRING:"string",RESERVED:"reserved",RESERVED_TOP_LEVEL:"reserved-top-level",RESERVED_TOP_LEVEL_NO_INDENT:"reserved-top-level-no-indent",RESERVED_NEWLINE:"reserved-newline",OPERATOR:"operator",OPEN_PAREN:"open-paren",CLOSE_PAREN:"close-paren",LINE_COMMENT:"line-comment",BLOCK_COMMENT:"block-comment",NUMBER:"number",PLACEHOLDER:"placeholder"};t["default"]=a,e.exports=t.default},f93b:function(e,t,n){"use strict";var a=n("6451"),i=n.n(a);i.a},f9ae:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=t.format=void 0;var a=o(n("7b7d")),i=o(n("9e35")),s=o(n("41ec")),r=o(n("64c4"));function o(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.language){case"db2":return new a["default"](t).format(e);case"n1ql":return new i["default"](t).format(e);case"pl/sql":return new s["default"](t).format(e);case"sql":case void 0:return new r["default"](t).format(e);default:throw Error("Unsupported SQL dialect: ".concat(t.language))}};t.format=l;var c={format:l};t["default"]=c},fcf1:function(e,t,n){"use strict";var a=n("2560"),i=n.n(a);i.a},fd29:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var a=l(n("8a30")),i=l(n("f779")),s=l(n("0055")),r=l(n("963f")),o=l(n("1fb2"));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}var f=function(e){return e.replace(/[\t ]+$/,"")},h=function(){function e(t,n,a){c(this,e),this.cfg=t||{},this.indentation=new s["default"](this.cfg.indent),this.inlineBlock=new r["default"],this.params=new o["default"](this.cfg.params),this.tokenizer=n,this.tokenOverride=a,this.previousReservedWord={},this.tokens=[],this.index=0}return d(e,[{key:"format",value:function(e){this.tokens=this.tokenizer.tokenize(e);var t=this.getFormattedQueryFromTokens();return t.trim()}},{key:"getFormattedQueryFromTokens",value:function(){var e=this,t="";return this.tokens.forEach((function(n,a){e.index=a,e.tokenOverride&&(n=e.tokenOverride(n,e.previousReservedWord)||n),n.type===i["default"].WHITESPACE||(n.type===i["default"].LINE_COMMENT?t=e.formatLineComment(n,t):n.type===i["default"].BLOCK_COMMENT?t=e.formatBlockComment(n,t):n.type===i["default"].RESERVED_TOP_LEVEL?(t=e.formatTopLevelReservedWord(n,t),e.previousReservedWord=n):n.type===i["default"].RESERVED_TOP_LEVEL_NO_INDENT?(t=e.formatTopLevelReservedWordNoIndent(n,t),e.previousReservedWord=n):n.type===i["default"].RESERVED_NEWLINE?(t=e.formatNewlineReservedWord(n,t),e.previousReservedWord=n):n.type===i["default"].RESERVED?(t=e.formatWithSpaces(n,t),e.previousReservedWord=n):t=n.type===i["default"].OPEN_PAREN?e.formatOpeningParentheses(n,t):n.type===i["default"].CLOSE_PAREN?e.formatClosingParentheses(n,t):n.type===i["default"].PLACEHOLDER?e.formatPlaceholder(n,t):","===n.value?e.formatComma(n,t):":"===n.value?e.formatWithSpaceAfter(n,t):"."===n.value?e.formatWithoutSpaces(n,t):";"===n.value?e.formatQuerySeparator(n,t):e.formatWithSpaces(n,t))})),t}},{key:"formatLineComment",value:function(e,t){return this.addNewline(t+e.value)}},{key:"formatBlockComment",value:function(e,t){return this.addNewline(this.addNewline(t)+this.indentComment(e.value))}},{key:"indentComment",value:function(e){return e.replace(/\n[\t ]*/g,"\n"+this.indentation.getIndent()+" ")}},{key:"formatTopLevelReservedWordNoIndent",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t)+this.equalizeWhitespace(this.formatReservedWord(e.value)),this.addNewline(t)}},{key:"formatTopLevelReservedWord",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t),this.indentation.increaseTopLevel(),t+=this.equalizeWhitespace(this.formatReservedWord(e.value)),this.addNewline(t)}},{key:"formatNewlineReservedWord",value:function(e,t){return this.addNewline(t)+this.equalizeWhitespace(this.formatReservedWord(e.value))+" "}},{key:"equalizeWhitespace",value:function(e){return e.replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/g," ")}},{key:"formatOpeningParentheses",value:function(e,t){var n=[i["default"].WHITESPACE,i["default"].OPEN_PAREN,i["default"].LINE_COMMENT];return(0,a["default"])(n,this.previousToken().type)||(t=f(t)),t+=this.cfg.uppercase?e.value.toUpperCase():e.value,this.inlineBlock.beginIfPossible(this.tokens,this.index),this.inlineBlock.isActive()||(this.indentation.increaseBlockLevel(),t=this.addNewline(t)),t}},{key:"formatClosingParentheses",value:function(e,t){return e.value=this.cfg.uppercase?e.value.toUpperCase():e.value,this.inlineBlock.isActive()?(this.inlineBlock.end(),this.formatWithSpaceAfter(e,t)):(this.indentation.decreaseBlockLevel(),this.formatWithSpaces(e,this.addNewline(t)))}},{key:"formatPlaceholder",value:function(e,t){return t+this.params.get(e)+" "}},{key:"formatComma",value:function(e,t){return t=f(t)+e.value+" ",this.inlineBlock.isActive()||/^LIMIT$/i.test(this.previousReservedWord.value)?t:this.addNewline(t)}},{key:"formatWithSpaceAfter",value:function(e,t){return f(t)+e.value+" "}},{key:"formatWithoutSpaces",value:function(e,t){return f(t)+e.value}},{key:"formatWithSpaces",value:function(e,t){var n="reserved"===e.type?this.formatReservedWord(e.value):e.value;return t+n+" "}},{key:"formatReservedWord",value:function(e){return this.cfg.uppercase?e.toUpperCase():e}},{key:"formatQuerySeparator",value:function(e,t){return this.indentation.resetIndentation(),f(t)+e.value+"\n".repeat(this.cfg.linesBetweenQueries||1)}},{key:"addNewline",value:function(e){return e=f(e),e.endsWith("\n")||(e+="\n"),e+this.indentation.getIndent()}},{key:"previousToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.tokens[this.index-e]||{}}}]),e}();t["default"]=h,e.exports=t.default},ffd6:function(e,t,n){var a=n("3729"),i=n("1310"),s="[object Symbol]";function r(e){return"symbol"==typeof e||i(e)&&a(e)==s}e.exports=r}}]);