(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50a391a0"],{"12bb":function(t,e,a){"use strict";var s=a("842a"),i=a.n(s);i.a},1930:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:"加入项目",visible:t.isShow,width:"600px"},on:{"update:visible":function(e){t.isShow=e}}},[a("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"120px","label-suffix":":",rules:t.formRule}},[a("el-form-item",{attrs:{label:"项目"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.source_id,callback:function(e){t.$set(t.formData,"source_id",e)},expression:"formData.source_id"}},t._l(t.projectList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id,disabled:t.in_flag>0}})})),1)],1),a("el-form-item",{attrs:{label:"申请理由",prop:"opt_mark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入申请理由"},model:{value:t.formData.opt_mark,callback:function(e){t.$set(t.formData,"opt_mark",e)},expression:"formData.opt_mark"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.hide}},[t._v("取消")]),a("el-button",{attrs:{type:"success"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)},i=[],o={data:function(){return{project_id:0,isShow:!1,projectList:[],managerList:[],formData:{source_id:"",auditor:"",opt_mark:"",source_type:"project"},formRule:{project_id:[{required:!0,message:"请选择项目"}]}}},props:{},watch:{"formData.source_id":function(t){this.formData.auditor=t}},computed:{},methods:{show:function(t){var e=this;this.formData={source_id:"",auditor:"",opt_mark:"",source_type:"project"},t&&(this.formData.source_id=t,this.formData.auditor=t),this.$api.my.myApplyProjectList().then((function(t){e.projectList=t})),this.isShow=!0},hide:function(){this.formData={source_id:"",auditor:"",opt_mark:"",source_type:"project"},this.projectList=[],this.isShow=!1},loadManagerList:function(t){var e=this;t?this.$api.project.managerList(t).then((function(t){e.managerList=t})):this.managerList=[]},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e){var a=t.formData;t.$api.apply.applyAdd(a).then((function(){t.onSuccess("提交成功"),t.hide(),t.$emit("refresh")}),(function(e){var a="参数错误！";"301"!=e.result&&(a=e.data),t.onError(a)}))}}))}},mounted:function(){},components:{}},r=o,n=a("2877"),c=Object(n["a"])(r,s,i,!1,null,null,null);e["a"]=c.exports},"727e":function(t,e,a){},"842a":function(t,e,a){},d073:function(t,e,a){"use strict";var s=a("727e"),i=a.n(s);i.a},eb8e:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"component-monitor apps"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("平台性能监控")])]),a("div",{staticClass:"progress"},[a("div",{staticClass:"item"},[a("el-progress",{attrs:{width:110,type:"circle",format:t.percentageFormat,percentage:t.round(t.cpu_percent)}}),a("span",[t._v("cpu")])],1),a("div",{staticClass:"item"},[a("el-progress",{attrs:{width:110,type:"circle",format:t.percentageFormat,percentage:t.round(t.mem.usedPercent)}}),a("span",[t._v("内存")])],1),a("div",{staticClass:"item"},[a("el-progress",{attrs:{width:110,type:"circle",format:t.percentageFormat,percentage:t.round(t.disk.usedPercent)}}),a("span",[t._v("磁盘")])],1)]),a("div",{staticClass:"network-flow"},[a("div",{staticStyle:{"font-size":"0.9em"}},[t._v(" 网络流量: ")]),a("div",{staticClass:"sents"},[a("div",{staticClass:"item"},[a("span",{staticClass:"data",attrs:{title:"发送数据包"}},[t._v(t._s(t.ioFormat(t.io_data,"packetsSent")))]),a("span",{staticClass:"description"},[t._v("发送数据包")])]),a("div",{staticClass:"item"},[a("span",{staticClass:"data",attrs:{title:"发送字节"}},[t._v(t._s(t.ioFormat(t.io_data,"bytesSent")))]),a("span",{staticClass:"description"},[t._v("发送字节")])])]),a("div",{staticClass:"recvs"},[a("div",{staticClass:"item"},[a("span",{staticClass:"data",attrs:{title:"接受数据包"}},[t._v(t._s(t.ioFormat(t.io_data,"packetsRecv")))]),a("span",{staticClass:"description"},[t._v("接受数据包")])]),a("div",{staticClass:"item"},[a("span",{staticClass:"data",attrs:{title:"接受字节"}},[t._v(t._s(t.ioFormat(t.io_data,"bytesRecv")))]),a("span",{staticClass:"description"},[t._v("接受字节")])])])])])],1)},i=[],o=(a("4160"),a("a9e3"),a("b680"),a("159b"),{computed:{ioFormat:function(){var t=this;return function(e,a){var s=0;return e.forEach((function(t){var e=t[a];e&&e>1024&&(s+=e/1024)})),t.round(s,2)+"kb"}}},data:function(){return{h1:null,h2:null,n3:null,h4:null,mem:{usedPercent:0},cpu:{},cpu_percent:0,disk:{usedPercent:0},io_data:[],net_data:[],network:{},query:{start:"",end:"",start2:"",end2:""},stat:{db_count:0,app_count:0,user_count:0,today_count:0},dbTypeStat:{columns:["类型","数量"],rows:[]},dbTypeTitle:{text:"数据源类型"},typeTitle:{text:"当日执行类型统计",default:10},logTimeTitle:{text:"一周访问量"},logStat:{columns:["类型","数量"],rows:[]},logTitle:{text:"当日失败率统计"},logTimeStat:{columns:["时间","访问量"],rows:[]},dbStat:{columns:["数据源","访问量"],rows:[]},dbTitle:{text:"当日数据库使用量"},dbStatSettings:{dataOrder:{label:"访问量",order:"desc"}},exportStat:{columns:["应用","访问量"],rows:[]},appTitle:{text:"当日数据导出量"},userStat:{columns:["用户名","访问量"],rows:[]},typeStat:{columns:["操作","数量"],rows:[]},userTitle:{text:"当日用户访问量"},appStatSettings:{dataOrder:{label:"访问量",order:"desc"}},pubSetting1:{height:"350px",width:"100%"},pubSetting:{height:"400px",width:"100%"},chartData1:{columns:["数据源","次数"],rows:[{"次数":1393,"数据源":"查询库"},{"次数":3530,"数据源":"用户中心"},{"次数":2923,"数据源":"订单库"},{"次数":1723,"数据源":"淘宝api"},{"次数":3792,"数据源":"日志"},{"次数":4593,"数据源":"eslog"}]},chartData:{columns:["日期","访问用户","下单用户","下单率"],rows:[{"日期":"1/1","访问用户":1393,"下单用户":1093,"下单率":.32},{"日期":"1/2","访问用户":3530,"下单用户":3230,"下单率":.26},{"日期":"1/3","访问用户":2923,"下单用户":2623,"下单率":.76},{"日期":"1/4","访问用户":1723,"下单用户":1423,"下单率":.49},{"日期":"1/5","访问用户":3792,"下单用户":3492,"下单率":.323},{"日期":"1/6","访问用户":4593,"下单用户":4293,"下单率":.78}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.init()})),this.$once("hook:beforeDestroy",(function(){console.log("销毁监控定时器2"),t.stopTimer()}))},beforeDestroy:function(){console.log("销毁监控定时器"),this.stopTimer()},methods:{percentageFormat:function(t){return 100===t?"满":"".concat(t,"%")},stopTimer:function(){console.log("this.h1: ",this.h1),clearTimeout(this.h1),clearTimeout(this.h2),clearTimeout(this.h3),clearTimeout(this.h4)},dataFormat:function(t,e){var a=t[e.property];return a&&a>1024?this.round(a/1024)+" KB":a},do_cpu_stat:function(){var t=this;this.$api.post("/api/system/stat",{type:"cpu"}).then((function(e){e.info.length>0&&(t.cpu=e.info[0])}))},do_cpu_percent:function(){var t=this;clearTimeout(this.h1),this.$api.post("/api/system/stat",{type:"cpu_percent"}).then((function(e){t.cpu_percent=e,t.h1=setTimeout((function(){t.do_cpu_percent()}),2e3)}))},do_mem_stat:function(){var t=this;clearTimeout(this.h2),this.$api.post("/api/system/stat",{type:"mem"}).then((function(e){t.mem=e,t.h2=setTimeout((function(){t.do_mem_stat()}),3e3)}))},do_disk_stat:function(){var t=this;clearTimeout(this.h3),this.$api.post("/api/system/stat",{type:"disk"}).then((function(e){t.disk=e,t.h3=setTimeout((function(){t.do_disk_stat()}),6e4)}))},do_network_stat:function(){var t=this;clearTimeout(this.h4),this.$api.post("/api/system/stat",{type:"network"}).then((function(e){t.io_data=e.io,t.net_data=e.con,t.h4=setTimeout((function(){t.do_network_stat()}),2e3)}))},round:function(t,e){var a=Math.round(100*t)/100;return void 0!=e?Number(a.toFixed(e)):a},init:function(){this.do_cpu_stat(),this.do_cpu_percent(),this.do_mem_stat(),this.do_disk_stat(),this.do_network_stat()}}}),r=o,n=(a("d073"),a("2877")),c=Object(n["a"])(r,s,i,!1,null,null,null);e["a"]=c.exports},ed52:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-dashboard apps"},[a("el-row",{staticClass:"base-info-section",attrs:{type:"flex",gutter:20,justify:"space-between"}},[a("el-col",{attrs:{span:4,offset:0}},[a("div",{staticClass:"icon"},[a("i",{staticClass:"sn-font project"},[t._v("")])]),a("div",[a("h4",[t._v("项目数")]),a("span",{staticClass:"count"},[t._v(t._s(t.baseStat.project_count))])])]),a("el-col",{attrs:{span:4,offset:0}},[a("div",{staticClass:"icon"},[a("i",{staticClass:"sn-font db"},[t._v("")])]),a("div",[a("h4",[t._v("数据源")]),a("span",{staticClass:"count"},[t._v(t._s(t.baseStat.db_count))])])]),a("el-col",{attrs:{span:4,offset:0}},[a("div",{staticClass:"icon"},[a("i",{staticClass:"sn-font user"},[t._v("")])]),a("div",[a("h4",[t._v("用户数")]),a("span",{staticClass:"count"},[t._v(t._s(t.baseStat.user_count))])])]),a("el-col",{attrs:{span:4,offset:0}},[a("div",{staticClass:"icon"},[a("i",{staticClass:"sn-font execute"},[t._v("")])]),a("div",[a("h4",[t._v("执行次数")]),a("span",{staticClass:"count"},[t._v(t._s(t.baseStat.project_count))])])]),a("el-col",{attrs:{span:4,offset:0}},[a("div",{staticClass:"icon"},[a("i",{staticClass:"sn-font execute-error"},[t._v("")])]),a("div",[a("h4",[t._v("执行失败")]),a("span",{staticClass:"count"},[t._v(t._s(t.baseStat.project_count))])])])],1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("monitor")],1),a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(" 数据源类型 ")])]),a("div",[a("ve-ring",{attrs:{height:"350px",settings:{radius:120,offsetY:200},data:t.dbTypeStat,title:t.dbTypeTitle}})],1)])],1),a("el-col",{attrs:{span:8}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("一周访问量")])]),a("div",[a("ve-line",t._b({attrs:{data:t.logTimeStat,title:t.logTimeTitle}},"ve-line",t.pubSetting1,!1))],1)])],1)],1),a("el-row",{staticStyle:{"margin-top":"20px"}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(" 其他统计 "),a("el-date-picker",{staticStyle:{float:"right","margin-bottom":"5px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.$constant.pickOptions},on:{change:t.queryToday},model:{value:t.query.todayRange,callback:function(e){t.$set(t.query,"todayRange",e)},expression:"query.todayRange"}})],1)]),a("div",[a("el-row",{attrs:{gutter:0}},[a("el-col",{staticClass:"chart",attrs:{xs:24,sm:12,md:12,lg:6,xl:6}},[a("ve-bar",t._b({attrs:{data:t.dbStat,"legend-visible":!1,settings:t.dbStatSettings,title:t.dbTitle}},"ve-bar",t.pubSetting,!1))],1),a("el-col",{staticClass:"chart",attrs:{xs:24,sm:12,md:12,lg:6,xl:6}},[a("ve-pie",t._b({attrs:{colors:["#45D5B0","#F56C6C"],settings:{radius:80},data:t.logStat,"legend-visible":!1,title:t.logTitle}},"ve-pie",t.pubSetting,!1))],1),a("el-col",{staticClass:"chart",attrs:{xs:24,sm:12,md:12,lg:6,xl:6}},[a("ve-pie",t._b({attrs:{settings:{radius:80},data:t.typeStat,"legend-visible":!1,title:t.typeTitle}},"ve-pie",t.pubSetting,!1))],1),a("el-col",{staticClass:"chart",attrs:{xs:24,sm:12,md:12,lg:6,xl:6}},[a("ve-bar",t._b({attrs:{data:t.userStat,"legend-visible":!1,settings:t.appStatSettings,title:t.userTitle}},"ve-bar",t.pubSetting,!1))],1)],1)],1)])],1),a("dialog-project-apply",{ref:"dialogProjectApply",on:{refresh:t.init}})],1)},i=[],o=(a("b0c0"),a("b85c")),r=a("5530"),n=a("5743"),c=a("2f62"),l=a("eb8e"),u=a("1930"),p=a("2819"),d={components:{VeLine:p["VeLine"],Monitor:l["a"],VeRadar:p["VeRadar"],VeHistogram:p["VeHistogram"],VeScatter:p["VeScatter"],VeMap:p["VeMap"],VeBar:p["VeBar"],VePie:p["VePie"],VeRing:p["VeRing"],VeWaterfall:p["VeWaterfall"],VeFunnel:p["VeFunnel"],DialogProjectApply:u["a"]},computed:Object(r["a"])({},Object(c["c"])(["user","project"])),data:function(){return{baseStat:{},isCommunity:!1,projectList:[],query:{start:"",end:"",start2:"",end2:"",todayRange:[]},stat:{db_count:0,app_count:0,user_count:0,today_count:0,fail_count:0},dbTypeStat:{columns:["类型","数量"],rows:[]},dbTypeTitle:{text:""},typeTitle:{text:"当日执行类型统计",default:10},logTimeTitle:{text:""},logStat:{columns:["类型","数量"],rows:[]},logTitle:{text:"当日失败率统计"},logTimeStat:{columns:["时间","访问量"],rows:[]},dbStat:{columns:["数据源","访问量"],rows:[]},dbTitle:{text:"当日数据库使用量"},dbStatSettings:{dataOrder:{label:"访问量",order:"desc"}},exportStat:{columns:["应用","访问量"],rows:[]},appTitle:{text:"当日数据导出量"},userStat:{columns:["用户名","访问量"],rows:[]},typeStat:{columns:["操作","数量"],rows:[]},userTitle:{text:"当日用户访问量"},appStatSettings:{dataOrder:{label:"访问量",order:"desc"}},pubSetting1:{height:"350px",width:"100%"},pubSetting:{height:"400px",width:"100%"},chartData1:{columns:["数据源","次数"],rows:[{"次数":1393,"数据源":"查询库"},{"次数":3530,"数据源":"用户中心"},{"次数":2923,"数据源":"订单库"},{"次数":1723,"数据源":"淘宝api"},{"次数":3792,"数据源":"日志"},{"次数":4593,"数据源":"eslog"}]},chartData:{columns:["日期","访问用户","下单用户","下单率"],rows:[{"日期":"1/1","访问用户":1393,"下单用户":1093,"下单率":.32},{"日期":"1/2","访问用户":3530,"下单用户":3230,"下单率":.26},{"日期":"1/3","访问用户":2923,"下单用户":2623,"下单率":.76},{"日期":"1/4","访问用户":1723,"下单用户":1423,"下单率":.49},{"日期":"1/5","访问用户":3792,"下单用户":3492,"下单率":.323},{"日期":"1/6","访问用户":4593,"下单用户":4293,"下单率":.78}]}}},mounted:function(){var t=this;this.queryBase();var e=n["a"].timeRange("now/d to now/d");this.query.todayRange=e,this.queryToday(),e&&e.length>1&&(this.query.start=n["a"].utc2date(e[0]),this.query.end=n["a"].utc2date(e[1]));var a=n["a"].timeRange("now-7d to now");a&&a.length>1&&(this.query.start2=n["a"].utc2date(a[0]),this.query.end2=n["a"].utc2date(a[1])),this.$nextTick((function(){t.init()}))},methods:{queryToday:function(){var t=this;if(this.query.todayRange&&this.query.todayRange.length>1){var e=n["a"].utc2date(this.query.todayRange[0]),a=n["a"].utc2date(this.query.todayRange[1]);this.$api.post("/api/sys/stat",{type:"log_stat",start:e,end:a}).then((function(e){if(e&&0==e.length)t.logStat.rows=[{"类型":"空","数量":0}];else{var a,s=[],i=Object(o["a"])(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;s.push({"类型":r.name,"数量":r.hits})}}catch(n){i.e(n)}finally{i.f()}t.logStat.rows=s}})),this.$api.post("/api/sys/stat",{type:"db_stat_list",start:e,end:a}).then((function(e){if(e&&0==e.length)t.dbStat.rows=[{"数据源":"空","访问量":0}];else{var a,s=[],i=Object(o["a"])(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;s.push({"数据源":r.name,"访问量":r.hits})}}catch(n){i.e(n)}finally{i.f()}t.dbStat.rows=s}})),this.$api.post("/api/sys/stat",{type:"type_stat",start:e,end:a}).then((function(e){if(e&&0==e.length)t.typeStat.rows=[{"操作":"空","数量":0}];else{var a,s=[],i=Object(o["a"])(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;console.log("item.name:"+r.name),s.push({"操作":r.name,"数量":r.hits})}}catch(n){i.e(n)}finally{i.f()}t.typeStat.rows=s}})),this.$api.post("/api/sys/stat",{type:"user_stat_list",start:e,end:a}).then((function(e){if(e&&0==e.length)t.userStat.rows=[{"用户名":"空","访问量":0}];else{var a,s=[],i=Object(o["a"])(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;s.push({"用户名":r.name,"访问量":r.hits})}}catch(n){i.e(n)}finally{i.f()}t.userStat.rows=s}}))}},queryBase:function(){var t=this;this.$api.post("/api/sys/stat",{type:"base_stat",start:"",end:""}).then((function(e){console.log("基本信息：",e),t.baseStat=e||{}})),this.$api.post("/api/sys/stat",{type:"db_type_stat",start:this.query.start,end:this.query.end}).then((function(e){var a,s=[],i=Object(o["a"])(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;s.push({"类型":r.name,"数量":r.hits})}}catch(n){i.e(n)}finally{i.f()}t.dbTypeStat.rows=s}))},getTagType:function(t){return t?"success":"info"},goProjectHome:function(t){this.$router.push({path:"/project_home?id="+t.id})},onAddProject:function(t){this.$refs.dialogProjectApply.show(t)},init:function(){var t=this;this.$api.project.publicList().then((function(e){t.projectList=e})),this.$api.post("/api/user/stat",{type:"total_stat",start:this.query.start,end:this.query.end}).then((function(e){t.stat.today_count=e.hits})),this.$api.post("/api/user/stat",{type:"total_fail_stat",start:this.query.start,end:this.query.end}).then((function(e){t.stat.fail_count=e.hits})),this.$api.post("/api/user/stat",{type:"log_time_stat",start:this.query.start2,end:this.query.end2}).then((function(e){var a=[];if(e&&0==e.length)a.push({"时间":"今天","访问量":0});else{var s,i=Object(o["a"])(e);try{for(i.s();!(s=i.n()).done;){var r=s.value;a.push({"时间":r.name,"访问量":r.hits})}}catch(n){i.e(n)}finally{i.f()}}t.logTimeStat.rows=a,console.log("一周访问量：",a)}))}}},h=d,f=(a("12bb"),a("2877")),m=Object(f["a"])(h,s,i,!1,null,null,null);e["default"]=m.exports}}]);