(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-167a8147"],{a15b:function(t,a,e){"use strict";var s=e("23e7"),o=e("44ad"),r=e("fc6a"),l=e("a640"),n=[].join,i=o!=Object,u=l("join",",");s({target:"Array",proto:!0,forced:i||!u},{join:function(t){return n.call(r(this),void 0===t?",":t)}})},c55b:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"database"},[e("k-search-table",{ref:"st",attrs:{url:"/api/audit/list","search-data":t.search},on:{reset:t.resetSearch}},[e("template",{slot:"searchs"},[e("el-form-item",{attrs:{label:"申请人",prop:"user_name",size:"mini"}},[e("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:t.search.user_name,callback:function(a){t.$set(t.search,"user_name",a)},expression:"search.user_name"}})],1),e("el-form-item",{attrs:{label:"审核状态"}},[e("el-select",{staticStyle:{width:"120px"},attrs:{clearable:!0,size:"mini"},model:{value:t.search.status,callback:function(a){t.$set(t.search,"status",a)},expression:"search.status"}},t._l(t.status_types,(function(t){return e("el-option",{key:t.k,attrs:{label:t.v,value:t.k}})})),1)],1)],1),e("template",{slot:"columns"},[e("el-table-column",{attrs:{label:"编号",prop:"id"}}),e("el-table-column",{attrs:{label:"申请人",prop:"opt_user_name"}}),e("el-table-column",{attrs:{label:"申请时间",prop:"created_at"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(t._s(t._f("dateTime")(a.row.created_at)))]}}])}),e("el-table-column",{attrs:{label:"申请理由",prop:"opt_mark"}}),e("el-table-column",{attrs:{label:"审核状态",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(a){return[1==a.row.status?e("span",[t._v(" 审核中 ")]):2==a.row.status?e("span",{staticClass:"text-success"},[t._v("审核通过")]):3==a.row.status?e("span",{staticClass:"text-warning"},[t._v(" 不通过 ")]):4==a.row.status?e("span",{staticClass:"text-info"},[t._v("撤销申请")]):e("span",{staticClass:"text-info"},[t._v("未知")])]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{directives:[{name:"show",rawName:"v-show",value:1==a.row.status,expression:"r.row.status == 1"}],attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.openApply(a.row)}}},[t._v("审核 ")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:1!=a.row.status,expression:"r.row.status != 1"}],attrs:{size:"mini",type:"info"},on:{click:function(e){return t.openApply(a.row,!0)}}},[t._v("查看 ")])]}}])})],1)],2),e("dialog-apply",{ref:"applyDialog",on:{refresh:t.refresh}})],1)},o=[],r=(e("ac1f"),e("841c"),function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-dialog",{attrs:{title:"审核信息",visible:t.isShow,width:"600px"},on:{"update:visible":function(a){t.isShow=a}}},[e("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"120px","label-suffix":":"}},[e("el-form-item",{attrs:{label:"申请人",prop:"opt_user"}},[t._v(" "+t._s(t.formData.opt_user_name)+" ")]),"role"==t.formData.source_type?e("el-form-item",{attrs:{label:"申请资源"}},[t._v(" "+t._s(t.formData.source_name)+"(权限组) ")]):t._e(),e("el-form-item",{attrs:{label:"申请说明",prop:"opt_mark"}},[t._v(" "+t._s(t.formData.opt_mark)+" ")]),e("el-form-item",{attrs:{label:"审核人",prop:"copy_to"}},[t._v(" "+t._s(t.formData.auditor_name)+" ")]),e("el-form-item",{attrs:{label:"审核抄送",prop:"copy_to"}},[t._v(" "+t._s(""==t.copyTo?"无":t.copyTo)+" ")]),e("el-alert",{attrs:{title:"说明：权限组申请审核后会自动关联，其他的需要人工处理。",type:"info"}}),e("el-form-item",{attrs:{label:"审核结果",prop:"status"}},[t.readonly?e("span",[t._v(" "+t._s(t.showStatus())+" ")]):e("el-radio-group",{model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[e("el-radio",{attrs:{label:2}},[t._v("通过")]),e("el-radio",{attrs:{label:3}},[t._v("不通过")])],1)],1),e("el-form-item",{attrs:{label:"审核说明",prop:"auditor_mark"}},[t.readonly?e("span",[t._v(" "+t._s(t.formData.auditor_mark)+" ")]):e("el-input",{attrs:{type:"textarea",placeholder:"请输入审核说明"},model:{value:t.formData.auditor_mark,callback:function(a){t.$set(t.formData,"auditor_mark",a)},expression:"formData.auditor_mark"}})],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.readonly&&1!=t.formData.status,expression:"readonly&&formData.status!=1"}],attrs:{label:"审核时间",prop:"auditor_mark"}},[e("span",[t._v(" "+t._s(t._f("dateTime")(t.formData.auditor_time))+" ")])])],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.hide}},[t._v("关闭")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.readonly,expression:"!readonly"}],attrs:{type:"success"},on:{click:t.onSubmit}},[t._v("提交")])],1)],1)],1)}),l=[],n=(e("a15b"),{data:function(){return{status:2,role:{},readonly:!1,copyTo:"",isShow:!1,formData:{},formRule:{opt_mark:[{required:!0,message:"请输入申请理由"}]}}},props:{},watch:{},computed:{},methods:{show:function(t,a){if(this.apply=t,this.formData=t,this.readonly=a||!1,t.copy_to&&t.copy_to.length>0){for(var e=[],s=0;s<t.copy_to.length;s++)e.push(t.copy_to[s].copy_to_name);this.copyTo=e.join(" ")}this.isShow=!0},hide:function(t){this.isShow=!1,this.readonly=!1,this.formData={}},showStatus:function(){var t="未知状态";return this.formData&&(2==this.formData.status?t="已通过":3==this.formData.status?t="未通过":1==this.formData.status?t="审核中":4==this.formData.status&&(t="已撤销")),t},onSubmit:function(){var t=this,a=this.formData;a.status=this.status,this.$api.apply.auditExec(a).then((function(){t.onSuccess("提交成功"),t.hide(),t.$emit("refresh")}),(function(a){var e="参数错误！";"301"!=a.result&&(e=a.data),t.onError(e)}))}},mounted:function(){},components:{}}),i=n,u=e("2877"),c=Object(u["a"])(i,r,l,!1,null,null,null),p=c.exports,m={data:function(){return{search:{db_type:null},con_states:[{k:"0",v:"全部"},{k:"1",v:"连接中"},{k:"2",v:"连接成功"},{k:"3",v:"连接失败"}],status_types:[{k:"0",v:"全部"},{k:"1",v:"待审核"},{k:"2",v:"已通过"},{k:"3",v:"未通过"}]}},computed:{},props:{},watch:{},methods:{refresh:function(){this.$refs.st.search()},resetSearch:function(){console.log("========resetSearch========="),this.search={}},reload:function(){this.$refs.st.reload()},openApply:function(t,a){this.$refs.applyDialog.show(t,a)}},components:{DialogApply:p},mounted:function(){}},f=m,h=Object(u["a"])(f,s,o,!1,null,null,null);a["default"]=h.exports}}]);