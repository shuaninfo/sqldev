(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216f75"],{c55b:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"database"},[a("k-search-table",{ref:"st",attrs:{url:"/api/audit/list","search-data":t.search},on:{reset:t.resetSearch}},[a("template",{slot:"searchs"},[a("el-form-item",{attrs:{label:"申请人",prop:"user_name",size:"mini"}},[a("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini"},model:{value:t.search.user_name,callback:function(e){t.$set(t.search,"user_name",e)},expression:"search.user_name"}})],1),a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{clearable:!0,size:"mini"},model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},t._l(t.status_types,(function(t){return a("el-option",{key:t.k,attrs:{label:t.v,value:t.k}})})),1)],1)],1),a("template",{slot:"columns"},[a("el-table-column",{attrs:{label:"编号",prop:"id"}}),a("el-table-column",{attrs:{label:"申请人",prop:"opt_user_name"}}),a("el-table-column",{attrs:{label:"申请时间",prop:"created_at"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("dateTime")(e.row.created_at)))]}}])}),a("el-table-column",{attrs:{label:"申请理由",prop:"opt_mark"}}),a("el-table-column",{attrs:{label:"审核状态",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",[t._v(" 审核中 ")]):2==e.row.status?a("span",{staticClass:"text-success"},[t._v("审核通过")]):3==e.row.status?a("span",{staticClass:"text-warning"},[t._v(" 不通过 ")]):4==e.row.status?a("span",{staticClass:"text-info"},[t._v("撤销申请")]):a("span",{staticClass:"text-info"},[t._v("未知")])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.row.status,expression:"r.row.status == 1"}],attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.openApply(e.row)}}},[t._v("审核 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1!=e.row.status,expression:"r.row.status != 1"}],attrs:{size:"mini",type:"info"},on:{click:function(a){return t.openApply(e.row,!0)}}},[t._v("查看 ")])]}}])})],1)],2),a("dialog-apply",{ref:"applyDialog",on:{refresh:t.refresh}})],1)},o=[],r=(a("ac1f"),a("841c"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:"审核信息",visible:t.isShow,width:"600px"},on:{"update:visible":function(e){t.isShow=e}}},[a("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"120px","label-suffix":":"}},[a("el-form-item",{attrs:{label:"申请人",prop:"opt_user"}},[t._v(" "+t._s(t.formData.opt_user_name)+" ")]),"role"==t.formData.source_type?a("el-form-item",{attrs:{label:"申请资源"}},[t._v(" "+t._s(t.formData.source_name)+"(权限组) ")]):t._e(),a("el-form-item",{attrs:{label:"申请说明",prop:"opt_mark"}},[t._v(" "+t._s(t.formData.opt_mark)+" ")]),a("el-form-item",{attrs:{label:"审核人",prop:"copy_to"}},[t._v(" "+t._s(t.formData.auditor_name)+" ")]),a("el-form-item",{attrs:{label:"审核抄送",prop:"copy_to"}},[t._v(" "+t._s(""==t.copyTo?"无":t.copyTo)+" ")]),a("el-alert",{attrs:{title:"说明：权限组申请审核后会自动关联，其他的需要人工处理。",type:"info"}}),a("el-form-item",{attrs:{label:"审核结果",prop:"status"}},[t.readonly?a("span",[t._v(" "+t._s(t.showStatus())+" ")]):a("el-radio-group",{model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("el-radio",{attrs:{label:2}},[t._v("通过")]),a("el-radio",{attrs:{label:3}},[t._v("不通过")])],1)],1),a("el-form-item",{attrs:{label:"审核说明",prop:"auditor_mark"}},[t.readonly?a("span",[t._v(" "+t._s(t.formData.auditor_mark)+" ")]):a("el-input",{attrs:{type:"textarea",placeholder:"请输入审核说明"},model:{value:t.formData.auditor_mark,callback:function(e){t.$set(t.formData,"auditor_mark",e)},expression:"formData.auditor_mark"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.readonly&&1!=t.formData.status,expression:"readonly&&formData.status!=1"}],attrs:{label:"审核时间",prop:"auditor_mark"}},[a("span",[t._v(" "+t._s(t._f("dateTime")(t.formData.auditor_time))+" ")])])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.hide}},[t._v("关闭")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.readonly,expression:"!readonly"}],attrs:{type:"success"},on:{click:t.onSubmit}},[t._v("提交")])],1)],1)],1)}),l=[],n=(a("a15b"),{data:function(){return{status:2,role:{},readonly:!1,copyTo:"",isShow:!1,formData:{},formRule:{opt_mark:[{required:!0,message:"请输入申请理由"}]}}},props:{},watch:{},computed:{},methods:{show:function(t,e){if(this.apply=t,this.formData=t,this.readonly=e||!1,t.copy_to&&t.copy_to.length>0){for(var a=[],s=0;s<t.copy_to.length;s++)a.push(t.copy_to[s].copy_to_name);this.copyTo=a.join(" ")}this.isShow=!0},hide:function(t){this.isShow=!1,this.readonly=!1,this.formData={}},showStatus:function(){var t="未知状态";return this.formData&&(2==this.formData.status?t="已通过":3==this.formData.status?t="未通过":1==this.formData.status?t="审核中":4==this.formData.status&&(t="已撤销")),t},onSubmit:function(){var t=this,e=this.formData;e.status=this.status,this.$api.apply.auditExec(e).then((function(){t.onSuccess("提交成功"),t.hide(),t.$emit("refresh")}),(function(e){var a="参数错误！";"301"!=e.result&&(a=e.data),t.onError(a)}))}},mounted:function(){},components:{}}),i=n,u=a("2877"),c=Object(u["a"])(i,r,l,!1,null,null,null),p=c.exports,m={data:function(){return{search:{db_type:null},con_states:[{k:"0",v:"全部"},{k:"1",v:"连接中"},{k:"2",v:"连接成功"},{k:"3",v:"连接失败"}],status_types:[{k:"0",v:"全部"},{k:"1",v:"待审核"},{k:"2",v:"已通过"},{k:"3",v:"未通过"}]}},computed:{},props:{},watch:{},methods:{refresh:function(){this.$refs.st.search()},resetSearch:function(){console.log("========resetSearch========="),this.search={}},reload:function(){this.$refs.st.reload()},openApply:function(t,e){this.$refs.applyDialog.show(t,e)}},components:{DialogApply:p},mounted:function(){}},f=m,h=Object(u["a"])(f,s,o,!1,null,null,null);e["default"]=h.exports}}]);